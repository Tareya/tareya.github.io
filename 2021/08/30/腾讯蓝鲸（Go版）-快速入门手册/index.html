

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=&#34;auto&#34;>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/icon.png">
  <link rel="icon" href="/img/icon.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="è…¾è®¯è“é²¸ï¼ˆGoç‰ˆï¼‰ å¿«é€Ÿå…¥é—¨æ‰‹å†Œ">
  <meta name="author" content="Tareya">
  <meta name="keywords" content="">
  
  <title>è…¾è®¯è“é²¸ï¼ˆGoç‰ˆï¼‰ å¿«é€Ÿå…¥é—¨æ‰‹å†Œ - ä¹±åºæ—¶ç©º</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10.7.2/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
  



<!-- ä¸»é¢˜ä¾èµ–çš„å›¾æ ‡åº“ï¼Œä¸è¦è‡ªè¡Œä¿®æ”¹ -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- è‡ªå®šä¹‰æ ·å¼ä¿æŒåœ¨æœ€åº•éƒ¨ -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"tareya.github.io","root":"/","version":"1.8.11","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null}},"search_path":"/local-search.xml"};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.4.0"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>ä¹±åºæ—¶ç©º</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                é¦–é¡µ
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                å½’æ¡£
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                åˆ†ç±»
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                æ ‡ç­¾
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                å…³äº
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" data-toggle="modal" data-target="#modalSearch">&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;</a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/background/lomo5.jpeg') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="è…¾è®¯è“é²¸ï¼ˆGoç‰ˆï¼‰ å¿«é€Ÿå…¥é—¨æ‰‹å†Œ">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2021-08-30 11:50" pubdate>
        2021å¹´8æœˆ30æ—¥ ä¸­åˆ
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      4.8k å­—
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      66
       åˆ†é’Ÿ
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">è…¾è®¯è“é²¸ï¼ˆGoç‰ˆï¼‰ å¿«é€Ÿå…¥é—¨æ‰‹å†Œ</h1>
            
            <div class="markdown-body">
              <h1 id="è…¾è®¯è“é²¸ï¼ˆGoç‰ˆï¼‰-å¿«é€Ÿå…¥é—¨æ‰‹å†Œ"><a href="#è…¾è®¯è“é²¸ï¼ˆGoç‰ˆï¼‰-å¿«é€Ÿå…¥é—¨æ‰‹å†Œ" class="headerlink" title="è…¾è®¯è“é²¸ï¼ˆGoç‰ˆï¼‰ å¿«é€Ÿå…¥é—¨æ‰‹å†Œ"></a>è…¾è®¯è“é²¸ï¼ˆGoç‰ˆï¼‰ å¿«é€Ÿå…¥é—¨æ‰‹å†Œ</h1><span id="more"></span>

<h2 id="ä¸€ã€ç®€ä»‹"><a href="#ä¸€ã€ç®€ä»‹" class="headerlink" title="ä¸€ã€ç®€ä»‹"></a>ä¸€ã€ç®€ä»‹</h2><p><img src="http://uniondrug-devops.oss-cn-hangzhou.aliyuncs.com/blog_images/bk-cmdb.png" srcset="/img/loading.gif" lazyload alt="bk-cmdb"></p>
<p><a target="_blank" rel="noopener" href="https://bk.tencent.com/">è“é²¸å®˜ç½‘</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/Tencent/bk-cmdb">å®˜æ–¹github</a></p>
<h3 id="1ã€è“é²¸ç®€ä»‹"><a href="#1ã€è“é²¸ç®€ä»‹" class="headerlink" title="1ã€è“é²¸ç®€ä»‹"></a>1ã€è“é²¸ç®€ä»‹</h3><p>è“é²¸é…ç½®å¹³å°ï¼ˆè“é²¸CMDBï¼‰æ˜¯ä¸€ä¸ªé¢å‘èµ„äº§åŠåº”ç”¨çš„ä¼ä¸šçº§é…ç½®ç®¡ç†å¹³å°ã€‚</p>
<p>è“é²¸é…ç½®å¹³å°æä¾›äº†å…¨æ–°è‡ªå®šä¹‰æ¨¡å‹ç®¡ç†ï¼Œç”¨æˆ·ä¸ä»…å¯ä»¥æ–¹ä¾¿åœ°å®ç°å†…ç½®æ¨¡å‹å±æ€§çš„æ‹“å±•ï¼ŒåŒæ—¶ä¹Ÿèƒ½å¤Ÿæ ¹æ®ä¸åŒçš„ä¼ä¸šéœ€æ±‚éšæ—¶æ–°å¢æ¨¡å‹å’Œå…³è”å…³ç³»ï¼ŒæŠŠç½‘ç»œã€ä¸­é—´ä»¶ã€è™šæ‹Ÿèµ„æºç­‰çº³å…¥åˆ°CMDBçš„ç®¡ç†ä¸­ã€‚é™¤æ­¤ä¹‹å¤–è¿˜å¢åŠ äº†æ›´å¤šç¬¦åˆåœºæ™¯éœ€è¦çš„æ–°åŠŸèƒ½ï¼šæœºå™¨æ•°æ®å¿«ç…§ã€æ•°æ®è‡ªåŠ¨å‘ç°ã€å˜æ›´äº‹ä»¶ä¸»åŠ¨æ¨é€ã€æ›´åŠ ç²¾ç»†çš„æƒé™ç®¡ç†ã€å¯æ‹“å±•çš„ä¸šåŠ¡æ‹“æ‰‘ç­‰åŠŸèƒ½ã€‚</p>
<p>åœ¨æŠ€æœ¯æ„å»ºä¸Šï¼Œæ¶æ„çš„æ ¸å¿ƒèšç„¦äºèµ„æºï¼Œæˆ‘ä»¬æŠŠCMDBç®¡ç†çš„åŸå­èµ„æºåˆ†ä¸ºä¸»æœºã€è¿›ç¨‹å’Œé€šç”¨å¯¹è±¡ä¸‰ç§ç±»å‹ï¼Œå¹¶æ„å»ºäº†å¯¹è¿™äº›èµ„æºçš„åŸå­æ“ä½œå±‚ã€‚åœ¨è¿™äº›åŸå­æ“ä½œä¹‹ä¸Šï¼Œæˆ‘ä»¬æ„å»ºäº†æ›´è´´è¿‘ç”¨æˆ·æ“ä½œçš„åœºæ™¯å±‚ï¼Œåœºæ™¯å±‚é€šè¿‡å¯¹ä¸åŒèµ„æºçš„ç»„åˆæ“ä½œæ¥å®Œæˆç”¨æˆ·çš„è¯·æ±‚ã€‚</p>
<h3 id="2ã€å…·ä½“åŠŸèƒ½"><a href="#2ã€å…·ä½“åŠŸèƒ½" class="headerlink" title="2ã€å…·ä½“åŠŸèƒ½"></a>2ã€å…·ä½“åŠŸèƒ½</h3><ul>
<li>æ‹“æ‰‘åŒ–çš„ä¸»æœºç®¡ç†ï¼šä¸»æœºåŸºç¡€å±æ€§ã€ä¸»æœºå¿«ç…§æ•°æ®ã€ä¸»æœºå½’å±å…³ç³»ç®¡ç†</li>
<li>ç»„ç»‡æ¶æ„ç®¡ç†ï¼šå¯æ‰©å±•çš„åŸºäºä¸šåŠ¡çš„ç»„ç»‡æ¶æ„ç®¡ç†</li>
<li>æ¨¡å‹ç®¡ç†ï¼šæ—¢èƒ½ç®¡ç†ä¸šåŠ¡ã€é›†ç¾¤ã€ä¸»æœºç­‰å†…ç½®æ¨¡å‹ï¼Œä¹Ÿèƒ½è‡ªå®šä¹‰æ¨¡å‹</li>
<li>è¿›ç¨‹ç®¡ç†ï¼šåŸºäºæ¨¡å—çš„ä¸»æœºè¿›ç¨‹ç®¡ç†</li>
<li>äº‹ä»¶æ³¨å†Œä¸æ¨é€ï¼šæä¾›åŸºäºå›è°ƒæ–¹å¼çš„äº‹ä»¶æ³¨å†Œä¸æ¨é€</li>
<li>é€šç”¨æƒé™ç®¡ç†ï¼šçµæ´»çš„åŸºäºç”¨æˆ·ç»„çš„æƒé™ç®¡ç†</li>
<li>æ“ä½œå®¡è®¡ï¼šç”¨æˆ·æ“ä½œè¡Œä¸ºçš„å®¡è®¡ä¸å›æº¯</li>
</ul>
<h3 id="3ã€æ¶æ„è®¾è®¡"><a href="#3ã€æ¶æ„è®¾è®¡" class="headerlink" title="3ã€æ¶æ„è®¾è®¡"></a>3ã€æ¶æ„è®¾è®¡</h3><p><img src="http://uniondrug-devops.oss-cn-hangzhou.aliyuncs.com/blog_images/image-20210826102802263.png" srcset="/img/loading.gif" lazyload alt="Goè“é²¸æ¶æ„è®¾è®¡"></p>
<h3 id="4ã€æœåŠ¡è¿›ç¨‹æ¸…å•"><a href="#4ã€æœåŠ¡è¿›ç¨‹æ¸…å•" class="headerlink" title="4ã€æœåŠ¡è¿›ç¨‹æ¸…å•"></a>4ã€æœåŠ¡è¿›ç¨‹æ¸…å•</h3><table>
<thead>
<tr>
<th>åç§°</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>cmdb_webserver</td>
<td>web server æœåŠ¡å­ç›®å½•</td>
</tr>
<tr>
<td>cmdb_apiserver</td>
<td>åœºæ™¯å±‚æœåŠ¡ï¼Œapi æœåŠ¡</td>
</tr>
<tr>
<td>cmdb_coreservice</td>
<td>èµ„æºç®¡ç†å±‚ï¼Œæä¾›åŸå­æ¥å£æœåŠ¡</td>
</tr>
<tr>
<td>cmdb_adminserver</td>
<td>è´Ÿè´£ç³»ç»Ÿæ•°æ®çš„åˆå§‹åŒ–ä»¥åŠé…ç½®ç®¡ç†å·¥ä½œ</td>
</tr>
<tr>
<td>cmdb_authserver</td>
<td>é‰´æƒè®¤è¯æœåŠ¡</td>
</tr>
<tr>
<td>cmdb_cloudserver</td>
<td>äº‘æ•°æ®ç®¡ç†æœåŠ¡</td>
</tr>
<tr>
<td>cmdb_datacollection</td>
<td>åœºæ™¯å±‚æœåŠ¡ï¼Œæ•°æ®é‡‡é›†æœåŠ¡</td>
</tr>
<tr>
<td>cmdb_eventserver</td>
<td>åœºæ™¯å±‚æœåŠ¡ï¼Œäº‹ä»¶æ¨é€æœåŠ¡</td>
</tr>
<tr>
<td>cmdb_hostserver</td>
<td>åœºæ™¯å±‚æœåŠ¡ï¼Œä¸»æœºæ•°æ®ç»´æŠ¤</td>
</tr>
<tr>
<td>cmdb_operationserver</td>
<td>åœºæ™¯å±‚æœåŠ¡ï¼Œæä¾›ä¸è¿è¥ç»Ÿè®¡ç›¸å…³åŠŸèƒ½æœåŠ¡</td>
</tr>
<tr>
<td>cmdb_procserver</td>
<td>åœºæ™¯å±‚æœåŠ¡ï¼Œè´Ÿè´£è¿›ç¨‹æ•°æ®çš„ç»´æŠ¤</td>
</tr>
<tr>
<td>cmdb_synchronizeserver</td>
<td>åœºæ™¯å±‚æœåŠ¡ï¼Œæ•°æ®åŒæ­¥æœåŠ¡</td>
</tr>
<tr>
<td>cmdb_toposerver</td>
<td>åœºæ™¯å±‚æœåŠ¡ï¼Œè´Ÿè´£æ¨¡å‹çš„å®šä¹‰ä»¥åŠä¸»æœºã€ä¸šåŠ¡ã€æ¨¡å—åŠè¿›ç¨‹ç­‰å®ä¾‹æ•°æ®çš„ç»´æŠ¤</td>
</tr>
<tr>
<td>cmdb_taskserver</td>
<td>åœºæ™¯å±‚æœåŠ¡ï¼Œå¼‚æ­¥ä»»åŠ¡ç®¡ç†æœåŠ¡</td>
</tr>
</tbody></table>
<h3 id="5ã€ä»£ç ç»“æ„"><a href="#5ã€ä»£ç ç»“æ„" class="headerlink" title="5ã€ä»£ç ç»“æ„"></a>5ã€ä»£ç ç»“æ„</h3><p><img src="http://uniondrug-devops.oss-cn-hangzhou.aliyuncs.com/blog_images/image-20210826103025159.png" srcset="/img/loading.gif" lazyload alt="Goè“é²¸ä»£ç ç»“æ„"></p>
<h4 id="ç›®å½•ç»“æ„è¯´æ˜ï¼š"><a href="#ç›®å½•ç»“æ„è¯´æ˜ï¼š" class="headerlink" title="ç›®å½•ç»“æ„è¯´æ˜ï¼š"></a>ç›®å½•ç»“æ„è¯´æ˜ï¼š</h4><table>
<thead>
<tr>
<th>ç›®å½•</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>web-server</td>
<td>webå±‚æœåŠ¡åç«¯ï¼ŒåŸºäº golang çš„ ginæ¡†æ¶</td>
</tr>
<tr>
<td>ui</td>
<td>webå±‚æœåŠ¡å‰ç«¯ï¼ŒåŸºäº vue.js</td>
</tr>
<tr>
<td>test</td>
<td>ç³»ç»ŸæœåŠ¡çš„æµ‹è¯•ç”¨ä¾‹ï¼ŒåŸºäº golang åŸç”Ÿ</td>
</tr>
<tr>
<td>tools</td>
<td>å®¢æˆ·ç«¯ç®¡ç†å·¥å…·ï¼ˆåŸºäº golangï¼‰ä»¥åŠè¾…åŠ©è„šæœ¬å·¥å…·ï¼ˆåŸºäº Javascriptï¼‰</td>
</tr>
<tr>
<td>apiserver</td>
<td>æ¥å…¥å±‚ api æœåŠ¡å±‚ï¼ŒåŸºäº golang çš„ go-restful æ¡†æ¶</td>
</tr>
<tr>
<td>scene_server</td>
<td>æ¥å…¥å±‚ åœºæ™¯å¾®æœåŠ¡å±‚ï¼ŒåŸºäº golang çš„ go-restful æ¡†æ¶</td>
</tr>
<tr>
<td>source_controller</td>
<td>æ¥å…¥å±‚ èµ„æºè°ƒåº¦å±‚ï¼ŒåŸºäº golang çš„ go-restful æ¡†æ¶ï¼Œæä¾›åŸå­æ¥å£æœåŠ¡</td>
</tr>
<tr>
<td>common</td>
<td>é¡¹ç›®å…¬å…±ä¾èµ–åº“ï¼ŒåŸºäº golang åŸç”Ÿ</td>
</tr>
<tr>
<td>storage</td>
<td>å­˜å‚¨æ¥å…¥å°è£…ï¼ŒåŸºäº golang åŸç”Ÿ</td>
</tr>
<tr>
<td>thirdpartyclient</td>
<td>ç¬¬ä¸‰æ–¹å®¢æˆ·ç«¯æ¥å…¥å°è£…ï¼ŒåŸºäº golang åŸç”Ÿ</td>
</tr>
</tbody></table>
<h2 id="äºŒã€ç¼–è¯‘"><a href="#äºŒã€ç¼–è¯‘" class="headerlink" title="äºŒã€ç¼–è¯‘"></a>äºŒã€ç¼–è¯‘</h2><h3 id="1ã€ç¼–è¯‘ç¯å¢ƒå‡†å¤‡"><a href="#1ã€ç¼–è¯‘ç¯å¢ƒå‡†å¤‡" class="headerlink" title="1ã€ç¼–è¯‘ç¯å¢ƒå‡†å¤‡"></a>1ã€ç¼–è¯‘ç¯å¢ƒå‡†å¤‡</h3><h4 id="1ï¼‰ç¯å¢ƒéœ€æ±‚"><a href="#1ï¼‰ç¯å¢ƒéœ€æ±‚" class="headerlink" title="1ï¼‰ç¯å¢ƒéœ€æ±‚"></a>1ï¼‰ç¯å¢ƒéœ€æ±‚</h4><ul>
<li>golang &gt;= 1.8</li>
<li>python &gt;= 2.7.5</li>
<li>nodejs &gt;= 4.0.0ï¼ˆç¼–è¯‘è¿‡ç¨‹ä¸­éœ€è¦å¯ä»¥è¿å…¬ç½‘ä¸‹è½½ä¾èµ–åŒ…ï¼‰</li>
</ul>
<h4 id="2ï¼‰å®‰è£…-Go"><a href="#2ï¼‰å®‰è£…-Go" class="headerlink" title="2ï¼‰å®‰è£… Go"></a>2ï¼‰å®‰è£… Go</h4><p>æ¨èä½¿ç”¨ g è¿›è¡Œ Go çš„ç‰ˆæœ¬ç®¡ç†ï¼Œå‚è€ƒå¦‚ä¸‹æ–‡æ¡£</p>
<p><a href="https://tareya.github.io/2021/08/25/golang-%E5%A4%9A%E7%89%88%E6%9C%AC%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7-%E2%80%94-g/#golang-%E5%A4%9A%E7%89%88%E6%9C%AC%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7-%E2%80%94-g">golang å¤šç‰ˆæœ¬ç®¡ç†å·¥å…· â€” g</a></p>
<h4 id="3ï¼‰å®‰è£…-node-js"><a href="#3ï¼‰å®‰è£…-node-js" class="headerlink" title="3ï¼‰å®‰è£… node.js"></a>3ï¼‰å®‰è£… node.js</h4><h5 id="1-ä¸‹è½½æºç åŒ…"><a href="#1-ä¸‹è½½æºç åŒ…" class="headerlink" title="1. ä¸‹è½½æºç åŒ…"></a>1. ä¸‹è½½æºç åŒ…</h5><p><a target="_blank" rel="noopener" href="https://nodejs.org/zh-cn/download/">å®˜ç½‘ä¸‹è½½åœ°å€</a></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">wget -c https://nodejs.org/dist/v14.17.5/node-v14.17.5-linux-x64.tar.xz\<br></code></pre></td></tr></table></figure>

<h5 id="2-è§£å‹å¹¶è®¾ç½®è·¯å¾„"><a href="#2-è§£å‹å¹¶è®¾ç½®è·¯å¾„" class="headerlink" title="2. è§£å‹å¹¶è®¾ç½®è·¯å¾„"></a>2. è§£å‹å¹¶è®¾ç½®è·¯å¾„</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">tar xf node-v14.17.5-linux-x64.tar.xz -C /data/applications/ &amp;&amp; \<br>cd /data/applications &amp;&amp; \<br>ln -s node-v14.17.5-linux-x64 node &amp;&amp; \<br>ln -s /data/applications/node/bin/* /usr/local/bin/<br></code></pre></td></tr></table></figure>

<p>éªŒè¯:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">node -v <br>npm -v<br></code></pre></td></tr></table></figure>

<h5 id="3-å®‰è£…-cnpm"><a href="#3-å®‰è£…-cnpm" class="headerlink" title="3. å®‰è£… cnpm"></a>3. å®‰è£… cnpm</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">npm install -g cnpm --registry=https://registry.npm.taobao.org<br></code></pre></td></tr></table></figure>

<p><img src="http://uniondrug-devops.oss-cn-hangzhou.aliyuncs.com/blog_images/image-20210825165451698.png" srcset="/img/loading.gif" lazyload alt="image-20210825165451698"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">ln -s /data/applications/node/bin/cnpm /usr/local/bin/<br></code></pre></td></tr></table></figure>

<p>éªŒè¯:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">cnpm -v<br></code></pre></td></tr></table></figure>



<h3 id="2ã€æºç ç¼–è¯‘"><a href="#2ã€æºç ç¼–è¯‘" class="headerlink" title="2ã€æºç ç¼–è¯‘"></a>2ã€æºç ç¼–è¯‘</h3><h4 id="1ï¼‰æºç ä¸‹è½½"><a href="#1ï¼‰æºç ä¸‹è½½" class="headerlink" title="1ï¼‰æºç ä¸‹è½½"></a>1ï¼‰æºç ä¸‹è½½</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">mkdir ~/go/src &amp;&amp; \<br>export GOPATH=~/go &amp;&amp; \<br>cd $GOPATH/src &amp;&amp; \<br>git clone git@github.com:Tareya/configcenter.git<br></code></pre></td></tr></table></figure>



<h4 id="2ï¼‰æ•´ä½“ç¼–è¯‘"><a href="#2ï¼‰æ•´ä½“ç¼–è¯‘" class="headerlink" title="2ï¼‰æ•´ä½“ç¼–è¯‘"></a>2ï¼‰æ•´ä½“ç¼–è¯‘</h4><blockquote>
<p>ğŸš© <strong>ä¸‰ç§ç¼–è¯‘æ¨¡å¼</strong></p>
<p>å®˜æ–¹æä¾›çš„ Makefile æä¾›äº†å¤šç§ç¼–è¯‘æ¨¡å¼</p>
<p>1âƒ£ï¸ <strong>æŒ‡å®šç‰ˆæœ¬å·çš„ç¼–è¯‘</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">VERSION=xxxx make<br></code></pre></td></tr></table></figure>

<p>2âƒ£ï¸ <strong>æœ¬åœ°ä»£ç åˆ†æ”¯ç¼–è¯‘</strong></p>
<p>Makefile é»˜è®¤ä¸ºæ”¯æŒ darwin å¹³å°ï¼Œä¸” é»˜è®¤æƒ…å†µæ˜¯å‰åç«¯ä¸€èµ·ç¼–è¯‘</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">make <br></code></pre></td></tr></table></figure>

<p>3âƒ£ï¸ <strong>ç¼–è¯‘å‚æ•°</strong></p>
<p>æ”¯æŒ linux å¹³å°ç¼–è¯‘ï¼Œéœ€è¦æŒ‡å®š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">make linux<br></code></pre></td></tr></table></figure>

<p>ä½¿ç”¨ cnpm ä»£æ›¿ npm ç¼–è¯‘å‰ç«¯</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">make NPM=cnpm<br></code></pre></td></tr></table></figure>
</blockquote>
<h5 id="æ”¯æŒ-Linux-å¹³å°ç¼–è¯‘"><a href="#æ”¯æŒ-Linux-å¹³å°ç¼–è¯‘" class="headerlink" title="æ”¯æŒ Linux å¹³å°ç¼–è¯‘"></a>æ”¯æŒ Linux å¹³å°ç¼–è¯‘</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">cd $GOPATH/src/configcenter/src &amp;&amp; \<br>export GOPATH=~/go &amp;&amp; \<br>make linux NPM=cnpm<br></code></pre></td></tr></table></figure>

<h5 id="é—®é¢˜è®°å½•-è§£å†³ç¯å¢ƒå˜é‡è¯†åˆ«é—®é¢˜"><a href="#é—®é¢˜è®°å½•-è§£å†³ç¯å¢ƒå˜é‡è¯†åˆ«é—®é¢˜" class="headerlink" title="é—®é¢˜è®°å½•: è§£å†³ç¯å¢ƒå˜é‡è¯†åˆ«é—®é¢˜"></a>é—®é¢˜è®°å½•: è§£å†³ç¯å¢ƒå˜é‡è¯†åˆ«é—®é¢˜</h5><h6 id="é”™è¯¯ä¿¡æ¯ï¼š"><a href="#é”™è¯¯ä¿¡æ¯ï¼š" class="headerlink" title="é”™è¯¯ä¿¡æ¯ï¼š"></a>é”™è¯¯ä¿¡æ¯ï¼š</h6><p><img src="http://uniondrug-devops.oss-cn-hangzhou.aliyuncs.com/blog_images/image-20210825172030664.png" srcset="/img/loading.gif" lazyload alt="image-20210825172030664"></p>
<h6 id="é—®é¢˜åŸå› "><a href="#é—®é¢˜åŸå› " class="headerlink" title="é—®é¢˜åŸå› :"></a>é—®é¢˜åŸå› :</h6><p>åœ¨å®˜æ–¹æä¾›çš„ Makefile ä¸­ï¼Œè·¯å¾„æ˜¯å†™æ­»çš„ï¼Œæ‰€ä»¥å¦‚æœè·¯å¾„ä¸ä¸€è‡´ï¼Œä¼šæ— æ³•è¯»å–åˆ°å¯¹åº”çš„æ–‡ä»¶</p>
<h6 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ:"></a>è§£å†³æ–¹æ¡ˆ:</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">export GOPATH=~/go<br></code></pre></td></tr></table></figure>



<h4 id="3ï¼‰åç«¯ç¼–è¯‘ï¼ˆå¯é€‰ï¼‰"><a href="#3ï¼‰åç«¯ç¼–è¯‘ï¼ˆå¯é€‰ï¼‰" class="headerlink" title="3ï¼‰åç«¯ç¼–è¯‘ï¼ˆå¯é€‰ï¼‰"></a>3ï¼‰åç«¯ç¼–è¯‘ï¼ˆå¯é€‰ï¼‰</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">make server <br></code></pre></td></tr></table></figure>



<h4 id="4ï¼‰å‰ç«¯ç¼–è¯‘ï¼ˆå¯é€‰ï¼‰"><a href="#4ï¼‰å‰ç«¯ç¼–è¯‘ï¼ˆå¯é€‰ï¼‰" class="headerlink" title="4ï¼‰å‰ç«¯ç¼–è¯‘ï¼ˆå¯é€‰ï¼‰"></a>4ï¼‰å‰ç«¯ç¼–è¯‘ï¼ˆå¯é€‰ï¼‰</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">make ui NPM=cnpm<br></code></pre></td></tr></table></figure>

<h5 id="é—®é¢˜è®°å½•-è§£å†³nodeç¼–è¯‘oomé—®é¢˜"><a href="#é—®é¢˜è®°å½•-è§£å†³nodeç¼–è¯‘oomé—®é¢˜" class="headerlink" title="é—®é¢˜è®°å½•: è§£å†³nodeç¼–è¯‘oomé—®é¢˜"></a>é—®é¢˜è®°å½•: è§£å†³nodeç¼–è¯‘oomé—®é¢˜</h5><h6 id="é”™è¯¯ä¿¡æ¯"><a href="#é”™è¯¯ä¿¡æ¯" class="headerlink" title="é”™è¯¯ä¿¡æ¯:"></a>é”™è¯¯ä¿¡æ¯:</h6><p><img src="http://uniondrug-devops.oss-cn-hangzhou.aliyuncs.com/blog_images/image-20210825172156810.png" srcset="/img/loading.gif" lazyload alt="image-20210825172156810"></p>
<h6 id="é—®é¢˜åŸå› -1"><a href="#é—®é¢˜åŸå› -1" class="headerlink" title="é—®é¢˜åŸå› :"></a>é—®é¢˜åŸå› :</h6><p>è¯¥é—®é¢˜æ˜¯ç”±äºå‰ç«¯ä»£ç é—®é¢˜å¯¼è‡´çš„ node ç¼–è¯‘ OOM ï¼Œæ—§ç‰ˆæœ¬æš‚æ—¶æ²¡æœ‰æ­¤ç±»é—®é¢˜ï¼Œæ•…æ¨èä½¿ç”¨ release <a target="_blank" rel="noopener" href="https://github.com/Tencent/bk-cmdb/releases/tag/release-v3.9.5">v3.9.5</a> çš„æºç </p>
<p><a target="_blank" rel="noopener" href="https://github.com/Tencent/bk-cmdb/issues/5341">å®˜æ–¹ github issue è®°å½•</a></p>
<p><a href="https://tareya.github.io/2021/08/26/node-%E7%BC%96%E8%AF%91-JavaScript-heap-out-of-memory-%E5%86%85%E5%AD%98%E6%BA%A2%E5%87%BA%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/">ç±»ä¼¼é—®é¢˜è§£å†³æ–¹æ³•</a></p>
<h3 id="3ã€æ‰“åŒ…é•œåƒ"><a href="#3ã€æ‰“åŒ…é•œåƒ" class="headerlink" title="3ã€æ‰“åŒ…é•œåƒ"></a>3ã€æ‰“åŒ…é•œåƒ</h3><h4 id="1ï¼‰æ‰“åŒ…å‰åç«¯ç¼–è¯‘ç»“æœ"><a href="#1ï¼‰æ‰“åŒ…å‰åç«¯ç¼–è¯‘ç»“æœ" class="headerlink" title="1ï¼‰æ‰“åŒ…å‰åç«¯ç¼–è¯‘ç»“æœ"></a>1ï¼‰æ‰“åŒ…å‰åç«¯ç¼–è¯‘ç»“æœ</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">make package<br></code></pre></td></tr></table></figure>

<p>å½’æ¡£åŒ…å­˜æ”¾ä½ç½®ï¼š<code>~/go/src/configcenter/src/bin/pub/cmdb.tar.gz</code></p>
<h4 id="2ï¼‰é•œåƒåˆ¶ä½œ"><a href="#2ï¼‰é•œåƒåˆ¶ä½œ" class="headerlink" title="2ï¼‰é•œåƒåˆ¶ä½œ"></a>2ï¼‰é•œåƒåˆ¶ä½œ</h4><p>è§£å‹cmdb.tar.gzï¼Œè¿›å…¥cmdbç›®å½•æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> -i å‚æ•°åé¢é…ç½®çš„å‚æ•°æ˜¯åŸºç¡€é•œåƒï¼ŒåŸºç¡€é•œåƒå¯ä»¥è‡ªå·±åˆ¶ä½œï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å…¬å…±é•œåƒã€‚v</span><br>./image.sh -i &lt;base_image&gt;<br></code></pre></td></tr></table></figure>





<h2 id="ä¸‰ã€éƒ¨ç½²"><a href="#ä¸‰ã€éƒ¨ç½²" class="headerlink" title="ä¸‰ã€éƒ¨ç½²"></a>ä¸‰ã€éƒ¨ç½²</h2><h3 id="1ã€ä¾èµ–çš„ä¸‰æ–¹ç»„ä»¶æ¸…å•"><a href="#1ã€ä¾èµ–çš„ä¸‰æ–¹ç»„ä»¶æ¸…å•" class="headerlink" title="1ã€ä¾èµ–çš„ä¸‰æ–¹ç»„ä»¶æ¸…å•"></a>1ã€ä¾èµ–çš„ä¸‰æ–¹ç»„ä»¶æ¸…å•</h3><ul>
<li>ZooKeeper &gt;= 3.4.11</li>
<li>Redis &gt;= 3.2.11</li>
<li>MongoDB &gt;= 4.2</li>
<li>Elasticsearch &gt;= 7.0.0 (ç”¨äºå…¨æ–‡æ£€ç´¢åŠŸèƒ½)</li>
<li>Monstache &gt;= 6.0.0 (ç”¨äºå…¨æ–‡æ£€ç´¢åŠŸèƒ½)</li>
</ul>
<h3 id="2ã€Docker-éƒ¨ç½²-Zookeeperï¼ˆå•æœºï¼‰"><a href="#2ã€Docker-éƒ¨ç½²-Zookeeperï¼ˆå•æœºï¼‰" class="headerlink" title="2ã€Docker éƒ¨ç½² Zookeeperï¼ˆå•æœºï¼‰"></a>2ã€Docker éƒ¨ç½² Zookeeperï¼ˆå•æœºï¼‰</h3><p><a target="_blank" rel="noopener" href="https://zookeeper.apache.org/">Zookeeper å®˜ç½‘åœ°å€</a></p>
<h4 id="1ï¼‰ç¯å¢ƒå‡†å¤‡"><a href="#1ï¼‰ç¯å¢ƒå‡†å¤‡" class="headerlink" title="1ï¼‰ç¯å¢ƒå‡†å¤‡"></a>1ï¼‰ç¯å¢ƒå‡†å¤‡</h4><h5 id="1-æ‹‰å–é•œåƒ-ï¼ˆå®˜æ–¹æ¨è-3-4-12-ç‰ˆæœ¬ï¼‰"><a href="#1-æ‹‰å–é•œåƒ-ï¼ˆå®˜æ–¹æ¨è-3-4-12-ç‰ˆæœ¬ï¼‰" class="headerlink" title="1. æ‹‰å–é•œåƒ ï¼ˆå®˜æ–¹æ¨è 3.4.12 ç‰ˆæœ¬ï¼‰"></a>1. æ‹‰å–é•œåƒ ï¼ˆå®˜æ–¹æ¨è 3.4.12 ç‰ˆæœ¬ï¼‰</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker pull zookeeper:3.4.12<br></code></pre></td></tr></table></figure>

<h5 id="2-åˆ›å»ºæŒä¹…åŒ–ç›®å½•"><a href="#2-åˆ›å»ºæŒä¹…åŒ–ç›®å½•" class="headerlink" title="2. åˆ›å»ºæŒä¹…åŒ–ç›®å½•"></a>2. åˆ›å»ºæŒä¹…åŒ–ç›®å½•</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">mkdir -p /data/bk-cmdb/zookeepr/&#123;conf,data,log&#125;<br></code></pre></td></tr></table></figure>



<h4 id="2ï¼‰ç¼–è¾‘é…ç½®æ–‡ä»¶"><a href="#2ï¼‰ç¼–è¾‘é…ç½®æ–‡ä»¶" class="headerlink" title="2ï¼‰ç¼–è¾‘é…ç½®æ–‡ä»¶"></a>2ï¼‰ç¼–è¾‘é…ç½®æ–‡ä»¶</h4><h5 id="1-æ–°å»ºé…ç½®æ–‡ä»¶"><a href="#1-æ–°å»ºé…ç½®æ–‡ä»¶" class="headerlink" title="1. æ–°å»ºé…ç½®æ–‡ä»¶"></a>1. æ–°å»ºé…ç½®æ–‡ä»¶</h5><p>æ–‡ä»¶è·¯å¾„: <code>/data/bk-cmdb/zookeepr/conf/zoo.cfg</code>ï¼Œæ–‡ä»¶å†…å®¹å¦‚ä¸‹:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">clientPort=2181<br>dataDir=/data<br>dataLogDir=/datalog<br>tickTime=2000<br></code></pre></td></tr></table></figure>

<h5 id="2-å‚æ•°è¯´æ˜"><a href="#2-å‚æ•°è¯´æ˜" class="headerlink" title="2. å‚æ•°è¯´æ˜"></a>2. å‚æ•°è¯´æ˜</h5><table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>clientPort</td>
<td>zookeeper ç›‘å¬ç«¯å£</td>
</tr>
<tr>
<td>dataDir</td>
<td>Zookeeper ä¿å­˜æ•°æ®çš„ç›®å½•</td>
</tr>
<tr>
<td>dataLogDir</td>
<td>Zookeeper ä¿å­˜æ—¥å¿—çš„ç›®å½•</td>
</tr>
<tr>
<td>tickTime</td>
<td>Zookeeper æœåŠ¡ä¹‹é—´æˆ–ä¸å®¢æˆ·ç«¯ä¹‹é—´å¿ƒè·³æ£€æµ‹çš„é—´éš”æ—¶é—´</td>
</tr>
</tbody></table>
<h4 id="3ï¼‰å¯åŠ¨å®¹å™¨"><a href="#3ï¼‰å¯åŠ¨å®¹å™¨" class="headerlink" title="3ï¼‰å¯åŠ¨å®¹å™¨"></a>3ï¼‰å¯åŠ¨å®¹å™¨</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker run -itd --name zookeeper -p 2181:2181 -v /data/bk-cmdb/zookeepr/data:/data -v /data/bk-cmdb/zookeepr/log:/datalog -v /etc/localtime:/etc/localtime --restart=always zookeeper:3.4.12<br></code></pre></td></tr></table></figure>



<h3 id="3ã€éƒ¨ç½²-Redis"><a href="#3ã€éƒ¨ç½²-Redis" class="headerlink" title="3ã€éƒ¨ç½² Redis"></a>3ã€éƒ¨ç½² Redis</h3><h4 id="1ï¼‰ç¯å¢ƒå‡†å¤‡-1"><a href="#1ï¼‰ç¯å¢ƒå‡†å¤‡-1" class="headerlink" title="1ï¼‰ç¯å¢ƒå‡†å¤‡"></a>1ï¼‰ç¯å¢ƒå‡†å¤‡</h4><h5 id="1-æ‹‰å–é•œåƒ-ï¼ˆå®˜æ–¹æ¨è-3-2-11-ç‰ˆæœ¬ï¼‰"><a href="#1-æ‹‰å–é•œåƒ-ï¼ˆå®˜æ–¹æ¨è-3-2-11-ç‰ˆæœ¬ï¼‰" class="headerlink" title="1. æ‹‰å–é•œåƒ ï¼ˆå®˜æ–¹æ¨è 3.2.11 ç‰ˆæœ¬ï¼‰"></a>1. æ‹‰å–é•œåƒ ï¼ˆå®˜æ–¹æ¨è 3.2.11 ç‰ˆæœ¬ï¼‰</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker pull redis:3.2.11-alpine<br></code></pre></td></tr></table></figure>

<h5 id="2-åˆ›å»ºæŒä¹…åŒ–ç›®å½•-1"><a href="#2-åˆ›å»ºæŒä¹…åŒ–ç›®å½•-1" class="headerlink" title="2. åˆ›å»ºæŒä¹…åŒ–ç›®å½•"></a>2. åˆ›å»ºæŒä¹…åŒ–ç›®å½•</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">mkdir -p /data/bk-cmdb/redis/&#123;conf,data,log&#125;<br></code></pre></td></tr></table></figure>



<h4 id="2ï¼‰ç¼–è¾‘é…ç½®æ–‡ä»¶-1"><a href="#2ï¼‰ç¼–è¾‘é…ç½®æ–‡ä»¶-1" class="headerlink" title="2ï¼‰ç¼–è¾‘é…ç½®æ–‡ä»¶"></a>2ï¼‰ç¼–è¾‘é…ç½®æ–‡ä»¶</h4><h5 id="1-æ–°å»ºé…ç½®æ–‡ä»¶-1"><a href="#1-æ–°å»ºé…ç½®æ–‡ä»¶-1" class="headerlink" title="1. æ–°å»ºé…ç½®æ–‡ä»¶"></a>1. æ–°å»ºé…ç½®æ–‡ä»¶</h5><p>æ–‡ä»¶è·¯å¾„: <code>/data/bk-cmdb/redis/conf/redis.conf</code>ï¼Œæ–‡ä»¶å†…å®¹å¦‚ä¸‹:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs shell">port 6379<br>bind 0.0.0.0<br>loglevel notice<br>logfile &quot;/tmp/redis.log&quot;<br><br>dbfilename dump.rdb<br>dir ./<br>save 900 1<br>stop-writes-on-bgsave-error yes<br>rdbcompression yes<br>rdbchecksum yes<br><br>daemonize no		<br>protected-mode no<br>requirepass &#x27;PassWord@123&#x27;<br><br>maxmemory 1g<br>maxmemory-policy volatile-lru<br></code></pre></td></tr></table></figure>

<h5 id="2-å‚æ•°è¯´æ˜-1"><a href="#2-å‚æ•°è¯´æ˜-1" class="headerlink" title="2. å‚æ•°è¯´æ˜"></a>2. å‚æ•°è¯´æ˜</h5><table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>port</td>
<td>redis ç›‘å¬ç«¯å£</td>
</tr>
<tr>
<td>bind</td>
<td>redis ç›‘å¬åœ°å€ï¼Œç”±äºå®¹å™¨å¯åŠ¨ï¼Œæ•…ä½¿ç”¨ 0.0.0.0</td>
</tr>
<tr>
<td>loglevel</td>
<td>æ—¥å¿—çº§åˆ«</td>
</tr>
<tr>
<td>logfile</td>
<td>redis æ—¥å¿—æ–‡ä»¶ä¿å­˜è·¯å¾„</td>
</tr>
<tr>
<td>dbfilename</td>
<td>å¼€å¯ rdb æŒä¹…åŒ–</td>
</tr>
<tr>
<td>dir</td>
<td>æŒä¹…åŒ–æ–‡ä»¶ä¿å­˜è·¯å¾„</td>
</tr>
<tr>
<td>save</td>
<td>æ»¡è¶³æ¡ä»¶åˆ™åˆ·å…¥æŒä¹…åŒ–æ–‡ä»¶</td>
</tr>
<tr>
<td>stop-writes-on-bgsave-error</td>
<td>åå°saveå‡ºé”™,å‰å°è¦åœæ­¢å†™æ“ä½œ</td>
</tr>
<tr>
<td>rdbcompression</td>
<td>æ˜¯å¦å¯¹ rdb æŒä¹…åŒ–è¿›è¡Œæ•°æ®å‹ç¼©</td>
</tr>
<tr>
<td>rdbchecksum</td>
<td>æ˜¯å¦å¯¹ rdb æŒä¹…åŒ–è¿›è¡Œæ•°æ®æ ¡éªŒ</td>
</tr>
<tr>
<td>daemonize</td>
<td>æ˜¯å¦ä»¥åå°æ–¹å¼å¯åŠ¨ï¼Œå®¹å™¨å¯åŠ¨é€‰æ‹© no</td>
</tr>
<tr>
<td>protected-mode</td>
<td>å…³é—­ä¿æŠ¤æ¨¡å¼ï¼Œå…è®¸æ‰€æœ‰ IP è®¿é—®</td>
</tr>
<tr>
<td>requirepass</td>
<td>å¼€å¯è®¤è¯ï¼Œè®¾ç½®è®¤è¯å¯†ç </td>
</tr>
<tr>
<td>maxmemory</td>
<td>å…è®¸ä½¿ç”¨çš„æœ€å¤§å†…å­˜</td>
</tr>
<tr>
<td>maxmemory-policy</td>
<td>å†…å­˜åˆ°è¾¾æœ€å¤§å€¼æ—¶ï¼Œkey å›æ”¶çš„æœºåˆ¶</td>
</tr>
</tbody></table>
<h4 id="3ã€å¯åŠ¨å®¹å™¨"><a href="#3ã€å¯åŠ¨å®¹å™¨" class="headerlink" title="3ã€å¯åŠ¨å®¹å™¨"></a>3ã€å¯åŠ¨å®¹å™¨</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shel">docker run -itd --name redis -p 6379:6379 -v /data/bk-cmdb/redis/conf/redis.conf:/etc/redis/redis.conf -v /data/bk-cmdb/redis/data:/data -v /data/bk-cmdb/redis/log:/tmp -v /etc/localtime:/etc/localtime --restart=always redis:3.2.11-alpine <br></code></pre></td></tr></table></figure>



<h3 id="4ã€éƒ¨ç½²-MongoDB"><a href="#4ã€éƒ¨ç½²-MongoDB" class="headerlink" title="4ã€éƒ¨ç½² MongoDB"></a>4ã€éƒ¨ç½² MongoDB</h3><h4 id="1ï¼‰ç¯å¢ƒå‡†å¤‡-2"><a href="#1ï¼‰ç¯å¢ƒå‡†å¤‡-2" class="headerlink" title="1ï¼‰ç¯å¢ƒå‡†å¤‡"></a>1ï¼‰ç¯å¢ƒå‡†å¤‡</h4><h5 id="1-æ‹‰å–é•œåƒ-ï¼ˆå®˜æ–¹æ¨è-4-2-8-ç‰ˆæœ¬ï¼‰"><a href="#1-æ‹‰å–é•œåƒ-ï¼ˆå®˜æ–¹æ¨è-4-2-8-ç‰ˆæœ¬ï¼‰" class="headerlink" title="1. æ‹‰å–é•œåƒ ï¼ˆå®˜æ–¹æ¨è 4.2.8 ç‰ˆæœ¬ï¼‰"></a>1. æ‹‰å–é•œåƒ ï¼ˆå®˜æ–¹æ¨è 4.2.8 ç‰ˆæœ¬ï¼‰</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker pull mongo:4.2.8<br></code></pre></td></tr></table></figure>

<h5 id="2-åˆ›å»ºæŒä¹…åŒ–ç›®å½•-2"><a href="#2-åˆ›å»ºæŒä¹…åŒ–ç›®å½•-2" class="headerlink" title="2. åˆ›å»ºæŒä¹…åŒ–ç›®å½•"></a>2. åˆ›å»ºæŒä¹…åŒ–ç›®å½•</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">mkdir -p /data/bk-cmdb/mongodb/&#123;conf,data,log&#125;<br></code></pre></td></tr></table></figure>



<h4 id="2ï¼‰ç¼–è¾‘é…ç½®æ–‡ä»¶-2"><a href="#2ï¼‰ç¼–è¾‘é…ç½®æ–‡ä»¶-2" class="headerlink" title="2ï¼‰ç¼–è¾‘é…ç½®æ–‡ä»¶"></a>2ï¼‰ç¼–è¾‘é…ç½®æ–‡ä»¶</h4><h5 id="1-æ–°å»ºé…ç½®æ–‡ä»¶-2"><a href="#1-æ–°å»ºé…ç½®æ–‡ä»¶-2" class="headerlink" title="1. æ–°å»ºé…ç½®æ–‡ä»¶"></a>1. æ–°å»ºé…ç½®æ–‡ä»¶</h5><p>æ–‡ä»¶è·¯å¾„: <code>/data/bk-cmdb/mongodb/conf/mongod.conf.orig</code>ï¼Œæ–‡ä»¶å†…å®¹å¦‚ä¸‹:</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">storage:</span><br>  <span class="hljs-attr">dbPath:</span> <span class="hljs-string">/data/db</span><br>  <span class="hljs-attr">journal:</span><br>    <span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span><br><span class="hljs-comment">#  engine:</span><br><span class="hljs-comment">#  mmapv1:</span><br><span class="hljs-comment">#  wiredTiger:</span><br><br><span class="hljs-comment"># where to write logging data.</span><br><span class="hljs-comment">#systemLog:</span><br><span class="hljs-comment">#  destination: file</span><br><span class="hljs-comment">#  logAppend: true</span><br><span class="hljs-comment">#  path: /var/log/mongodb/mongod.log</span><br><br><span class="hljs-comment"># network interfaces</span><br><span class="hljs-attr">net:</span><br>  <span class="hljs-attr">port:</span> <span class="hljs-number">27017</span><br><span class="hljs-comment">#å¼€å¯è¿œç¨‹è®¿é—®</span><br>  <span class="hljs-attr">bindIp:</span> <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span><br><br><br><span class="hljs-comment"># how the process runs</span><br><span class="hljs-attr">processManagement:</span><br>  <span class="hljs-attr">timeZoneInfo:</span> <span class="hljs-string">/usr/share/zoneinfo</span><br><br><span class="hljs-attr">setParameter:</span><br>   <span class="hljs-attr">enableLocalhostAuthBypass:</span> <span class="hljs-literal">false</span><br><br><span class="hljs-comment">#security:									</span><br><span class="hljs-comment">#  authorization: enable</span><br>  <br><span class="hljs-comment">#operationProfiling:</span><br><span class="hljs-comment">#å‰¯æœ¬é›†é…ç½®å†…å®¹ã€‚</span><br><span class="hljs-attr">replication:</span><br>  <span class="hljs-attr">replSetName:</span> <span class="hljs-string">es</span><br>  <span class="hljs-attr">oplogSizeMB:</span> <span class="hljs-number">10240</span><br></code></pre></td></tr></table></figure>

<h5 id="2-å‚æ•°è¯´æ˜-2"><a href="#2-å‚æ•°è¯´æ˜-2" class="headerlink" title="2. å‚æ•°è¯´æ˜"></a>2. å‚æ•°è¯´æ˜</h5><table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>storage.dbPath</td>
<td>mongodbæ•°æ®æ–‡ä»¶ä¿å­˜è·¯å¾„</td>
</tr>
<tr>
<td>storage.journal.enabled</td>
<td>è®°å½•æ“ä½œæ—¥å¿—ï¼Œé˜²æ­¢æ•°æ®ä¸¢å¤±</td>
</tr>
<tr>
<td>systemLog.destination</td>
<td>æ—¥å¿—è¾“å‡ºç›®æ ‡ï¼Œfile æˆ– syslog; ä¸é…ç½®åˆ™æ ‡å‡†è¾“å‡ºï¼ˆå®¹å™¨æ¨èï¼‰</td>
</tr>
<tr>
<td>net.port</td>
<td>ç›‘å¬ç«¯å£</td>
</tr>
<tr>
<td>net.bindIp</td>
<td>ç›‘å¬IPåœ°å€</td>
</tr>
<tr>
<td>processManagement.timeZoneInfo</td>
<td>æ—¶åŒºé…ç½®</td>
</tr>
<tr>
<td>security.authorization</td>
<td>å¼€å¯ auth è®¤è¯</td>
</tr>
<tr>
<td>replication.replSetName</td>
<td>å‰¯æœ¬é›†é…ç½®ï¼Œå‰¯æœ¬é›†åç§°</td>
</tr>
<tr>
<td>replication.oplogSizeMB</td>
<td>å‰¯æœ¬é›†é…ç½®ï¼ŒæŒ‡å®šoplogçš„æœ€å¤§å°ºå¯¸</td>
</tr>
<tr>
<td>enableLocalhostAuthBypass</td>
<td>é™åˆ¶ç¬¬ä¸€ä¸ªç”¨æˆ·ä¹Ÿå— auth è®¤è¯æ§åˆ¶</td>
</tr>
</tbody></table>
<h4 id="3ï¼‰å¯åŠ¨å®¹å™¨-1"><a href="#3ï¼‰å¯åŠ¨å®¹å™¨-1" class="headerlink" title="3ï¼‰å¯åŠ¨å®¹å™¨"></a>3ï¼‰å¯åŠ¨å®¹å™¨</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker run -itd --name mongodb -p 27017:27017 -e &quot;TZ=Asia/Shanghai&quot; -v /data/bk-cmdb/mongodb/conf/mongod.conf.orig:/etc/mongod.conf.orig -v /data/bk-cmdb/mongodb/data:/data/db -v /etc/localtime:/etc/localtime --restart=always mongo:4.2.8 --config /etc/mongod.conf.orig<br></code></pre></td></tr></table></figure>



<h3 id="5ã€é…ç½®æ•°æ®åº“"><a href="#5ã€é…ç½®æ•°æ®åº“" class="headerlink" title="5ã€é…ç½®æ•°æ®åº“"></a>5ã€é…ç½®æ•°æ®åº“</h3><h4 id="1ï¼‰åˆ›å»ºç®¡ç†ç”¨æˆ·"><a href="#1ï¼‰åˆ›å»ºç®¡ç†ç”¨æˆ·" class="headerlink" title="1ï¼‰åˆ›å»ºç®¡ç†ç”¨æˆ·"></a>1ï¼‰åˆ›å»ºç®¡ç†ç”¨æˆ·</h4><h5 id="1-è¿›å…¥å®¹å™¨"><a href="#1-è¿›å…¥å®¹å™¨" class="headerlink" title="1. è¿›å…¥å®¹å™¨"></a>1. è¿›å…¥å®¹å™¨</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker exec -it mongodb /bin/bash<br></code></pre></td></tr></table></figure>

<h5 id="2-è¿æ¥-mongo"><a href="#2-è¿æ¥-mongo" class="headerlink" title="2. è¿æ¥ mongo"></a>2. è¿æ¥ mongo</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">mongo<br></code></pre></td></tr></table></figure>

<p><img src="http://uniondrug-devops.oss-cn-hangzhou.aliyuncs.com/blog_images/image-20210826165034092.png" srcset="/img/loading.gif" lazyload alt="image-20210826165034092"></p>
<blockquote>
<p>âš ï¸ <strong>æ³¨æ„:</strong> </p>
<p>åœ¨å¯åŠ¨ mongo å®¹å™¨ä¸­ï¼Œæˆ‘ä»¬æ³¨é‡Šæ‰äº† auth è®¤è¯ï¼Œè¿™æ˜¯ä¸ºäº†åˆ›å»ºç®¡ç†ç”¨æˆ·ï¼Œå¦åˆ™æˆ‘ä»¬æ— æ³•è¿›è¡Œè®¤è¯ï¼Œä½†æ˜¯è¿™ç§æƒ…å†µä¼šå¯¼è‡´é£é™©æŠ¥è­¦ï¼Œæ‰€ä»¥åœ¨åˆ›å»ºå®Œç®¡ç†ç”¨æˆ·åï¼Œè¦å°†è®¤è¯é…ç½®æ‰“å¼€ã€‚</p>
</blockquote>
<h5 id="3-åˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·"><a href="#3-åˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·" class="headerlink" title="3. åˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·"></a>3. åˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> è¿›å…¥å®¹å™¨å¹¶è¿æ¥ mongo åï¼Œæ‰§è¡Œ</span><br>use admin<br>db.createUser(&#123;user:&#x27;admin&#x27;, pwd:&#x27;admin&#x27;, roles:[&#123;role:&#x27;root&#x27;,db:&#x27;admin&#x27;&#125;]&#125;)<br></code></pre></td></tr></table></figure>

<p><img src="http://uniondrug-devops.oss-cn-hangzhou.aliyuncs.com/blog_images/image-20210826165251592.png" srcset="/img/loading.gif" lazyload alt="image-20210826165251592"></p>
<h5 id="4-æ‰“å¼€-auth-é…ç½®"><a href="#4-æ‰“å¼€-auth-é…ç½®" class="headerlink" title="4. æ‰“å¼€ auth é…ç½®"></a>4. æ‰“å¼€ auth é…ç½®</h5><p>æ–‡ä»¶è·¯å¾„: <code>/data/bk-cmdb/mongodb/conf/mongod.conf.orig</code>ï¼Œå–æ¶ˆ auth çš„æ³¨é‡Š:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> ...</span><br><br>security:<br>  authorization: enabled<br><span class="hljs-meta">  </span><br><span class="hljs-meta">#</span><span class="bash"> ...</span><br></code></pre></td></tr></table></figure>

<h5 id="5-é‡å¯mongoå®¹å™¨"><a href="#5-é‡å¯mongoå®¹å™¨" class="headerlink" title="5. é‡å¯mongoå®¹å™¨"></a>5. é‡å¯mongoå®¹å™¨</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker restart mongodb<br></code></pre></td></tr></table></figure>

<h5 id="6-å†æ¬¡è¿›å…¥å®¹å™¨å¹¶è¿æ¥-mongoï¼Œå¹¶è®¤è¯"><a href="#6-å†æ¬¡è¿›å…¥å®¹å™¨å¹¶è¿æ¥-mongoï¼Œå¹¶è®¤è¯" class="headerlink" title="6. å†æ¬¡è¿›å…¥å®¹å™¨å¹¶è¿æ¥ mongoï¼Œå¹¶è®¤è¯"></a>6. å†æ¬¡è¿›å…¥å®¹å™¨å¹¶è¿æ¥ mongoï¼Œå¹¶è®¤è¯</h5><p><img src="http://uniondrug-devops.oss-cn-hangzhou.aliyuncs.com/blog_images/image-20210826161721885.png" srcset="/img/loading.gif" lazyload alt="image-20210826161721885"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">use admin<br>db.auth(&#x27;admin&#x27;,&#x27;admin&#x27;)<br></code></pre></td></tr></table></figure>

<p><img src="http://uniondrug-devops.oss-cn-hangzhou.aliyuncs.com/blog_images/image-20210826165917027.png" srcset="/img/loading.gif" lazyload alt="image-20210826165917027"></p>
<h4 id="2ï¼‰é…ç½®-mongo-å‰¯æœ¬é›†"><a href="#2ï¼‰é…ç½®-mongo-å‰¯æœ¬é›†" class="headerlink" title="2ï¼‰é…ç½® mongo å‰¯æœ¬é›†"></a>2ï¼‰é…ç½® mongo å‰¯æœ¬é›†</h4><blockquote>
<p>âš ï¸ <strong>æ³¨æ„:</strong></p>
<p>å¦‚æœ mongo æ˜¯ä»¥å‰¯æœ¬é›†çš„æ–¹å¼å¯åŠ¨çš„ï¼Œéœ€è¦å¯¹å‰¯æœ¬é›†è¿›è¡Œåˆå§‹åŒ–</p>
<p><code>replSetName</code> å³å‰¯æœ¬é›†çš„åç§° </p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> è¿›å…¥å®¹å™¨å¹¶è¿æ¥mongoï¼Œå¹¶è®¤è¯åæ‰§è¡Œ</span><br><span class="hljs-meta">#</span><span class="bash"> _id å³ä½¿ç”¨ replSetName, host ä¸ºå®ä¾‹çš„ IP:Port</span><br>rs.initiate(&#123; _id : &quot;es&quot;,members: [&#123; _id: 0, host: &quot;192.168.3.206:27017&quot; &#125;]&#125;)<br></code></pre></td></tr></table></figure>

<p><img src="http://uniondrug-devops.oss-cn-hangzhou.aliyuncs.com/blog_images/image-20210826171334054.png" srcset="/img/loading.gif" lazyload alt="image-20210826171334054"></p>
<h4 id="3ï¼‰åˆ›å»º-cmdb-åº“å’Œç”¨æˆ·"><a href="#3ï¼‰åˆ›å»º-cmdb-åº“å’Œç”¨æˆ·" class="headerlink" title="3ï¼‰åˆ›å»º cmdb åº“å’Œç”¨æˆ·"></a>3ï¼‰åˆ›å»º cmdb åº“å’Œç”¨æˆ·</h4><h5 id="1-ä¸ä½¿ç”¨-es-åšå…¨æ–‡æ£€ç´¢"><a href="#1-ä¸ä½¿ç”¨-es-åšå…¨æ–‡æ£€ç´¢" class="headerlink" title="1. ä¸ä½¿ç”¨ es åšå…¨æ–‡æ£€ç´¢"></a>1. ä¸ä½¿ç”¨ es åšå…¨æ–‡æ£€ç´¢</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> è¿›å…¥å®¹å™¨å¹¶è¿æ¥mongoï¼Œå¹¶è®¤è¯åæ‰§è¡Œ</span><br>use cmdb<br>db.createUser(&#123;user: &quot;cc&quot;,pwd: &quot;cc&quot;,roles: [ &#123; role: &quot;readWrite&quot;, db: &quot;cmdb&quot; &#125; ]&#125;)<br></code></pre></td></tr></table></figure>

<h5 id="2-ä½¿ç”¨-mongo-monstache-es-åšå…¨æ–‡æ£€ç´¢ï¼ˆæœ¬æ–‡é€‰æ‹©ï¼‰"><a href="#2-ä½¿ç”¨-mongo-monstache-es-åšå…¨æ–‡æ£€ç´¢ï¼ˆæœ¬æ–‡é€‰æ‹©ï¼‰" class="headerlink" title="2. ä½¿ç”¨ mongo + monstache + es åšå…¨æ–‡æ£€ç´¢ï¼ˆæœ¬æ–‡é€‰æ‹©ï¼‰"></a>2. ä½¿ç”¨ mongo + monstache + es åšå…¨æ–‡æ£€ç´¢ï¼ˆæœ¬æ–‡é€‰æ‹©ï¼‰</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> è¿›å…¥å®¹å™¨å¹¶è¿æ¥mongoï¼Œå¹¶è®¤è¯åæ‰§è¡Œ</span><br>use cmdb<br>db.createUser(&#123;user: &quot;cc&quot;,pwd: &quot;cc&quot;,roles: [ &#123; role: &quot;readWrite&quot;, db: &quot;cmdb&quot; &#125;,&#123; role: &quot;readWrite&quot;, db: &quot;monstache&quot; &#125; ]&#125;)<br></code></pre></td></tr></table></figure>

<p><img src="http://uniondrug-devops.oss-cn-hangzhou.aliyuncs.com/blog_images/image-20210826170838042.png" srcset="/img/loading.gif" lazyload alt="image-20210826170838042"></p>
<h3 id="6ã€éƒ¨ç½²-Elasticsearchï¼ˆå¯é€‰ï¼‰"><a href="#6ã€éƒ¨ç½²-Elasticsearchï¼ˆå¯é€‰ï¼‰" class="headerlink" title="6ã€éƒ¨ç½² Elasticsearchï¼ˆå¯é€‰ï¼‰"></a>6ã€éƒ¨ç½² Elasticsearchï¼ˆå¯é€‰ï¼‰</h3><h4 id="1ï¼‰ç¯å¢ƒå‡†å¤‡-3"><a href="#1ï¼‰ç¯å¢ƒå‡†å¤‡-3" class="headerlink" title="1ï¼‰ç¯å¢ƒå‡†å¤‡"></a>1ï¼‰ç¯å¢ƒå‡†å¤‡</h4><h5 id="1-æ‹‰å–é•œåƒ-ï¼ˆå®˜æ–¹æ¨è-7-0-0-ç‰ˆæœ¬ï¼‰"><a href="#1-æ‹‰å–é•œåƒ-ï¼ˆå®˜æ–¹æ¨è-7-0-0-ç‰ˆæœ¬ï¼‰" class="headerlink" title="1. æ‹‰å–é•œåƒ ï¼ˆå®˜æ–¹æ¨è 7.0.0 ç‰ˆæœ¬ï¼‰"></a>1. æ‹‰å–é•œåƒ ï¼ˆå®˜æ–¹æ¨è 7.0.0 ç‰ˆæœ¬ï¼‰</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker pull elasticsearch:7.0.0<br></code></pre></td></tr></table></figure>

<h5 id="2-åˆ›å»ºæŒä¹…åŒ–ç›®å½•-3"><a href="#2-åˆ›å»ºæŒä¹…åŒ–ç›®å½•-3" class="headerlink" title="2. åˆ›å»ºæŒä¹…åŒ–ç›®å½•"></a>2. åˆ›å»ºæŒä¹…åŒ–ç›®å½•</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">mkdir -p /data/bk-cmdb/elasticsearch/&#123;conf,data,log,plugins&#125;<br></code></pre></td></tr></table></figure>



<h4 id="2ï¼‰ç¼–è¾‘é…ç½®æ–‡ä»¶-3"><a href="#2ï¼‰ç¼–è¾‘é…ç½®æ–‡ä»¶-3" class="headerlink" title="2ï¼‰ç¼–è¾‘é…ç½®æ–‡ä»¶"></a>2ï¼‰ç¼–è¾‘é…ç½®æ–‡ä»¶</h4><h5 id="1-æ–°å»ºé…ç½®æ–‡ä»¶-3"><a href="#1-æ–°å»ºé…ç½®æ–‡ä»¶-3" class="headerlink" title="1. æ–°å»ºé…ç½®æ–‡ä»¶"></a>1. æ–°å»ºé…ç½®æ–‡ä»¶</h5><p>æ–‡ä»¶è·¯å¾„: <code>/data/bk-cmdb/elasticsearch/conf/elasticsearch.yml</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">echo &quot;network.host: 0.0.0.0&quot; &gt;&gt; /data/bk-cmdb/elasticsearch/conf/elasticsearch.yml<br></code></pre></td></tr></table></figure>

<h5 id="2-å‚æ•°è¯´æ˜-3"><a href="#2-å‚æ•°è¯´æ˜-3" class="headerlink" title="2. å‚æ•°è¯´æ˜"></a>2. å‚æ•°è¯´æ˜</h5><table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>network.host</td>
<td>es ç›‘å¬ç«¯å£</td>
</tr>
</tbody></table>
<h4 id="3ï¼‰è¿è¡Œå®¹å™¨"><a href="#3ï¼‰è¿è¡Œå®¹å™¨" class="headerlink" title="3ï¼‰è¿è¡Œå®¹å™¨"></a>3ï¼‰è¿è¡Œå®¹å™¨</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker run -itd --name elasticsearch -p 9200:9200 -p 9300:9300  -e &quot;discovery.type=single-node&quot; -e ES_JAVA_OPTS=&quot;-Xms256m -Xmx256m&quot; -v /data/bk-cmdb/elasticsearch/conf/elasticsearch.yml:/usr/share/elasticsearch/config/elasticsearch.yml -v /data/bk-cmdb/elasticsearch/data:/usr/share/elasticsearch/data -v /data/bk-cmdb/elasticsearch/plugins:/usr/share/elasticsearch/plugins -v /etc/localtime:/etc/localtime  elasticsearch:7.0.0 <br></code></pre></td></tr></table></figure>



<h3 id="7ã€éƒ¨ç½²-Monstacheï¼ˆå¯é€‰ï¼‰"><a href="#7ã€éƒ¨ç½²-Monstacheï¼ˆå¯é€‰ï¼‰" class="headerlink" title="7ã€éƒ¨ç½² Monstacheï¼ˆå¯é€‰ï¼‰"></a>7ã€éƒ¨ç½² Monstacheï¼ˆå¯é€‰ï¼‰</h3><h4 id="1ï¼‰ç¯å¢ƒå‡†å¤‡-4"><a href="#1ï¼‰ç¯å¢ƒå‡†å¤‡-4" class="headerlink" title="1ï¼‰ç¯å¢ƒå‡†å¤‡"></a>1ï¼‰ç¯å¢ƒå‡†å¤‡</h4><h5 id="Monstache-Mongodb-Es-ç‰ˆæœ¬é€‰æ‹©"><a href="#Monstache-Mongodb-Es-ç‰ˆæœ¬é€‰æ‹©" class="headerlink" title="Monstache-Mongodb-Es ç‰ˆæœ¬é€‰æ‹©:"></a><strong>Monstache-Mongodb-Es ç‰ˆæœ¬é€‰æ‹©:</strong></h5><table>
<thead>
<tr>
<th>Monstache version</th>
<th>Git branch (used to build plugin)</th>
<th>Docker tag</th>
<th>Description</th>
<th>Elasticsearch</th>
<th>MongoDB</th>
</tr>
</thead>
<tbody><tr>
<td>3</td>
<td>rel3</td>
<td>rel3</td>
<td>mgo community go driver</td>
<td>Versions 2 and 5</td>
<td>Version 3</td>
</tr>
<tr>
<td>4</td>
<td>master</td>
<td>rel4 (note this used to be latest)</td>
<td>mgo community go driver</td>
<td>Version 6</td>
<td>Version 3</td>
</tr>
<tr>
<td>5</td>
<td>rel5</td>
<td>rel5</td>
<td>MongoDB, Inc. go driver</td>
<td>Version 6</td>
<td>Version 4</td>
</tr>
<tr>
<td>6</td>
<td>rel6</td>
<td>rel6, latest</td>
<td>MongoDB, Inc. go driver</td>
<td>Version 7</td>
<td>Version 4</td>
</tr>
</tbody></table>
<h5 id="1-æ‹‰å–é•œåƒ-ï¼ˆå®˜æ–¹æ¨è-rel6-ç‰ˆæœ¬ï¼‰"><a href="#1-æ‹‰å–é•œåƒ-ï¼ˆå®˜æ–¹æ¨è-rel6-ç‰ˆæœ¬ï¼‰" class="headerlink" title="1. æ‹‰å–é•œåƒ ï¼ˆå®˜æ–¹æ¨è rel6 ç‰ˆæœ¬ï¼‰"></a>1. æ‹‰å–é•œåƒ ï¼ˆå®˜æ–¹æ¨è rel6 ç‰ˆæœ¬ï¼‰</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker pull rwynn/monstache:rel6<br></code></pre></td></tr></table></figure>

<h5 id="2-åˆ›å»ºæŒä¹…åŒ–ç›®å½•-4"><a href="#2-åˆ›å»ºæŒä¹…åŒ–ç›®å½•-4" class="headerlink" title="2. åˆ›å»ºæŒä¹…åŒ–ç›®å½•"></a>2. åˆ›å»ºæŒä¹…åŒ–ç›®å½•</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">mkdir -p /data/bk-cmdb/monstache/&#123;conf,data,log&#125;<br></code></pre></td></tr></table></figure>



<h4 id="2ï¼‰ç¼–è¾‘é…ç½®æ–‡ä»¶-4"><a href="#2ï¼‰ç¼–è¾‘é…ç½®æ–‡ä»¶-4" class="headerlink" title="2ï¼‰ç¼–è¾‘é…ç½®æ–‡ä»¶"></a>2ï¼‰ç¼–è¾‘é…ç½®æ–‡ä»¶</h4><h5 id="1-æ–°å»ºé…ç½®æ–‡ä»¶-4"><a href="#1-æ–°å»ºé…ç½®æ–‡ä»¶-4" class="headerlink" title="1. æ–°å»ºé…ç½®æ–‡ä»¶"></a>1. æ–°å»ºé…ç½®æ–‡ä»¶</h5><p>æ–‡ä»¶è·¯å¾„: <code>/data/bk-cmdb/monstache/conf/config.toml</code>ï¼Œæ–‡ä»¶å†…å®¹å¦‚ä¸‹:</p>
<figure class="highlight toml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs toml"><span class="hljs-comment"># cmdb connection settings</span><br><br><span class="hljs-comment"># connect to MongoDB using the following URL</span><br><span class="hljs-attr">mongo-url</span> =  <span class="hljs-string">&quot;mongodb://cc:cc@192.168.3.206:27017/cmdb&quot;</span><br><span class="hljs-comment"># connect to the Elasticsearch REST API at the following node URLs</span><br><span class="hljs-attr">elasticsearch-urls</span> = [<span class="hljs-string">&quot;http://192.168.3.206:9200&quot;</span>]<br><br><span class="hljs-comment"># frequently required settings</span><br><br><span class="hljs-comment"># if you need to seed an index from a collection and not just listen and sync changes events</span><br><span class="hljs-comment"># you can copy entire collections or views from MongoDB to Elasticsearch</span><br><span class="hljs-attr">direct-read-namespaces</span> = [<span class="hljs-string">&quot;cmdb.cc_ApplicationBase&quot;</span>,<span class="hljs-string">&quot;cmdb.cc_HostBase&quot;</span>,<span class="hljs-string">&quot;cmdb.cc_ObjectBase&quot;</span>,<span class="hljs-string">&quot;cmdb.cc_ObjDes&quot;</span>]<br><br><span class="hljs-comment"># if you want to use MongoDB change streams instead of legacy oplog tailing use change-stream-namespaces</span><br><span class="hljs-comment"># change streams require at least MongoDB API 3.6+</span><br><span class="hljs-comment"># if you have MongoDB 4+ you can listen for changes to an entire database or entire deployment</span><br><span class="hljs-comment"># in this case you usually don&#x27;t need regexes in your config to filter collections unless you target the deployment.</span><br><span class="hljs-comment"># to listen to an entire db use only the database name.  For a deployment use an empty string.</span><br><span class="hljs-attr">change-stream-namespaces</span> = [<span class="hljs-string">&quot;cmdb.cc_ApplicationBase&quot;</span>,<span class="hljs-string">&quot;cmdb.cc_HostBase&quot;</span>,<span class="hljs-string">&quot;cmdb.cc_ObjectBase&quot;</span>,<span class="hljs-string">&quot;cmdb.cc_ObjDes&quot;</span>]<br><br><span class="hljs-comment"># additional settings</span><br><br><span class="hljs-comment"># compress requests to Elasticsearch</span><br><span class="hljs-attr">gzip</span> = <span class="hljs-literal">true</span><br><span class="hljs-comment"># use the following user name for Elasticsearch basic auth</span><br><span class="hljs-attr">elasticsearch-user</span> = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-comment"># use the following password for Elasticsearch basic auth</span><br><span class="hljs-attr">elasticsearch-password</span> = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-comment"># use 4 go routines concurrently pushing documents to Elasticsearch</span><br><span class="hljs-attr">elasticsearch-max-conns</span> = <span class="hljs-number">4</span> <br><span class="hljs-comment"># propagate dropped collections in MongoDB as index deletes in Elasticsearch</span><br><span class="hljs-attr">dropped-collections</span> = <span class="hljs-literal">true</span><br><span class="hljs-comment"># propagate dropped databases in MongoDB as index deletes in Elasticsearch</span><br><span class="hljs-attr">dropped-databases</span> = <span class="hljs-literal">true</span><br><span class="hljs-comment"># resume processing from a timestamp saved in a previous run</span><br><span class="hljs-attr">resume</span> = <span class="hljs-literal">true</span><br><span class="hljs-comment"># do not validate that progress timestamps have been saved</span><br><span class="hljs-attr">resume-write-unsafe</span> = <span class="hljs-literal">false</span><br><span class="hljs-comment"># override the name under which resume state is saved</span><br><span class="hljs-attr">resume-name</span> = <span class="hljs-string">&quot;default&quot;</span><br><span class="hljs-comment"># use a custom resume strategy (tokens) instead of the default strategy (timestamps)</span><br><span class="hljs-comment"># tokens work with MongoDB API 3.6+ while timestamps work only with MongoDB API 4.0+</span><br><span class="hljs-attr">resume-strategy</span> = <span class="hljs-number">0</span><br><span class="hljs-comment"># print detailed information including request traces</span><br><span class="hljs-attr">verbose</span> = <span class="hljs-literal">true</span><br><br><span class="hljs-comment"># mapping settings</span><br><br><span class="hljs-section">[[mapping]]</span><br><span class="hljs-attr">namespace</span> = <span class="hljs-string">&quot;cmdb.cc_ApplicationBase&quot;</span><br><span class="hljs-attr">index</span> = <span class="hljs-string">&quot;cmdb.cc_applicationbase&quot;</span><br><br><span class="hljs-section">[[mapping]]</span><br><span class="hljs-attr">namespace</span> = <span class="hljs-string">&quot;cmdb.cc_HostBase&quot;</span><br><span class="hljs-attr">index</span> = <span class="hljs-string">&quot;cmdb.cc_hostbase&quot;</span><br><br><span class="hljs-section">[[mapping]]</span><br><span class="hljs-attr">namespace</span> = <span class="hljs-string">&quot;cmdb.cc_ObjectBase&quot;</span><br><span class="hljs-attr">index</span> = <span class="hljs-string">&quot;cmdb.cc_objectbase&quot;</span><br><br><span class="hljs-section">[[mapping]]</span><br><span class="hljs-attr">namespace</span> = <span class="hljs-string">&quot;cmdb.cc_ObjDes&quot;</span><br><span class="hljs-attr">index</span> = <span class="hljs-string">&quot;cmdb.cc_objdes&quot;</span><br></code></pre></td></tr></table></figure>

<h5 id="2-å‚æ•°è¯´æ˜-4"><a href="#2-å‚æ•°è¯´æ˜-4" class="headerlink" title="2. å‚æ•°è¯´æ˜"></a>2. å‚æ•°è¯´æ˜</h5><table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>mongo-url</td>
<td>MongoDBå®ä¾‹çš„ä¸»èŠ‚ç‚¹è®¿é—®åœ°å€ã€‚è¯¦æƒ…è¯·å‚è§ã€‚<a target="_blank" rel="noopener" href="https://rwynn.github.io/monstache-site/config/#mongo-url">mongo-url</a>ï¼Œå¼€å¯è®¤è¯åé…ç½®ä¸º <code>mongodb://user:password@host/dbname</code></td>
</tr>
<tr>
<td>elasticsearch-urls</td>
<td>Elasticsearchçš„è®¿é—®åœ°å€ã€‚è¯¦æƒ…è¯·å‚è§ <a target="_blank" rel="noopener" href="https://rwynn.github.io/monstache-site/config/#elasticsearch-urls">elasticsearch-urls</a></td>
</tr>
<tr>
<td>direct-read-namespaces</td>
<td>æŒ‡å®šå¾…åŒæ­¥çš„é›†åˆï¼Œè¯¦æƒ…è¯·å‚è§<a target="_blank" rel="noopener" href="https://rwynn.github.io/monstache-site/config/#direct-read-namespaces">direct-read-namespaces</a>ã€‚</td>
</tr>
<tr>
<td>change-stream-namespaces</td>
<td>å¦‚æœè¦ä½¿ç”¨MongoDBå˜æ›´æµåŠŸèƒ½ï¼Œéœ€è¦æŒ‡å®šæ­¤å‚æ•°ã€‚å¯ç”¨æ­¤å‚æ•°åï¼Œoplogè¿½è¸ªä¼šè¢«è®¾ç½®ä¸ºæ— æ•ˆï¼Œè¯¦æƒ…è¯·å‚è§<a target="_blank" rel="noopener" href="https://rwynn.github.io/monstache-site/config/#change-stream-namespaces">change-stream-namespaces</a>ã€‚</td>
</tr>
<tr>
<td>namespace-regex</td>
<td>é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼æŒ‡å®šéœ€è¦ç›‘å¬çš„é›†åˆã€‚æ­¤è®¾ç½®å¯ä»¥ç”¨æ¥ç›‘æ§ç¬¦åˆæ­£åˆ™è¡¨è¾¾å¼çš„é›†åˆä¸­æ•°æ®çš„å˜åŒ–ã€‚</td>
</tr>
<tr>
<td>elasticsearch-user</td>
<td>è®¿é—®Elasticsearchçš„ç”¨æˆ·åã€‚</td>
</tr>
<tr>
<td>elasticsearch-password</td>
<td>è®¿é—®Elasticsearchçš„ç”¨æˆ·å¯†ç ã€‚</td>
</tr>
<tr>
<td>elasticsearch-max-conns</td>
<td>å®šä¹‰è¿æ¥ESçš„çº¿ç¨‹æ•°ã€‚é»˜è®¤ä¸º4ï¼Œå³ä½¿ç”¨4ä¸ªGoçº¿ç¨‹åŒæ—¶å°†æ•°æ®åŒæ­¥åˆ°ESã€‚</td>
</tr>
<tr>
<td>dropped-collections</td>
<td>é»˜è®¤ä¸ºtrueï¼Œè¡¨ç¤ºå½“åˆ é™¤MongoDBé›†åˆæ—¶ï¼Œä¼šåŒæ—¶åˆ é™¤ESä¸­å¯¹åº”çš„ç´¢å¼•ã€‚</td>
</tr>
<tr>
<td>dropped-databases</td>
<td>é»˜è®¤ä¸ºtrueï¼Œè¡¨ç¤ºå½“åˆ é™¤MongoDBæ•°æ®åº“æ—¶ï¼Œä¼šåŒæ—¶åˆ é™¤ESä¸­å¯¹åº”çš„ç´¢å¼•ã€‚</td>
</tr>
<tr>
<td>resume</td>
<td>é»˜è®¤ä¸ºfalseã€‚è®¾ç½®ä¸ºtrueï¼ŒMonstacheä¼šå°†å·²æˆåŠŸåŒæ­¥åˆ°ESçš„MongoDBæ“ä½œçš„æ—¶é—´æˆ³å†™å…¥monstache.monstacheé›†åˆä¸­ã€‚å½“Monstacheå› ä¸ºæ„å¤–åœæ­¢æ—¶ï¼Œå¯é€šè¿‡è¯¥æ—¶é—´æˆ³æ¢å¤åŒæ­¥ä»»åŠ¡ï¼Œé¿å…æ•°æ®ä¸¢å¤±ã€‚å¦‚æœæŒ‡å®šäº†cluster-nameï¼Œè¯¥å‚æ•°å°†è‡ªåŠ¨å¼€å¯ï¼Œè¯¦æƒ…è¯·å‚è§<a target="_blank" rel="noopener" href="https://rwynn.github.io/monstache-site/config/#resume">resume</a>ã€‚</td>
</tr>
<tr>
<td>resume-strategy</td>
<td>æŒ‡å®šæ¢å¤ç­–ç•¥ã€‚ä»…å½“resumeä¸ºtrueæ—¶ç”Ÿæ•ˆï¼Œè¯¦æƒ…è¯·å‚è§<a target="_blank" rel="noopener" href="https://rwynn.github.io/monstache-site/config/#resume-strategy">resume-strategy</a>ã€‚</td>
</tr>
<tr>
<td>verbose</td>
<td>é»˜è®¤ä¸ºfalseï¼Œè¡¨ç¤ºä¸å¯ç”¨è°ƒè¯•æ—¥å¿—ã€‚</td>
</tr>
<tr>
<td>cluster-name</td>
<td>æŒ‡å®šé›†ç¾¤åç§°ã€‚æŒ‡å®šåï¼ŒMonstacheå°†è¿›å…¥é«˜å¯ç”¨æ¨¡å¼ï¼Œé›†ç¾¤åç§°ç›¸åŒçš„è¿›ç¨‹å°†è¿›è¡Œåè°ƒï¼Œè¯¦æƒ…è¯·å‚è§<a target="_blank" rel="noopener" href="https://rwynn.github.io/monstache-site/config/#cluster-name">cluster-name</a>ã€‚</td>
</tr>
<tr>
<td>mapping</td>
<td>æŒ‡å®šESç´¢å¼•æ˜ å°„ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ•°æ®ä»MongoDBåŒæ­¥åˆ°ESæ—¶ï¼Œç´¢å¼•ä¼šè‡ªåŠ¨æ˜ å°„ä¸º<code>æ•°æ®åº“å.é›†åˆå</code>ã€‚å¦‚æœéœ€è¦ä¿®æ”¹ç´¢å¼•åç§°ï¼Œå¯é€šè¿‡è¯¥å‚æ•°è®¾ç½®ï¼Œè¯¦æƒ…è¯·å‚è§<a target="_blank" rel="noopener" href="https://rwynn.github.io/monstache-site/advanced/#index-mapping">Index Mapping</a>ã€‚</td>
</tr>
</tbody></table>
<h4 id="3ï¼‰å¯åŠ¨å®¹å™¨-2"><a href="#3ï¼‰å¯åŠ¨å®¹å™¨-2" class="headerlink" title="3ï¼‰å¯åŠ¨å®¹å™¨"></a>3ï¼‰å¯åŠ¨å®¹å™¨</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker run -itd --name monstache -v /data/bk-cmdb/monstache/conf/config.toml:/app/monstache.config.toml -v /etc/localtime:/etc/localtime --restart=always rwynn/monstache:rel6 -f /app/monstache.config.toml<br></code></pre></td></tr></table></figure>



<h3 id="8ã€éƒ¨ç½²è“é²¸"><a href="#8ã€éƒ¨ç½²è“é²¸" class="headerlink" title="8ã€éƒ¨ç½²è“é²¸"></a>8ã€éƒ¨ç½²è“é²¸</h3><h4 id="1ï¼‰è§£å‹ç¼–è¯‘åçš„-cmdb-tar-gz"><a href="#1ï¼‰è§£å‹ç¼–è¯‘åçš„-cmdb-tar-gz" class="headerlink" title="1ï¼‰è§£å‹ç¼–è¯‘åçš„ cmdb.tar.gz"></a>1ï¼‰è§£å‹ç¼–è¯‘åçš„ <code>cmdb.tar.gz</code></h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">tar xf ~/go/src/configcenter/src/bin/pub/cmdb.tar.gz -C /data/softwares &amp;&amp; \<br>cd /data/softwares/cmdb<br></code></pre></td></tr></table></figure>



<h4 id="2ï¼‰åˆå§‹åŒ–é…ç½®"><a href="#2ï¼‰åˆå§‹åŒ–é…ç½®" class="headerlink" title="2ï¼‰åˆå§‹åŒ–é…ç½®"></a>2ï¼‰åˆå§‹åŒ–é…ç½®</h4><h5 id="1-åˆå§‹åŒ–"><a href="#1-åˆå§‹åŒ–" class="headerlink" title="1. åˆå§‹åŒ–"></a>1. åˆå§‹åŒ–</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs shell">python init.py  \<br>      --discovery          192.168.3.206:2181 \<br>      --database           cmdb \<br>      --redis_ip           192.168.3.206 \<br>      --redis_port         6379 \<br>      --redis_pass         PassWord@123 \<br>      --mongo_ip           192.168.3.206 \<br>      --mongo_port         27017 \<br>      --mongo_user         cc \<br>      --mongo_pass         cc \<br>      --rs_name            es \<br>      --blueking_cmdb_url  http://bk-cmdb.example.com:80 \<br>      --listen_port        8083 \<br>      --auth_scheme        internal \<br>      --auth_enabled       false \<br>      --auth_sync_workers  1 \<br>      --auth_sync_interval_minutes  45 \<br>      --full_text_search   on \<br>      --es_url             http://192.168.3.206:9200 \<br>      --es_user            cc \<br>      --es_pass            cc \<br>      --log_level          3 \<br>      --register_ip        192.168.3.206 \<br>      --user_info          admin:admin<br></code></pre></td></tr></table></figure>

<p><img src="http://uniondrug-devops.oss-cn-hangzhou.aliyuncs.com/blog_images/image-20210826175509596.png" srcset="/img/loading.gif" lazyload alt="image-20210826175509596"></p>
<p>ç”Ÿæˆçš„é…ç½®æ–‡ä»¶å¦‚ä¸‹:</p>
<p><img src="http://uniondrug-devops.oss-cn-hangzhou.aliyuncs.com/blog_images/image-20210826175651688.png" srcset="/img/loading.gif" lazyload alt="image-20210826175651688"></p>
<h5 id="2-init-py-å‚æ•°è¯¦è§£ï¼š"><a href="#2-init-py-å‚æ•°è¯¦è§£ï¼š" class="headerlink" title="2. init.py å‚æ•°è¯¦è§£ï¼š"></a>2. init.py å‚æ•°è¯¦è§£ï¼š</h5><table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>ç”¨é€”è¯´æ˜</th>
<th>å¿…å¡«</th>
<th>é»˜è®¤å€¼</th>
</tr>
</thead>
<tbody><tr>
<td>â€“discovery</td>
<td>æœåŠ¡å‘ç°ç»„ä»¶ï¼ŒZooKeeper æœåŠ¡åœ°å€</td>
<td>æ˜¯</td>
<td>æ— </td>
</tr>
<tr>
<td>â€“database</td>
<td>æ•°æ®åº“åå­—</td>
<td>mongodb ä¸­æ•°æ®åº“å</td>
<td>å¦</td>
</tr>
<tr>
<td>â€“redis_ip</td>
<td>Redisç›‘å¬çš„IP</td>
<td>æ˜¯</td>
<td>æ— </td>
</tr>
<tr>
<td>â€“redis_port</td>
<td>Redisç›‘å¬çš„ç«¯å£</td>
<td>å¦</td>
<td>6379</td>
</tr>
<tr>
<td>â€“redis_pass</td>
<td>Redisç™»é™†å¯†ç </td>
<td>æ˜¯</td>
<td>æ— </td>
</tr>
<tr>
<td>â€“mongo_ip</td>
<td>MongoDBæœåŠ¡ç›‘å¬çš„IP</td>
<td>æ˜¯</td>
<td>æ— </td>
</tr>
<tr>
<td>â€“mongo_port</td>
<td>MongoDBç«¯å£</td>
<td>å¦</td>
<td>27017</td>
</tr>
<tr>
<td>â€“mongo_user</td>
<td>MongoDBä¸­CMDBæ•°æ®åº“ç”¨æˆ·å</td>
<td>æ˜¯</td>
<td>æ— </td>
</tr>
<tr>
<td>â€“mongo_pass</td>
<td>MongoDBä¸­CMDBæ•°æ®åº“ç”¨æˆ·åå¯†ç </td>
<td>æ˜¯</td>
<td>æ— </td>
</tr>
<tr>
<td>â€“blueking_cmdb_url</td>
<td>è¯¥å€¼è¡¨ç¤ºéƒ¨ç½²å®Œæˆå,è¾“å…¥åˆ°æµè§ˆå™¨ä¸­è®¿é—®çš„cmdb ç½‘å€, æ ¼å¼: <a target="_blank" rel="noopener" href="http://xx.xxx.com/">http://xx.xxx.com:80</a>, ç”¨æˆ·è‡ªå®šä¹‰å¡«å†™;åœ¨æ²¡æœ‰é…ç½® DNS è§£æçš„æƒ…å†µä¸‹, å¡«å†™æœåŠ¡å™¨çš„ IP:PORTã€‚ç«¯å£ä¸ºå½“å‰cmdb_webserverç›‘å¬çš„ç«¯å£ã€‚</td>
<td>æ˜¯</td>
<td>æ— </td>
</tr>
<tr>
<td>â€“blueking_paas_url</td>
<td>è“é²¸PAAS å¹³å°çš„åœ°å€ï¼Œå¯¹äºç‹¬ç«‹éƒ¨ç½²çš„CCç‰ˆæœ¬å¯ä»¥ä¸é…ç½®</td>
<td>å¦</td>
<td>æ— </td>
</tr>
<tr>
<td>â€“listen_port</td>
<td>cmdb_webserveræœåŠ¡ç›‘å¬çš„ç«¯å£ï¼Œé»˜è®¤æ˜¯8083</td>
<td>æ˜¯</td>
<td>8083</td>
</tr>
<tr>
<td>â€“full_text_search</td>
<td>å…¨æ–‡æ£€ç´¢åŠŸèƒ½å¼€å…³(å–å€¼ï¼šoff/on)ï¼Œé»˜è®¤æ˜¯offï¼Œå¼€å¯æ˜¯on</td>
<td>å¦</td>
<td>off</td>
</tr>
<tr>
<td>â€“es_url</td>
<td>elasticsearchæœåŠ¡ç›‘å¬urlï¼Œé»˜è®¤æ˜¯<a target="_blank" rel="noopener" href="http://192.168.3.206:9200/">http://192.168.3.206:9200</a></td>
<td>å¦</td>
<td><a target="_blank" rel="noopener" href="http://192.168.3.206:9200/">http://192.168.3.206:9200</a></td>
</tr>
<tr>
<td>â€“auth_scheme</td>
<td>æƒé™æ¨¡å¼ï¼Œwebé¡µé¢ä½¿ç”¨ï¼Œå¯é€‰å€¼: internal, iam</td>
<td>å¦</td>
<td>internal</td>
</tr>
<tr>
<td>â€“auth_enabled</td>
<td>æ˜¯å¦é‡‡ç”¨è“é²¸æƒé™ä¸­å¿ƒé‰´æƒ</td>
<td>å¦</td>
<td>false</td>
</tr>
<tr>
<td>â€“auth_address</td>
<td>è“é²¸æƒé™ä¸­å¿ƒåœ°å€</td>
<td>auth_enabled ä¸ºçœŸæ—¶å¿…å¡«</td>
<td><a target="_blank" rel="noopener" href="https://iam.domain.com/">https://iam.domain.com/</a></td>
</tr>
<tr>
<td>â€“auth_app_code</td>
<td>cmdbé¡¹ç›®åœ¨è“é²¸æƒé™ä¸­å¿ƒçš„åº”ç”¨ç¼–ç </td>
<td>auth_enabled ä¸ºçœŸæ—¶å¿…å¡«</td>
<td>bk_cmdb</td>
</tr>
<tr>
<td>â€“auth_app_secret</td>
<td>cmdbé¡¹ç›®åœ¨è“é²¸æƒé™ä¸­å¿ƒçš„åº”ç”¨å¯†é’¥</td>
<td>auth_enabled ä¸ºçœŸæ—¶å¿…å¡«</td>
<td>xxxxxxx</td>
</tr>
<tr>
<td>â€“log_level</td>
<td>æ—¥å¿—çº§åˆ«0-9, 9æ—¥å¿—æœ€è¯¦ç»†</td>
<td>å¦</td>
<td>3</td>
</tr>
<tr>
<td>â€“register_ip</td>
<td>è¿›ç¨‹æ³¨å†Œåˆ°zookeeperä¸Šçš„IPåœ°å€ï¼Œå¯ä»¥æ˜¯åŸŸå</td>
<td>å¦</td>
<td>æ— </td>
</tr>
<tr>
<td>â€“user_info</td>
<td>ç™»é™† web é¡µé¢çš„è´¦å·å¯†ç </td>
<td>å¦</td>
<td>æ— </td>
</tr>
</tbody></table>
<blockquote>
<p>ğŸš© init.py æ‰§è¡ŒæˆåŠŸåä¼šè‡ªåŠ¨ç”Ÿæˆcmdbå„æœåŠ¡è¿›ç¨‹æ‰€éœ€è¦çš„é…ç½®ã€‚</p>
</blockquote>
<h4 id="3ï¼‰å¯åŠ¨æœåŠ¡"><a href="#3ï¼‰å¯åŠ¨æœåŠ¡" class="headerlink" title="3ï¼‰å¯åŠ¨æœåŠ¡"></a>3ï¼‰å¯åŠ¨æœåŠ¡</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">cd /data/softwares/cmdb &amp;&amp; \<br>./start.sh<br></code></pre></td></tr></table></figure>

<h5 id="é—®é¢˜è®°å½•-adminserver-redis-è®¤è¯é—®é¢˜"><a href="#é—®é¢˜è®°å½•-adminserver-redis-è®¤è¯é—®é¢˜" class="headerlink" title="é—®é¢˜è®°å½•: adminserver redis è®¤è¯é—®é¢˜"></a>é—®é¢˜è®°å½•: adminserver redis è®¤è¯é—®é¢˜</h5><h6 id="é”™è¯¯ä¿¡æ¯-1"><a href="#é”™è¯¯ä¿¡æ¯-1" class="headerlink" title="é”™è¯¯ä¿¡æ¯:"></a>é”™è¯¯ä¿¡æ¯:</h6><p>å¯åŠ¨æœåŠ¡æ—¶ï¼Œéƒ¨åˆ†æœåŠ¡æ— æ³•æ­£å¸¸å¯åŠ¨ï¼Œç‰¹åˆ«æ˜¯ç®¡ç†é…ç½®çš„ adminserver</p>
<p><img src="http://uniondrug-devops.oss-cn-hangzhou.aliyuncs.com/blog_images/image-20210827130549678.png" srcset="/img/loading.gif" lazyload alt="image-20210827130549678"></p>
<p>æŸ¥çœ‹æ—¥å¿—åï¼Œé—®é¢˜çš„åŸå› åœ¨äº redis çš„è®¤è¯ä¸Š</p>
<p><img src="http://uniondrug-devops.oss-cn-hangzhou.aliyuncs.com/blog_images/image-20210827130612873.png" srcset="/img/loading.gif" lazyload alt="image-20210827130612873"></p>
<h6 id="é—®é¢˜åŸå› -2"><a href="#é—®é¢˜åŸå› -2" class="headerlink" title="é—®é¢˜åŸå› :"></a>é—®é¢˜åŸå› :</h6><p>redis å¼€å¯è®¤è¯åï¼Œåœ¨å†…å­˜ä¸­å¹¶æ²¡æœ‰ç¡®å®çš„ç”Ÿæˆå¯¹åº”çš„keyï¼Œå¯¼è‡´ç¨‹åºåœ¨åŠ è½½é…ç½®æ—¶ï¼Œæ— æ³•æ­£ç¡®åŠ è½½è®¤è¯é…ç½®ï¼ˆç¨‹åºè¯»å–çš„æ˜¯æœ¬åœ° redis çš„ config ä¸­çš„ key <code>requirepass</code>ï¼‰</p>
<p><img src="http://uniondrug-devops.oss-cn-hangzhou.aliyuncs.com/blog_images/image-20210827130902618.png" srcset="/img/loading.gif" lazyload alt="image-20210827130902618"></p>
<h6 id="è§£å†³æ–¹æ¡ˆ-1"><a href="#è§£å†³æ–¹æ¡ˆ-1" class="headerlink" title="è§£å†³æ–¹æ¡ˆ:"></a>è§£å†³æ–¹æ¡ˆ:</h6><p>å› æ­¤åªè¦å°† key å¯¹åº”çš„å€¼ï¼ˆä¹Ÿå°±æ˜¯æˆ‘ä»¬è®¾ç½®çš„å¯†ç ï¼‰ set åˆ° redis ä¸­ï¼Œå³å¯</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">CONFIG SET requirepass myPassword<br></code></pre></td></tr></table></figure>



<h4 id="4ï¼‰åˆå§‹åŒ–æ•°æ®åº“"><a href="#4ï¼‰åˆå§‹åŒ–æ•°æ®åº“" class="headerlink" title="4ï¼‰åˆå§‹åŒ–æ•°æ®åº“"></a>4ï¼‰åˆå§‹åŒ–æ•°æ®åº“</h4><blockquote>
<p>âš ï¸ <strong>æ³¨æ„:</strong>  <strong>æ­¤æ­¥éª¤å¿…éœ€è¦æ‰€æœ‰cmdbè¿›ç¨‹æˆåŠŸå¯åŠ¨åæ‰§è¡Œã€‚</strong></p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">cd /data/softwares/cmdb &amp;&amp; \<br>./init_db.sh<br></code></pre></td></tr></table></figure>

<p>è¿”å›å€¼ä¸­è¿”å› <code>migrate_success</code>ï¼Œå³æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ</p>
<p><img src="http://uniondrug-devops.oss-cn-hangzhou.aliyuncs.com/blog_images/image-20210827131349118.png" srcset="/img/loading.gif" lazyload alt="image-20210827131349118"></p>
<h4 id="5ï¼‰åœæ­¢æœåŠ¡"><a href="#5ï¼‰åœæ­¢æœåŠ¡" class="headerlink" title="5ï¼‰åœæ­¢æœåŠ¡"></a>5ï¼‰åœæ­¢æœåŠ¡</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">cd /data/softwares/cmdb &amp;&amp; \<br>./stop.sh<br></code></pre></td></tr></table></figure>



<h2 id="å››ã€æ•ˆæœå±•ç¤º"><a href="#å››ã€æ•ˆæœå±•ç¤º" class="headerlink" title="å››ã€æ•ˆæœå±•ç¤º"></a>å››ã€æ•ˆæœå±•ç¤º</h2><p><strong>æ‰“å¼€æµè§ˆå™¨:</strong> è¾“å…¥ cmdb_webserver ç›‘å¬çš„åœ°å€ï¼Œå¦‚æœ¬æ–‡æ¡£ä¸­ç¤ºä¾‹æœåŠ¡ç›‘å¬çš„åœ°å€: <a target="_blank" rel="noopener" href="http://bk-cmdb.example.com/">http://bk-cmdb.example.com</a></p>
<p><img src="http://uniondrug-devops.oss-cn-hangzhou.aliyuncs.com/blog_images/image-20210827141908936.png" srcset="/img/loading.gif" lazyload alt="image-20210827141908936"></p>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/Devops/">Devops</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/CMDB/">CMDB</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">
                  
                    æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 åè®®</a> ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2021/08/30/%E7%AC%AC1%E7%AB%A0%E3%80%81%E9%80%9A%E8%BF%87-http-%E8%B0%83%E7%94%A8-k8s-api/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">ç¬¬1ç« ã€é€šè¿‡ http è°ƒç”¨ k8s api</span>
                        <span class="visible-mobile">ä¸Šä¸€ç¯‡</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2021/08/30/%E5%B0%86%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E5%8F%8D%E5%90%91%E6%8C%81%E4%B9%85%E5%8C%96%E8%87%B3-Kubernetes-Configmap-%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/">
                        <span class="hidden-mobile">å°†é…ç½®æ–‡ä»¶åå‘æŒä¹…åŒ–è‡³ Kubernetes Configmap è§£å†³æ–¹æ¡ˆ</span>
                        <span class="visible-mobile">ä¸‹ä¸€ç¯‡</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;ç›®å½•</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">å…³é”®è¯</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
  </div>
  

  

  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  <script  src="https://cdn.jsdelivr.net/npm/tocbot@4.12.3/dist/tocbot.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4.3.1/anchor.min.js" ></script>



  <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2.0.8/dist/clipboard.min.js" ></script>



  <script  src="/js/local-search.js" ></script>






  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2.0.12/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
      typing(title)
      
    })(window, document);
  </script>















<!-- ä¸»é¢˜çš„å¯åŠ¨é¡¹ ä¿æŒåœ¨æœ€åº•éƒ¨ -->
<script  src="/js/boot.js" ></script>


</body>
</html>
