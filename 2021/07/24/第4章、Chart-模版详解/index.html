

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=&#34;auto&#34;>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/icon.png">
  <link rel="icon" href="/img/icon.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="ç¬¬4ç« ã€Chart æ¨¡ç‰ˆè¯¦è§£">
  <meta name="author" content="Tareya">
  <meta name="keywords" content="">
  
  <title>ç¬¬4ç« ã€Chart æ¨¡ç‰ˆè¯¦è§£ - ä¹±åºæ—¶ç©º</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10.7.2/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
  



<!-- ä¸»é¢˜ä¾èµ–çš„å›¾æ ‡åº“ï¼Œä¸è¦è‡ªè¡Œä¿®æ”¹ -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- è‡ªå®šä¹‰æ ·å¼ä¿æŒåœ¨æœ€åº•éƒ¨ -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"tareya.github.io","root":"/","version":"1.8.11","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null}},"search_path":"/local-search.xml"};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.4.0"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>ä¹±åºæ—¶ç©º</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                é¦–é¡µ
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                å½’æ¡£
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                åˆ†ç±»
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                æ ‡ç­¾
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                å…³äº
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" data-toggle="modal" data-target="#modalSearch">&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;</a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/background/lomo5.jpeg') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="ç¬¬4ç« ã€Chart æ¨¡ç‰ˆè¯¦è§£">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2021-07-24 17:12" pubdate>
        2021å¹´7æœˆ24æ—¥ ä¸‹åˆ
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      3.2k å­—
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      39
       åˆ†é’Ÿ
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">ç¬¬4ç« ã€Chart æ¨¡ç‰ˆè¯¦è§£</h1>
            
            <div class="markdown-body">
              <h1 id="ç¬¬4ç« ã€Chart-æ¨¡ç‰ˆè¯¦è§£"><a href="#ç¬¬4ç« ã€Chart-æ¨¡ç‰ˆè¯¦è§£" class="headerlink" title="ç¬¬4ç« ã€Chart æ¨¡ç‰ˆè¯¦è§£"></a>ç¬¬4ç« ã€Chart æ¨¡ç‰ˆè¯¦è§£</h1><span id="more"></span>


<h2 id="ä¸€ã€ç¼–å†™ç¬¬ä¸€ä¸ªæ¨¡ç‰ˆ"><a href="#ä¸€ã€ç¼–å†™ç¬¬ä¸€ä¸ªæ¨¡ç‰ˆ" class="headerlink" title="ä¸€ã€ç¼–å†™ç¬¬ä¸€ä¸ªæ¨¡ç‰ˆ"></a>ä¸€ã€ç¼–å†™ç¬¬ä¸€ä¸ªæ¨¡ç‰ˆ</h2><h3 id="1ã€å‰æœŸå‡†å¤‡"><a href="#1ã€å‰æœŸå‡†å¤‡" class="headerlink" title="1ã€å‰æœŸå‡†å¤‡"></a>1ã€å‰æœŸå‡†å¤‡</h3><blockquote>
<p>ğŸš© <strong>å†™åœ¨å¼€å§‹ä¹‹å‰</strong></p>
<p>ä¸Šä¸€ç« ä¸­æˆ‘ä»¬è¯´åˆ°è¿‡ï¼ŒHelm å‡ºæ¥å¯ä»¥å®‰è£…å®˜æ–¹æˆ–è€…ä¸‰æ–¹æä¾›çš„ <em>chart</em> åŒ…å¤–ï¼Œæ›´é‡è¦çš„æ˜¯æ”¯æŒåˆ›å»ºè‡ªå·±çš„ <code>chart</code>ï¼Œå°±è¡Œ <em>docker image</em> å’Œ <em>dockerfile</em>ï¼Œé€šè¿‡è‡ªå®šä¹‰ç¼–æ’ï¼Œæ–¹èƒ½å®ç°é€šè¿‡ Helm æ¥ç®¡ç†æˆ‘ä»¬è‡ªå·±çš„åº”ç”¨ã€‚</p>
<p>ä»ä¹‹å‰çš„å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬ä¸éš¾å¾—å‡º <code>chart</code> çš„æ ¸å¿ƒæ˜¯èµ„æºæ¨¡ç‰ˆ <code>templates</code> å’Œæ¸²æŸ“ <code>.Values</code>ï¼Œè€Œå…¶ä¸­çš„å…³é”®ï¼Œåˆ™æ˜¯å¦‚ä½•å†™èµ„æºæ¨¡ç‰ˆï¼Œè™½ç„¶å…¶æ•´ä½“å£°æ˜å¼å’Œ K8s çš„ <em>yaml</em> è¡¨è¾¾å¼æ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯æ—¢ç„¶æ¨¡ç‰ˆï¼Œè‡ªç„¶å°±è¦ä¸ºéœ€è¦æ¸²æŸ“çš„åœ°æ–¹ä¿ç•™å˜é‡ï¼Œå¹¶é€šè¿‡è¯­æ³•å»è·å–å¯¹åº”çš„å€¼ï¼Œæœ€ç»ˆæ‰èƒ½å‘ç”Ÿæ¸²æŸ“çš„æ•ˆæœã€‚è¿™ä¸ªç« èŠ‚æˆ‘ä»¬å°±æ¥å­¦ä¹ å¦‚ä½•é€šè¿‡ <code>Chart æ¨¡ç‰ˆ</code> çš„è¯­æ³•æ¥å†™æˆ‘ä»¬è‡ªå·±çš„æ¨¡ç‰ˆã€‚</p>
</blockquote>
<h4 id="1ï¼‰åˆ›å»ºä¸€ä¸ªç©ºçš„-chart"><a href="#1ï¼‰åˆ›å»ºä¸€ä¸ªç©ºçš„-chart" class="headerlink" title="1ï¼‰åˆ›å»ºä¸€ä¸ªç©ºçš„ chart"></a>1ï¼‰åˆ›å»ºä¸€ä¸ªç©ºçš„ chart</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">helm create mychart<br></code></pre></td></tr></table></figure>

<h4 id="2ï¼‰åˆ é™¤æ‰€æœ‰é»˜è®¤ç”Ÿæˆçš„æ¨¡ç‰ˆ"><a href="#2ï¼‰åˆ é™¤æ‰€æœ‰é»˜è®¤ç”Ÿæˆçš„æ¨¡ç‰ˆ" class="headerlink" title="2ï¼‰åˆ é™¤æ‰€æœ‰é»˜è®¤ç”Ÿæˆçš„æ¨¡ç‰ˆ"></a>2ï¼‰åˆ é™¤æ‰€æœ‰é»˜è®¤ç”Ÿæˆçš„æ¨¡ç‰ˆ</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">\rm -rf mychart/templates/*<br></code></pre></td></tr></table></figure>

<p>ç„¶åï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹è¿™ä¸€ç« çš„å­¦ä¹ ä¹‹æ—…äº†ï¼ï¼</p>
<h3 id="2ã€åˆ›å»º-ConfigMap-æ¨¡ç‰ˆ"><a href="#2ã€åˆ›å»º-ConfigMap-æ¨¡ç‰ˆ" class="headerlink" title="2ã€åˆ›å»º ConfigMap æ¨¡ç‰ˆ"></a>2ã€åˆ›å»º ConfigMap æ¨¡ç‰ˆ</h3><h4 id="1ï¼‰åˆ›å»ºæ–‡ä»¶"><a href="#1ï¼‰åˆ›å»ºæ–‡ä»¶" class="headerlink" title="1ï¼‰åˆ›å»ºæ–‡ä»¶"></a>1ï¼‰åˆ›å»ºæ–‡ä»¶</h4><p>æ–‡ä»¶è·¯å¾„: <code>mychart/templates/configmap.yaml</code>ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span><br><span class="hljs-attr">kind:</span> <span class="hljs-string">ConfigMap</span><br><span class="hljs-attr">metadata:</span><br>  <span class="hljs-attr">name:</span> &#123;&#123; <span class="hljs-string">.Release.Name</span> &#125;&#125;<span class="hljs-string">-configmap</span><br><span class="hljs-attr">data:</span><br>  <span class="hljs-attr">myvalue:</span> <span class="hljs-string">&quot;Hello World&quot;</span><br></code></pre></td></tr></table></figure>

<h5 id="è¡¨è¾¾å¼è¯´æ˜"><a href="#è¡¨è¾¾å¼è¯´æ˜" class="headerlink" title="è¡¨è¾¾å¼è¯´æ˜"></a>è¡¨è¾¾å¼è¯´æ˜</h5><p>1âƒ£ï¸ <code>&#123;&#123; &#125;&#125;</code> å’Œ <code>.</code> æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<p>ç›¸è¾ƒäºç»å…¸çš„ yaml å£°æ˜å¼ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œæœ€å¤§çš„å˜åŒ–åœ¨äº <code>&#123;&#123; .Release.Name &#125;&#125;</code>ã€‚<code>&#123;&#123; &#125;&#125;</code> å°±æ˜¯æ¨¡ç‰ˆè°ƒç”¨çš„æ–¹æ³•ï¼Œå…¶ä¸­åŠ ä¸Šè¦å¼•ç”¨çš„å…ƒç´ ï¼Œæ¨¡ç‰ˆå‘½ä»¤å°±ä¼šå°†å…¶å¯¹ç”¨çš„å€¼ä½œä¸ºä¸€ä¸ªå¯¹è±¡æ³¨å…¥æ¨¡ç‰ˆä¹‹ä¸­ï¼Œå…¶ä¸­ <code>.</code> ç”¨äºåˆ†å‰²æ¯ä¸ªå‘½ä»¤ç©ºé—´å†…éœ€è¦æœç´¢å…ƒç´ ï¼Œæœ€å‰é¢çš„ <code>.</code>è¡¨ç¤ºä»ä½œç”¨åŸŸçš„æœ€é¡¶å±‚æœç´¢å¯¹è±¡ã€‚æ¨¡ç‰ˆä¼šä»æœ€é¡¶å±‚çš„å‘½ä»¤ç©ºé—´å¼€å§‹æœç´¢ <code>.</code> æŒ‡å®šçš„å¯¹è±¡ã€‚</p>
<p>ç”±æ­¤ï¼Œ<code>&#123;&#123; .Release.Name &#125;&#125;</code> å°±åº”å½“è§£è¯»ä¸º â€œ<strong>ä»æœ€é¡¶å±‚çš„å‘½åç©ºé—´å¼€å§‹æœç´¢ <code>Release</code> å¯¹è±¡ï¼Œç„¶ååœ¨å…¶ä¸­æœç´¢ <code>Name</code> å¯¹è±¡</strong>â€œã€‚<code>Relase</code> æ˜¯ Helm çš„å†…ç½®å¯¹è±¡ï¼Œè¡¨ç¤ºå‘å¸ƒæœ¬èº«ã€‚</p>
<p>2âƒ£ï¸ ä¸ºä»€ä¹ˆè¦è¿™ä¹ˆå¤„ç†ï¼Ÿ</p>
<p>æ¨¡ç‰ˆçš„æ„ä¹‰åœ¨äºå¤ç”¨ã€‚é€šè¿‡ä¼ å…¥ä¸åŒçš„å€¼æ¥æ¸²æŸ“å‡ºä¸åŒçš„ç»“æœï¼Œæ‰æ˜¯æ¨¡ç‰ˆå­˜åœ¨çš„æ„ä¹‰ï¼Œå› æ­¤é’ˆå¯¹æ¨¡ç‰ˆæˆ‘ä»¬åº”å½“åšæŒ â€œ<strong>å¯å˜é‡åŒ–</strong>â€œçš„åŸåˆ™ï¼Œå°†éé€šç”¨æ€§çš„å­—æ®µè¿›è¡Œå˜é‡åŒ–å¤„ç†ï¼Œè¿™æ ·æ‰èƒ½ä½¿å¾—æˆ‘ä»¬çš„æ¨¡ç‰ˆæ›´å…·å¤‡æ³›ç”¨æ€§ï¼Œå¢åŠ å¤ç”¨çš„å¯èƒ½ã€‚</p>
<blockquote>
<p>âš ï¸ <strong>æ³¨æ„: Release åç§°çš„é•¿åº¦é™åˆ¶</strong>  </p>
<p>DNS ç³»ç»Ÿé™åˆ¶ <code>name</code> å­—æ®µçš„é•¿åº¦ä¸èƒ½è¶…è¿‡ <strong>63</strong> ä¸ªå­—ç¬¦ï¼Œå› æ­¤ Helm å¯¹ <code>Release</code> çš„åç§°æ˜¯æœ‰é•¿åº¦é™åˆ¶çš„ï¼Œ<strong>Helm3 å¯¹äºå…¶é•¿åº¦é™åˆ¶ä¸º 53 ä¸ªå­—ç¬¦</strong>ã€‚</p>
</blockquote>
<h4 id="2ï¼‰å‘å¸ƒ-chart"><a href="#2ï¼‰å‘å¸ƒ-chart" class="headerlink" title="2ï¼‰å‘å¸ƒ chart"></a>2ï¼‰å‘å¸ƒ chart</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">helm install test-chart ./mychart<br></code></pre></td></tr></table></figure>

<p>è¿”å›å€¼å¦‚ä¸‹ï¼š</p>
<p><img src="http://uniondrug-devops.oss-cn-hangzhou.aliyuncs.com/blog_images/image-20210705160256966.png" srcset="/img/loading.gif" lazyload alt="image-20210705160256966"></p>
<p>æŸ¥çœ‹å‘å¸ƒ:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">helm list<br></code></pre></td></tr></table></figure>

<p><img src="http://uniondrug-devops.oss-cn-hangzhou.aliyuncs.com/blog_images/image-20210705161041080.png" srcset="/img/loading.gif" lazyload alt="image-20210705161041080"></p>
<h4 id="3ï¼‰æŸ¥çœ‹-manifest"><a href="#3ï¼‰æŸ¥çœ‹-manifest" class="headerlink" title="3ï¼‰æŸ¥çœ‹ manifest"></a>3ï¼‰æŸ¥çœ‹ manifest</h4><blockquote>
<p>æ‰§è¡Œ <code>helm get manifest</code> å¯ä»¥æ‰“å°å‡º <code>release</code> å·²ç»ä¸Šä¼ åˆ° <code>api server</code> çš„èµ„æºã€‚æ¯ä¸ªæ–‡ä»¶éƒ½ä¼šä»¥ <code>---</code> `å¼€å¤´ï¼Œå¹¶è‡ªåŠ¨ç”Ÿæˆæ³¨é‡Šã€‚</p>
</blockquote>
<p>æˆ‘ä»¬å¯ä»¥å‘ç°æ¨¡ç‰ˆä¸­çš„ <code>&#123;&#123; .Release.Name &#125;&#125;</code> è°ƒç”¨å·²ç»æ¸²æŸ“æˆäº† Release çš„åç§°ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> å‘½ä»¤: helm get manifest &lt;release_name&gt;</span><br>helm get manifest test-chart<br></code></pre></td></tr></table></figure>

<p><img src="http://uniondrug-devops.oss-cn-hangzhou.aliyuncs.com/blog_images/image-20210705160402893.png" srcset="/img/loading.gif" lazyload alt="image-20210705160402893"></p>
<h4 id="4ï¼‰æŸ¥çœ‹æ¸²æŸ“æ•ˆæœï¼ˆä¸å‘å¸ƒï¼‰"><a href="#4ï¼‰æŸ¥çœ‹æ¸²æŸ“æ•ˆæœï¼ˆä¸å‘å¸ƒï¼‰" class="headerlink" title="4ï¼‰æŸ¥çœ‹æ¸²æŸ“æ•ˆæœï¼ˆä¸å‘å¸ƒï¼‰"></a>4ï¼‰æŸ¥çœ‹æ¸²æŸ“æ•ˆæœï¼ˆä¸å‘å¸ƒï¼‰</h4><h5 id="1-å¸è½½åº”ç”¨"><a href="#1-å¸è½½åº”ç”¨" class="headerlink" title="1. å¸è½½åº”ç”¨"></a>1. å¸è½½åº”ç”¨</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">helm uninstall test-chart<br></code></pre></td></tr></table></figure>

<h5 id="2-æ¸²æŸ“æµ‹è¯•"><a href="#2-æ¸²æŸ“æµ‹è¯•" class="headerlink" title="2. æ¸²æŸ“æµ‹è¯•"></a>2. æ¸²æŸ“æµ‹è¯•</h5><h6 id="1âƒ£ï¸-dry-run"><a href="#1âƒ£ï¸-dry-run" class="headerlink" title="1âƒ£ï¸ --dry-run"></a>1âƒ£ï¸ <code>--dry-run</code></h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">helm install --dry-run test-chart ./mychart<br></code></pre></td></tr></table></figure>

<p>è¿”å›å¦‚ä¸‹:</p>
<p><img src="http://uniondrug-devops.oss-cn-hangzhou.aliyuncs.com/blog_images/image-20210705162015141.png" srcset="/img/loading.gif" lazyload alt="image-20210705162015141"></p>
<h6 id="2âƒ£ï¸-debug"><a href="#2âƒ£ï¸-debug" class="headerlink" title="2âƒ£ï¸ --debug"></a>2âƒ£ï¸ <code>--debug</code></h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">helm install --dry-run --debug test-chart ./mychart<br></code></pre></td></tr></table></figure>

<p>è¿”å›å¦‚ä¸‹ï¼š</p>
<p><img src="http://uniondrug-devops.oss-cn-hangzhou.aliyuncs.com/blog_images/image-20210705161728732.png" srcset="/img/loading.gif" lazyload alt="image-20210705161728732"></p>
<h3 id="3ã€Values-çš„ä½¿ç”¨"><a href="#3ã€Values-çš„ä½¿ç”¨" class="headerlink" title="3ã€Values çš„ä½¿ç”¨"></a>3ã€Values çš„ä½¿ç”¨</h3><p>ç¡®åˆ‡çš„è¯´ï¼Œ<code>Values</code> æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒæä¾›äº†å¯¹äºä¼ é€’åˆ° chart æ¨¡ç‰ˆçš„å€¼çš„è®¿é—®æ–¹æ³•ã€‚å…¶å†…å®¹çš„ä¸»è¦æ¥æºå¦‚ä¸‹:</p>
<blockquote>
<ul>
<li>chart ä¸­é»˜è®¤çš„ <code>values.yaml</code> æ–‡ä»¶</li>
<li>å¦‚æœæ˜¯<em>å­ chart</em>ï¼Œåˆ™ä¸º<em>çˆ¶ chart</em> çš„ <code>values.yaml</code> æ–‡ä»¶</li>
<li>å‘½ä»¤è¡Œä½¿ç”¨ <code>-f</code> æŒ‡å®šçš„ values æ–‡ä»¶</li>
<li>å‘½ä»¤è¡Œä½¿ç”¨ <code>--set</code> ä¼ å…¥çš„å•ä¸ªå‚æ•°</li>
</ul>
<p>ğŸš©å…¶ä¼˜å…ˆçº§é¡ºåºæŒ‰ç…§ä¸Šè¿°åˆ—è¡¨è‡ªä¸‹è€Œä¸Šï¼Œä¾æ¬¡å‡å¼±ã€‚</p>
</blockquote>
<h4 id="1ï¼‰åˆ é™¤é»˜è®¤çš„-values-yaml"><a href="#1ï¼‰åˆ é™¤é»˜è®¤çš„-values-yaml" class="headerlink" title="1ï¼‰åˆ é™¤é»˜è®¤çš„ values.yaml"></a>1ï¼‰åˆ é™¤é»˜è®¤çš„ values.yaml</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">rm -f mychart/values.yaml <br></code></pre></td></tr></table></figure>



<h4 id="2ï¼‰åŸºæœ¬ä½¿ç”¨"><a href="#2ï¼‰åŸºæœ¬ä½¿ç”¨" class="headerlink" title="2ï¼‰åŸºæœ¬ä½¿ç”¨"></a>2ï¼‰åŸºæœ¬ä½¿ç”¨</h4><h5 id="1-åˆ›å»º-values-yaml"><a href="#1-åˆ›å»º-values-yaml" class="headerlink" title="1. åˆ›å»º values.yaml"></a>1. åˆ›å»º values.yaml</h5><p>æ–‡ä»¶è·¯å¾„: <code>mychart/values.yaml</code>ï¼Œæ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">aaa:</span> <span class="hljs-string">bbb</span><br></code></pre></td></tr></table></figure>

<h5 id="2-åœ¨-ConfigMap-æ¨¡ç‰ˆä¸­å¼•ç”¨"><a href="#2-åœ¨-ConfigMap-æ¨¡ç‰ˆä¸­å¼•ç”¨" class="headerlink" title="2. åœ¨ ConfigMap æ¨¡ç‰ˆä¸­å¼•ç”¨"></a>2. åœ¨ <code>ConfigMap</code> æ¨¡ç‰ˆä¸­å¼•ç”¨</h5><p>æ–‡ä»¶è·¯å¾„: <code>mychart/templates/configmap.yaml </code>ï¼Œå†…å®¹å¦‚ä¸‹:</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span><br><span class="hljs-attr">kind:</span> <span class="hljs-string">ConfigMap</span><br><span class="hljs-attr">metadata:</span><br>  <span class="hljs-attr">name:</span> &#123;&#123; <span class="hljs-string">.Release.Name</span> &#125;&#125;<span class="hljs-string">-configmap</span><br><span class="hljs-attr">data:</span><br>  <span class="hljs-attr">myvalue:</span> <span class="hljs-string">&quot;Hello World&quot;</span><br>  <span class="hljs-attr">aaa:</span> &#123;&#123; <span class="hljs-string">.Values.aaa</span> &#125;&#125;				<span class="hljs-comment"># è¿½åŠ å†…å®¹</span><br></code></pre></td></tr></table></figure>

<h5 id="3-æ¸²æŸ“æ¨¡ç‰ˆ"><a href="#3-æ¸²æŸ“æ¨¡ç‰ˆ" class="headerlink" title="3. æ¸²æŸ“æ¨¡ç‰ˆ"></a>3. æ¸²æŸ“æ¨¡ç‰ˆ</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">helm install --dry-run test-chart ./mychart<br></code></pre></td></tr></table></figure>

<p><strong>æ¸²æŸ“ç»“æœå¦‚ä¸‹ï¼š</strong></p>
<p><img src="http://uniondrug-devops.oss-cn-hangzhou.aliyuncs.com/blog_images/image-20210707143605000.png" srcset="/img/loading.gif" lazyload alt="image-20210707143605000"></p>
<h4 id="3ï¼‰å¤šç»“æ„åŒ–è¡¨è¾¾å¼"><a href="#3ï¼‰å¤šç»“æ„åŒ–è¡¨è¾¾å¼" class="headerlink" title="3ï¼‰å¤šç»“æ„åŒ–è¡¨è¾¾å¼"></a>3ï¼‰å¤šç»“æ„åŒ–è¡¨è¾¾å¼</h4><h5 id="1-åˆ›å»º-values-yaml-1"><a href="#1-åˆ›å»º-values-yaml-1" class="headerlink" title="1. åˆ›å»º values.yaml"></a>1. åˆ›å»º values.yaml</h5><p>æ–‡ä»¶è·¯å¾„ï¼š<code>mychart/other_values.yaml</code>ï¼Œæ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">person:</span><br>  <span class="hljs-attr">name:</span> <span class="hljs-string">Tareya</span><br>  <span class="hljs-attr">gender:</span> <span class="hljs-string">male</span><br>  <span class="hljs-attr">age:</span> <span class="hljs-number">18</span><br></code></pre></td></tr></table></figure>

<h5 id="2-åœ¨æ¨¡ç‰ˆä¸­å¼•ç”¨"><a href="#2-åœ¨æ¨¡ç‰ˆä¸­å¼•ç”¨" class="headerlink" title="2. åœ¨æ¨¡ç‰ˆä¸­å¼•ç”¨"></a>2. åœ¨æ¨¡ç‰ˆä¸­å¼•ç”¨</h5><p>æ–‡ä»¶è·¯å¾„ï¼š<code>mychart/templates/configmap.yaml</code>ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span><br><span class="hljs-attr">kind:</span> <span class="hljs-string">ConfigMap</span><br><span class="hljs-attr">metadata:</span><br>  <span class="hljs-attr">name:</span> &#123;&#123; <span class="hljs-string">.Release.Name</span> &#125;&#125;<span class="hljs-string">-configmap</span><br><span class="hljs-attr">data:</span><br>  <span class="hljs-attr">myvalue:</span> <span class="hljs-string">&quot;Hello World&quot;</span><br>  <span class="hljs-attr">aaa:</span> &#123;&#123; <span class="hljs-string">.Values.aaa</span> &#125;&#125;<br>  <span class="hljs-attr">name:</span> &#123;&#123; <span class="hljs-string">.Values.person.name</span> &#125;&#125;				<span class="hljs-comment"># è¿½åŠ å†…å®¹</span><br>  <span class="hljs-attr">gender:</span> &#123;&#123; <span class="hljs-string">.Values.person.gender</span> &#125;&#125;<br>  <span class="hljs-attr">age:</span> &#123;&#123; <span class="hljs-string">.Values.person.age</span> &#125;&#125;<br></code></pre></td></tr></table></figure>

<h5 id="3-æ¸²æŸ“æ¨¡ç‰ˆ-1"><a href="#3-æ¸²æŸ“æ¨¡ç‰ˆ-1" class="headerlink" title="3. æ¸²æŸ“æ¨¡ç‰ˆ"></a>3. æ¸²æŸ“æ¨¡ç‰ˆ</h5><p>ä½ å¯ä»¥å‘ç°æˆ‘ä»¬åˆ›å»ºçš„æ–‡ä»¶åå¹¶éé»˜è®¤çš„ <code>values.yaml</code>ã€‚è¿˜è®°å¾—æˆ‘ä»¬ä¹‹å‰è¯´è¿‡ï¼Œå¯ä»¥é€šè¿‡ <code>-f</code> çš„æ–¹å¼æŒ‡å®š <code>Values</code> çš„é…ç½®æ–‡ä»¶å—ï¼Ÿè¿™è¾¹æˆ‘ä»¬æ¥è¯•éªŒä¸‹ï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">helm install -f mychart/other_values.yaml --dry-run test-chart ./mychart<br></code></pre></td></tr></table></figure>

<p><strong>æ¸²æŸ“ç»“æœå¦‚ä¸‹ï¼š</strong></p>
<p><img src="http://uniondrug-devops.oss-cn-hangzhou.aliyuncs.com/blog_images/image-20210707145708150.png" srcset="/img/loading.gif" lazyload alt="image-20210707145708150"></p>
<p>å¯ä»¥å‘ç°ï¼Œæ¸²æŸ“ç»“æœä¸ä½†è¯»å–äº†é»˜è®¤çš„ <code>values.yaml</code> ï¼Œè¿˜è¯»å–äº†æˆ‘ä»¬æŒ‡å®šçš„ <code>other_values.yaml</code>ã€‚</p>
<h4 id="4ï¼‰ä½¿ç”¨-set-æŒ‡å®šé…ç½®å‚æ•°"><a href="#4ï¼‰ä½¿ç”¨-set-æŒ‡å®šé…ç½®å‚æ•°" class="headerlink" title="4ï¼‰ä½¿ç”¨ --set æŒ‡å®šé…ç½®å‚æ•°"></a>4ï¼‰ä½¿ç”¨ <code>--set</code> æŒ‡å®šé…ç½®å‚æ•°</h4><p>è¿˜è®°å¾—æˆ‘ä»¬ä¸Šé¢è¯´çš„ Values çš„ä¼˜å…ˆçº§å—ï¼Ÿæˆ‘ä»¬åœ¨è¿™è¾¹åšä¸ªç®€å•çš„éªŒè¯ï¼Œä¸Šé¢æˆ‘ä»¬å·²ç»åœ¨ <code>values.yaml</code> ä¸­è®¾ç½®äº† <code>aaa</code> çš„å€¼ä¸º <code>bbb</code>ï¼Œæ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">helm install --set aaa=abcdefg --dry-run test-chart ./mychart<br></code></pre></td></tr></table></figure>

<p>æ¸²æŸ“ç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="http://uniondrug-devops.oss-cn-hangzhou.aliyuncs.com/blog_images/image-20210707144128673.png" srcset="/img/loading.gif" lazyload alt="image-20210707144128673"></p>
<p>å¯ä»¥å‘ç°ï¼ŒåŸæœ¬ <code>values.yaml</code> ä¸­çš„é»˜è®¤é…ç½®è¢«æˆ‘ä»¬å‘½ä»¤è¡ŒæŒ‡å®šçš„é…ç½®è¦†ç›–äº†ã€‚</p>
<h4 id="5ï¼‰é€šè¿‡è®¾ç½®-null-åˆ é™¤é»˜è®¤é…ç½®"><a href="#5ï¼‰é€šè¿‡è®¾ç½®-null-åˆ é™¤é»˜è®¤é…ç½®" class="headerlink" title="5ï¼‰é€šè¿‡è®¾ç½® null åˆ é™¤é»˜è®¤é…ç½®"></a>5ï¼‰é€šè¿‡è®¾ç½® <code>null</code> åˆ é™¤é»˜è®¤é…ç½®</h4><p>æˆ‘ä»¬çŸ¥é“ <code>Values</code> çš„é…ç½®å…¶å®å°±æ˜¯ä¸€ä¸ª Key:Vaule å¯¹ï¼Œæ‰€ä»¥å¦‚æœè¦ä»é»˜è®¤çš„ <code>Values</code> ä¸­åˆ é™¤é…ç½®ï¼Œå…¶å®åªè¦å°† Key è®¾ç½®ä¸º <code>null</code>ï¼ŒHelm åœ¨è¿›è¡Œæ¸²æŸ“çš„è¿‡ç¨‹ä¸­ï¼Œå°±ä¼šåˆå¹¶å¹¶åˆ é™¤å¯¹åº”çš„ Keyã€‚</p>
<h5 id="ç¤ºä¾‹è¯´æ˜"><a href="#ç¤ºä¾‹è¯´æ˜" class="headerlink" title="ç¤ºä¾‹è¯´æ˜"></a>ç¤ºä¾‹è¯´æ˜</h5><p>ä¸‹é¢æˆ‘ä»¬ç”¨ä¸€ä¸ªç¤ºä¾‹æ¥è¯´æ˜ã€‚æ¯”å¦‚ï¼Œç¨³å®šçš„ <code>Drupal</code> chart å…è®¸åœ¨é…ç½®è‡ªå®šä¹‰é•œåƒæ—¶é…ç½®åŠ¨æ€æ¢é’ˆï¼Œé»˜è®¤å€¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">livenessProbe:</span><br>  <span class="hljs-attr">httpGet:</span><br>    <span class="hljs-attr">path:</span> <span class="hljs-string">/user/login</span><br>    <span class="hljs-attr">port:</span> <span class="hljs-string">http</span><br>  <span class="hljs-attr">initialDelaySeconds:</span> <span class="hljs-number">120</span><br></code></pre></td></tr></table></figure>

<p>å¦‚æœæˆ‘ä»¬æƒ³ç”¨ <code>exec</code> æ¥ä»£æ›¿ <code>httpGet</code> é‡å†™åŠ¨æ€æ¢é’ˆï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>--set livenessProbe.exec.command=[cat,docroot/CHANGELOG.txt]</code> ï¼Œåœ¨è¿›è¡Œæœ€ç»ˆæ¸²æŸ“åˆå¹¶åï¼Œç”Ÿäº§çš„ manifest å†…å®¹ä¼šå¦‚ä¸‹ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">livenessProbe:</span><br>  <span class="hljs-attr">httpGet:</span><br>    <span class="hljs-attr">path:</span> <span class="hljs-string">/user/login</span><br>    <span class="hljs-attr">port:</span> <span class="hljs-string">http</span><br>  <span class="hljs-attr">exec:</span><br>    <span class="hljs-attr">command:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">cat</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">docroot/CHANGELOG.txt</span><br>  <span class="hljs-attr">initialDelaySeconds:</span> <span class="hljs-number">120</span><br></code></pre></td></tr></table></figure>

<p>ä½†æ˜¯ï¼Œç”±äºåŒæ—¶å­˜åœ¨2ä¸ªåŠ¨æ€æ¢é’ˆå¥æŸ„ï¼Œæ‰€ä»¥ K8s åœ¨éƒ¨ç½²æ—¶ä¼šæŠ¥é”™ï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">helm install stable/drupal --set image=my-registry/drupal:0.1.0 --set livenessProbe.exec.command=[cat,docroot/CHANGELOG.txt] --set livenessProbe.httpGet=null<br></code></pre></td></tr></table></figure>

<p>è¿™ç§æƒ…å†µä¸‹ï¼Œæœ€ç»ˆç”Ÿæˆçš„ manifest å¦‚ä¸‹ï¼Œ<code>httpGet</code> å¥æŸ„ä¼šè¢«åˆ é™¤ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">livenessProbe:</span><br>  <span class="hljs-attr">exec:</span><br>    <span class="hljs-attr">command:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">cat</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">docroot/CHANGELOG.txt</span><br>  <span class="hljs-attr">initialDelaySeconds:</span> <span class="hljs-number">120</span><br></code></pre></td></tr></table></figure>

<p>å¦‚æ­¤ï¼ŒK8s æ‰èƒ½å¤Ÿæ­£å¸¸å®‰è£…ã€‚</p>
<hr>
<h2 id="äºŒã€Helm-çš„å†…ç½®å¯¹è±¡åˆ—è¡¨"><a href="#äºŒã€Helm-çš„å†…ç½®å¯¹è±¡åˆ—è¡¨" class="headerlink" title="äºŒã€Helm çš„å†…ç½®å¯¹è±¡åˆ—è¡¨"></a>äºŒã€Helm çš„å†…ç½®å¯¹è±¡åˆ—è¡¨</h2><h3 id="1ã€Release"><a href="#1ã€Release" class="headerlink" title="1ã€Release"></a>1ã€Release</h3><p>è¯¥å¯¹è±¡æè¿°äº†ç‰ˆæœ¬å‘å¸ƒæœ¬èº«ï¼Œå†…éƒ¨å…ƒç´ å¯¹è±¡å¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr>
<th>å¯¹è±¡</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td><strong>.Release.Name</strong></td>
<td>release çš„åç§°</td>
</tr>
<tr>
<td><strong>.Release.Namespace</strong></td>
<td>å½“æ¬¡ç‰ˆåŒ…å«çš„å‘½åç©ºé—´</td>
</tr>
<tr>
<td><strong>.Release.IsInstall</strong></td>
<td>å¦‚æœå½“å‰æ“ä½œä¸ºå®‰è£…ï¼Œåˆ™è¯¥å€¼ä¼šè®¾ç½®ä¸º <code>true</code></td>
</tr>
<tr>
<td><strong>.Release.IsUpgrade</strong></td>
<td>å¦‚æœå½“å‰æ“ä½œä¸ºå‡çº§æˆ–è€…å›æ»šï¼Œåˆ™è¯¥å€¼ä¼šè®¾ç½®ä¸º <code>true</code></td>
</tr>
<tr>
<td><strong>.Release.Revision</strong></td>
<td>æ­¤æ¬¡ä¿®è®¢çš„ç‰ˆæœ¬å·ï¼Œåˆæ¬¡å®‰è£…æ—¶ä¸º1ï¼Œæ¯æ¬¡å‡çº§æˆ–å›æ»šæ“ä½œéƒ½ä¼šè‡ªå¢1</td>
</tr>
<tr>
<td><strong>.Release.Service</strong></td>
<td>ç”¨äºæ¸²æŸ“å½“å‰æ¨¡ç‰ˆçš„ serviceï¼ŒHelm ä¸­ä¸€èˆ¬ä¸º <code>helm</code></td>
</tr>
</tbody></table>
<h3 id="2ã€Files"><a href="#2ã€Files" class="headerlink" title="2ã€Files"></a>2ã€Files</h3><p>è¯¥å¯¹è±¡å…¶å®æ˜¯ä¸€ç»„æ–¹æ³•ï¼Œé€šè¿‡å…¶å¯ä»¥è®¿é—® <em>chart</em> ä¸­æ–‡ä»¶ï¼ˆå¦‚ï¼Œ<code>.helmignore</code>ï¼‰ï¼Œå†…éƒ¨æ–¹æ³•å¯¹è±¡å¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr>
<th>å¯¹è±¡</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td><strong>.Files.Get</strong></td>
<td>é€šè¿‡æ–‡ä»¶åè·å–æ–‡ä»¶å†…å®¹çš„æ–¹æ³•ï¼Œä½¿ç”¨æ–¹æ³•å¦‚ <code>.Files.Getconfig.ini</code>ï¼Œ<em>config.ini</em> ä¸ºæ–‡ä»¶å</td>
</tr>
<tr>
<td><strong>.Files.GetBytes</strong></td>
<td>ç”¨å­—èŠ‚æ•°ç»„ä»£æ›¿å­—ç¬¦ä¸²è·å–æ–‡ä»¶å†…å®¹çš„æ–¹æ³•ã€‚ å¯¹å›¾ç‰‡ä¹‹ç±»çš„æ–‡ä»¶å¾ˆæœ‰ç”¨</td>
</tr>
<tr>
<td><strong>.Files.Glob</strong></td>
<td>ç”¨ç»™å®šçš„ shell glob æ¨¡å¼åŒ¹é…æ–‡ä»¶åï¼Œå¹¶è¿”å›ä¸€ä¸ªåˆ—è¡¨</td>
</tr>
<tr>
<td><strong>.Files.Lines</strong></td>
<td>é€è¡Œè¯»å–æ–‡ä»¶å†…å®¹çš„æ–¹æ³•ã€‚è¿­ä»£æ–‡ä»¶ä¸­æ¯ä¸€è¡Œæ—¶å¾ˆæœ‰ç”¨</td>
</tr>
<tr>
<td><strong>.Files.AsSecrets</strong></td>
<td>ä½¿ç”¨Base 64ç¼–ç å­—ç¬¦ä¸²è¿”å›æ–‡ä»¶ä½“çš„æ–¹æ³•</td>
</tr>
<tr>
<td><strong>.Files.AsConfig</strong></td>
<td>ä½¿ç”¨YAMLæ ¼å¼è¿”å›æ–‡ä»¶ä½“çš„æ–¹æ³•</td>
</tr>
</tbody></table>
<h3 id="3ã€Capabilities"><a href="#3ã€Capabilities" class="headerlink" title="3ã€Capabilities"></a>3ã€Capabilities</h3><p>è¯¥å¯¹è±¡æä¾›äº†å…³äº Kubernetes é›†ç¾¤æ”¯æŒåŠŸèƒ½çš„ä¿¡æ¯ï¼Œå†…éƒ¨å…ƒç´ å¯¹è±¡å¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr>
<th>å¯¹è±¡</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td><strong>.Capabilities.APIVersions</strong></td>
<td>Kubernetes å†…éƒ¨ä½¿ç”¨çš„ç‰ˆæœ¬é›†åˆ</td>
</tr>
<tr>
<td><strong>.Capabilities.APIVersions.Has $version</strong></td>
<td>è¯´æ˜é›†ç¾¤ä¸­çš„ç‰ˆæœ¬ (å¦‚, <code>batch/v1</code>) æˆ–æ˜¯èµ„æº (å¦‚, <code>apps/v1/Deployment</code>) æ˜¯å¦å¯ç”¨</td>
</tr>
<tr>
<td><strong>.Capabilities.KubeVersion</strong></td>
<td>Kubernetesçš„ç‰ˆæœ¬å·</td>
</tr>
<tr>
<td><strong>.Capabilities.KubeVersion.Version</strong></td>
<td>Kubernetesçš„ç‰ˆæœ¬å·</td>
</tr>
<tr>
<td><strong>.Capabilities.KubeVersion.Major</strong></td>
<td>Kubernetesçš„ä¸»ç‰ˆæœ¬</td>
</tr>
<tr>
<td><strong>.Capabilities.KubeVersion.Minor</strong></td>
<td>Kubernetesçš„æ¬¡ç‰ˆæœ¬</td>
</tr>
</tbody></table>
<h3 id="4ã€Template"><a href="#4ã€Template" class="headerlink" title="4ã€Template"></a>4ã€Template</h3><p>è¯¥å¯¹è±¡åŒ…å«äº†å·²ç»è¢«æ‰§è¡Œçš„å½“å‰æ¨¡ç‰ˆçš„ä¿¡æ¯ï¼Œå†…éƒ¨å…ƒç´ å¯¹è±¡å¦‚ä¸‹:</p>
<table>
<thead>
<tr>
<th>å¯¹è±¡</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td><strong>.Template.Name</strong></td>
<td>å½“å‰æ¨¡æ¿çš„å‘½åç©ºé—´æ–‡ä»¶è·¯å¾„ (å¦‚ï¼Œ <code>mychart/templates/configmap.yaml</code>)</td>
</tr>
<tr>
<td><strong>.Template.BasePath</strong></td>
<td>å½“å‰chartæ¨¡æ¿ç›®å½•çš„è·¯å¾„ (å¦‚ï¼Œ<code>mychart/templates</code>)</td>
</tr>
</tbody></table>
<h3 id="5ã€Values"><a href="#5ã€Values" class="headerlink" title="5ã€Values"></a>5ã€Values</h3><p>è¯¥å¯¹è±¡æ˜¯ä» <code>values.yaml</code> æ–‡ä»¶ï¼Œç”¨æˆ·é€šè¿‡ <code>-f</code> å‚æ•°æŒ‡å®šçš„æ–‡ä»¶ä»¥åŠå‘½ä»¤è¡Œ <code>--set</code> å‚æ•°ä¼ å…¥çš„æ–¹å¼æ³¨å…¥æ¨¡ç‰ˆçš„ã€‚<code>Values</code> é»˜è®¤ä¸ºç©ºã€‚</p>
<h3 id="6ã€Chart"><a href="#6ã€Chart" class="headerlink" title="6ã€Chart"></a>6ã€Chart</h3><p>è¯¥å¯¹è±¡è¡¨ç¤ºçš„æ˜¯ <code>Chart.yaml</code> æ–‡ä»¶çš„å†…å®¹ã€‚å…¶ä¸­ä»»æ„çš„æœ‰æ•ˆæ•°æ®éƒ½å¯ä»¥ä»¥è¯¸è¯¸å¦‚ <code>&#123;&#123; .Chart.Nmae &#125;&#125;-&#123;&#123; .Chart.Version&#125;&#125;</code> è¿™æ ·çš„æ–¹å¼è®¿é—®ã€‚</p>
<hr>
<h2 id="ä¸‰ã€å¸¸ç”¨æ¨¡ç‰ˆå‡½æ•°"><a href="#ä¸‰ã€å¸¸ç”¨æ¨¡ç‰ˆå‡½æ•°" class="headerlink" title="ä¸‰ã€å¸¸ç”¨æ¨¡ç‰ˆå‡½æ•°"></a>ä¸‰ã€å¸¸ç”¨æ¨¡ç‰ˆå‡½æ•°</h2><h3 id="1ã€quote-å‡½æ•°å’Œ-squote-å‡½æ•°"><a href="#1ã€quote-å‡½æ•°å’Œ-squote-å‡½æ•°" class="headerlink" title="1ã€quote å‡½æ•°å’Œ squote å‡½æ•°"></a>1ã€quote å‡½æ•°å’Œ squote å‡½æ•°</h3><p><code>quote</code> å‡½æ•°æ˜¯ <code>Sprig</code> æ¨¡ç‰ˆåº“æä¾›çš„ä¸€ç§å­—ç¬¦ä¸²å‡½æ•°ï¼Œå®ƒçš„ç”¨é€”å®é™…ä¸Šå°±æ˜¯ç”¨åŒå¼•å·å°†å­—ç¬¦ä¸²æ‰©èµ·æ¥ï¼ˆè½¬å­—ç¬¦ä¸²ï¼‰ï¼Œå¦‚æœéœ€è¦ <code>&quot;</code> ï¼Œåˆ™éœ€è¦æ·»åŠ  <code>\</code> æ¥è¿›è¡Œè½¬è¯‘ã€‚</p>
<p><code>squote</code> å‡½æ•°çš„ç”¨é€”æ˜¯ç”¨å•å¼•å·å°†å­—ç¬¦ä¸²æ‰©èµ·æ¥ï¼Œå®ƒå’Œ <code>quote</code> å‡½æ•°å”¯ä¸€çš„åŒºåˆ«åœ¨äºï¼Œ<code>squote</code> å‡½æ•°ä¸ä¼šå¯¹å†…å®¹è¿›è¡Œè½¬è¯‘ã€‚</p>
<h4 id="ç¤ºä¾‹è¯´æ˜ï¼š"><a href="#ç¤ºä¾‹è¯´æ˜ï¼š" class="headerlink" title="ç¤ºä¾‹è¯´æ˜ï¼š"></a>ç¤ºä¾‹è¯´æ˜ï¼š</h4><h5 id="1-æ¨¡ç‰ˆæ–‡ä»¶"><a href="#1-æ¨¡ç‰ˆæ–‡ä»¶" class="headerlink" title="1. æ¨¡ç‰ˆæ–‡ä»¶"></a>1. æ¨¡ç‰ˆæ–‡ä»¶</h5><p>è·¯å¾„: <code>mychart/templates/configmap.yaml</code>ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span><br><span class="hljs-attr">kind:</span> <span class="hljs-string">ConfigMap</span><br><span class="hljs-attr">metadata:</span><br>  <span class="hljs-attr">name:</span> &#123;&#123; <span class="hljs-string">.Release.Name</span> &#125;&#125;<span class="hljs-string">-configmap</span><br><span class="hljs-attr">data:</span><br>  <span class="hljs-attr">aaa:</span> &#123;&#123; <span class="hljs-string">.Values.aaa</span> &#125;&#125;<br>  <span class="hljs-attr">bbb:</span> &#123;&#123; <span class="hljs-string">quote</span> <span class="hljs-string">.Values.bbb</span> &#125;&#125;<br>  <span class="hljs-attr">ccc:</span> &#123;&#123; <span class="hljs-string">squote</span> <span class="hljs-string">.Values.ccc</span> &#125;&#125;<br></code></pre></td></tr></table></figure>

<h5 id="2-values-æ–‡ä»¶"><a href="#2-values-æ–‡ä»¶" class="headerlink" title="2. values æ–‡ä»¶"></a>2. values æ–‡ä»¶</h5><p>è·¯å¾„: <code>mychart/values.yaml </code>ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">aaa:</span> <span class="hljs-string">bbb</span><br><span class="hljs-attr">bbb:</span> <span class="hljs-string">ccc</span><br><span class="hljs-attr">ccc:</span> <span class="hljs-string">ddd</span><br></code></pre></td></tr></table></figure>

<h5 id="3-æ¸²æŸ“æ¨¡ç‰ˆ-2"><a href="#3-æ¸²æŸ“æ¨¡ç‰ˆ-2" class="headerlink" title="3. æ¸²æŸ“æ¨¡ç‰ˆ"></a>3. æ¸²æŸ“æ¨¡ç‰ˆ</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">helm install --dry-run test_chart ./mychart<br></code></pre></td></tr></table></figure>

<p><strong>æ¸²æŸ“æ•ˆæœå¦‚ä¸‹ï¼š</strong></p>
<p><img src="http://uniondrug-devops.oss-cn-hangzhou.aliyuncs.com/blog_images/image-20210707180036706.png" srcset="/img/loading.gif" lazyload alt="image-20210707180036706"></p>
<h3 id="2ã€upper-å‡½æ•°-å’Œ-title-å‡½æ•°"><a href="#2ã€upper-å‡½æ•°-å’Œ-title-å‡½æ•°" class="headerlink" title="2ã€upper å‡½æ•° å’Œ title å‡½æ•°"></a>2ã€upper å‡½æ•° å’Œ title å‡½æ•°</h3><p><code>upper</code> å‡½æ•°ä¹Ÿæ˜¯ <code>Sprig</code> æ¨¡ç‰ˆåº“æä¾›çš„ï¼Œå®ƒçš„ä½œç”¨æ˜¯å°†æ‰€æœ‰å°å†™å­—æ¯è½¬æˆå¤§å†™ï¼›<code>title</code> å‡½æ•°ä¸å…¶ç±»ä¼¼ï¼Œä½†æ˜¯åªå°†é¦–å­—æ¯è½¬å¤§å†™ã€‚</p>
<h4 id="ç¤ºä¾‹è¯´æ˜ï¼š-1"><a href="#ç¤ºä¾‹è¯´æ˜ï¼š-1" class="headerlink" title="ç¤ºä¾‹è¯´æ˜ï¼š"></a>ç¤ºä¾‹è¯´æ˜ï¼š</h4><h5 id="1-æ¨¡ç‰ˆæ–‡ä»¶-1"><a href="#1-æ¨¡ç‰ˆæ–‡ä»¶-1" class="headerlink" title="1. æ¨¡ç‰ˆæ–‡ä»¶"></a>1. æ¨¡ç‰ˆæ–‡ä»¶</h5><p>è·¯å¾„: <code>mychart/templates/configmap.yaml</code>ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span><br><span class="hljs-attr">kind:</span> <span class="hljs-string">ConfigMap</span><br><span class="hljs-attr">metadata:</span><br>  <span class="hljs-attr">name:</span> &#123;&#123; <span class="hljs-string">.Release.Name</span> &#125;&#125;<span class="hljs-string">-configmap</span><br><span class="hljs-attr">data:</span><br>  <span class="hljs-attr">aaa:</span> &#123;&#123; <span class="hljs-string">.Values.aaa</span> &#125;&#125;<br>  <span class="hljs-attr">bbb:</span> &#123;&#123; <span class="hljs-string">upper</span> <span class="hljs-string">.Values.bbb</span> &#125;&#125;<br>  <span class="hljs-attr">ccc:</span> &#123;&#123; <span class="hljs-string">title</span> <span class="hljs-string">.Values.ccc</span> &#125;&#125;<br></code></pre></td></tr></table></figure>

<h5 id="2-values-æ–‡ä»¶-1"><a href="#2-values-æ–‡ä»¶-1" class="headerlink" title="2. values æ–‡ä»¶"></a>2. values æ–‡ä»¶</h5><p>è·¯å¾„: <code>mychart/values.yaml </code>ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">aaa:</span> <span class="hljs-string">bbb</span><br><span class="hljs-attr">bbb:</span> <span class="hljs-string">ccc</span><br><span class="hljs-attr">ccc:</span> <span class="hljs-string">ddd</span><br></code></pre></td></tr></table></figure>

<h5 id="3-æ¸²æŸ“æ¨¡ç‰ˆ-3"><a href="#3-æ¸²æŸ“æ¨¡ç‰ˆ-3" class="headerlink" title="3. æ¸²æŸ“æ¨¡ç‰ˆ"></a>3. æ¸²æŸ“æ¨¡ç‰ˆ</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">helm install --dry-run test_chart ./mychart<br></code></pre></td></tr></table></figure>

<p><strong>æ¸²æŸ“æ•ˆæœå¦‚ä¸‹:</strong></p>
<p><img src="http://uniondrug-devops.oss-cn-hangzhou.aliyuncs.com/blog_images/image-20210707181049656.png" srcset="/img/loading.gif" lazyload alt="image-20210707181049656"></p>
<h3 id="3ã€default-å‡½æ•°"><a href="#3ã€default-å‡½æ•°" class="headerlink" title="3ã€default å‡½æ•°"></a>3ã€default å‡½æ•°</h3><p>å®é™…ä¸Šï¼Œåœ¨æ¨¡ç‰ˆå‡½æ•°ä¸­æœ€è¢«å¸¸ç”¨çš„å‡½æ•°å°±æ˜¯ <code>default</code> å‡½æ•°ï¼Œå®ƒå…è®¸æ¨¡ç‰ˆçš„ç¼–å†™è€…åœ¨æ¨¡ç‰ˆä¸­æŒ‡å®šä¸€ä¸ªé»˜è®¤å€¼ï¼Œä»¥é˜²æ²¡æœ‰åœ¨ Values ä¸­é¢„è®¾è€Œå¯¼è‡´å‚æ•°è¢«å¿½ç•¥ã€‚</p>
<h4 id="ç¤ºä¾‹è¯´æ˜ï¼š-2"><a href="#ç¤ºä¾‹è¯´æ˜ï¼š-2" class="headerlink" title="ç¤ºä¾‹è¯´æ˜ï¼š"></a>ç¤ºä¾‹è¯´æ˜ï¼š</h4><h5 id="1-æ¨¡ç‰ˆæ–‡ä»¶-2"><a href="#1-æ¨¡ç‰ˆæ–‡ä»¶-2" class="headerlink" title="1. æ¨¡ç‰ˆæ–‡ä»¶"></a>1. æ¨¡ç‰ˆæ–‡ä»¶</h5><p>è·¯å¾„: <code>mychart/templates/configmap.yaml</code>ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span><br><span class="hljs-attr">kind:</span> <span class="hljs-string">ConfigMap</span><br><span class="hljs-attr">metadata:</span><br>  <span class="hljs-attr">name:</span> &#123;&#123; <span class="hljs-string">.Release.Name</span> &#125;&#125;<span class="hljs-string">-configmap</span><br><span class="hljs-attr">data:</span><br>  <span class="hljs-attr">service:</span> &#123;&#123; <span class="hljs-string">quote</span> <span class="hljs-string">.Values.service.name</span> &#125;&#125;<br>  <span class="hljs-attr">protocol:</span> &#123;&#123; <span class="hljs-string">.Values.service.protocol</span> <span class="hljs-string">|</span> <span class="hljs-string">default</span> <span class="hljs-string">&quot;http&quot;</span> <span class="hljs-string">|</span> <span class="hljs-string">quote</span> &#125;&#125;<br>  <span class="hljs-attr">port:</span> &#123;&#123; <span class="hljs-string">.Values.service.port</span> <span class="hljs-string">|</span> <span class="hljs-string">default</span> <span class="hljs-number">80</span> &#125;&#125;<br></code></pre></td></tr></table></figure>

<h5 id="2-values-æ–‡ä»¶-2"><a href="#2-values-æ–‡ä»¶-2" class="headerlink" title="2. values æ–‡ä»¶"></a>2. values æ–‡ä»¶</h5><p>è·¯å¾„: <code>mychart/values.yaml </code>ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">service:</span><br>  <span class="hljs-attr">name:</span> <span class="hljs-string">nginx</span><br>  <span class="hljs-attr">protocol:</span> <span class="hljs-string">https</span><br>  <span class="hljs-attr">port:</span> <span class="hljs-number">443</span><br></code></pre></td></tr></table></figure>

<h5 id="3-æ¸²æŸ“æ¨¡ç‰ˆ-4"><a href="#3-æ¸²æŸ“æ¨¡ç‰ˆ-4" class="headerlink" title="3. æ¸²æŸ“æ¨¡ç‰ˆ"></a>3. æ¸²æŸ“æ¨¡ç‰ˆ</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">helm install --dry-run test_chart ./mychart<br></code></pre></td></tr></table></figure>

<p><strong>æ¸²æŸ“æ•ˆæœå¦‚ä¸‹:</strong></p>
<p><img src="http://uniondrug-devops.oss-cn-hangzhou.aliyuncs.com/blog_images/image-20210707182537495.png" srcset="/img/loading.gif" lazyload alt="image-20210707182537495"></p>
<h5 id="4-ä¿®æ”¹-values-æ–‡ä»¶"><a href="#4-ä¿®æ”¹-values-æ–‡ä»¶" class="headerlink" title="4. ä¿®æ”¹ values æ–‡ä»¶"></a>4. ä¿®æ”¹ values æ–‡ä»¶</h5><p>è·¯å¾„: <code>mychart/values.yaml </code>ï¼Œå»æ‰éƒ¨åˆ†å†…å®¹ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">service:</span><br>  <span class="hljs-attr">name:</span> <span class="hljs-string">nginx</span><br></code></pre></td></tr></table></figure>

<p>å†æ¬¡æ¸²æŸ“ï¼Œæ¸²æŸ“æ•ˆæœå¦‚ä¸‹:</p>
<p><img src="http://uniondrug-devops.oss-cn-hangzhou.aliyuncs.com/blog_images/image-20210707182811994.png" srcset="/img/loading.gif" lazyload alt="image-20210707182811994"></p>
<p>å¯ä»¥å‘ç°ï¼Œåœ¨ Values ä¸­ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰åšé¢„è®¾ï¼Œè€Œæ¸²æŸ“ç»“æœå–äº†é»˜è®¤å€¼ï¼Œä½¿ç”¨è¿™ç§æ–¹æ³•å¯ä»¥æ¯”è¾ƒæœ‰æ•ˆçš„å‡å°‘ç”±äºç¼ºå°‘å‚æ•°å¯¼è‡´çš„å‘å¸ƒå¤±è´¥ã€‚</p>
<h3 id="4ã€ç®¡é“"><a href="#4ã€ç®¡é“" class="headerlink" title="4ã€ç®¡é“"></a>4ã€ç®¡é“</h3><p>æœ‰æ²¡æœ‰å‘ç°ï¼Œæˆ‘ä»¬åœ¨ä¸Šé¢çš„æ¨¡ç‰ˆæ–‡ä»¶ä¸­ï¼Œä½¿ç”¨äº†ä¸€ä¸ªç±»ä¼¼ UNIX shell çš„åŠŸèƒ½ â€”â€” <code>|</code>ï¼Ÿæ˜¯çš„ï¼Œå®ƒçš„åŠŸèƒ½å°±ç±»ä¼¼ UNIX çš„ <code>ç®¡é“</code>ã€‚è¿˜è®°å¾— <code>ç®¡é“</code>  çš„ä½œç”¨å—ï¼Ÿ<code>å°†ç®¡é“å‰æ‰§è¡Œçš„ç»“æœäº¤ç”±ç®¡é“åçš„å‘½ä»¤æ‰§è¡Œ</code>ï¼Œè¿™é‡Œçš„æ•ˆæœä¹Ÿç±»ä¼¼ã€‚ä¸‹é¢æˆ‘ä»¬å†ç”¨ç¤ºä¾‹è¯´æ˜ä¸‹ã€‚</p>
<h4 id="ç¤ºä¾‹è¯´æ˜ï¼š-3"><a href="#ç¤ºä¾‹è¯´æ˜ï¼š-3" class="headerlink" title="ç¤ºä¾‹è¯´æ˜ï¼š"></a>ç¤ºä¾‹è¯´æ˜ï¼š</h4><h5 id="1-æ¨¡ç‰ˆæ–‡ä»¶-3"><a href="#1-æ¨¡ç‰ˆæ–‡ä»¶-3" class="headerlink" title="1. æ¨¡ç‰ˆæ–‡ä»¶"></a>1. æ¨¡ç‰ˆæ–‡ä»¶</h5><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span><br><span class="hljs-attr">kind:</span> <span class="hljs-string">ConfigMap</span><br><span class="hljs-attr">metadata:</span><br>  <span class="hljs-attr">name:</span> &#123;&#123; <span class="hljs-string">.Release.Name</span> &#125;&#125;<span class="hljs-string">-configmap</span><br><span class="hljs-attr">data:</span><br>  <span class="hljs-attr">service:</span> &#123;&#123; <span class="hljs-string">.Values.service.name</span> <span class="hljs-string">|</span> <span class="hljs-string">title</span> <span class="hljs-string">|</span> <span class="hljs-string">quote</span> &#125;&#125;									<br>  <span class="hljs-attr">protocol:</span> &#123;&#123; <span class="hljs-string">.Values.service.protocol</span> <span class="hljs-string">|</span> <span class="hljs-string">default</span> <span class="hljs-string">&quot;http&quot;</span> <span class="hljs-string">|</span> <span class="hljs-string">upper</span>  &#125;&#125;<br>  <span class="hljs-attr">port:</span> &#123;&#123; <span class="hljs-string">.Values.service.port</span> <span class="hljs-string">|</span> <span class="hljs-string">default</span> <span class="hljs-number">80</span> &#125;&#125;<br></code></pre></td></tr></table></figure>

<blockquote>
<p>å¦‚ä¸Šï¼Œæˆ‘ä»¬æ‰§è¡Œäº†å‡ ä¸ªç®¡é“æ“ä½œï¼Œå…¶æ‰§è¡Œçš„å«ä¹‰å¦‚ä¸‹ï¼š</p>
<ul>
<li><p><code>&#123;&#123; .Values.service.name | title | quote &#125;&#125;</code></p>
<p>å°†æœç´¢ <code>.Values.service.name</code> çš„ç»“æœé¦–å­—æ¯è½¬å¤§å†™ï¼Œå¹¶ç”¨åŒå¼•å·å¼•èµ·æ¥</p>
</li>
<li><p><code>&#123;&#123; .Values.service.protocol | default "http" | upper  &#125;&#125;</code></p>
<p>å°†æœç´¢ <code>.Values.service.protocol</code> çš„ç»“æœï¼ˆå¦‚æœæ²¡æœ‰åˆ™é»˜è®¤å€¼ä¸º httpï¼‰æ‰€æœ‰å­—æ¯è½¬å¤§å†™</p>
</li>
</ul>
</blockquote>
<h5 id="2-values-æ–‡ä»¶-3"><a href="#2-values-æ–‡ä»¶-3" class="headerlink" title="2. values æ–‡ä»¶"></a>2. values æ–‡ä»¶</h5><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">service:</span><br>  <span class="hljs-attr">name:</span> <span class="hljs-string">nginx</span><br>  <span class="hljs-attr">protocol:</span> <span class="hljs-string">tcp</span><br>  <span class="hljs-attr">port:</span> <span class="hljs-number">80</span><br></code></pre></td></tr></table></figure>

<h5 id="3-æ¸²æŸ“æ¨¡ç‰ˆ-5"><a href="#3-æ¸²æŸ“æ¨¡ç‰ˆ-5" class="headerlink" title="3. æ¸²æŸ“æ¨¡ç‰ˆ"></a>3. æ¸²æŸ“æ¨¡ç‰ˆ</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">helm install --dry-run mychart ./mychart/<br></code></pre></td></tr></table></figure>

<p><img src="http://uniondrug-devops.oss-cn-hangzhou.aliyuncs.com/blog_images/image-20210708150257165.png" srcset="/img/loading.gif" lazyload alt="image-20210708150257165"></p>
<blockquote>
<p>ğŸš© <strong>åœ¨é»˜è®¤çš„è¯­æ³•è§„åˆ™ä¸­ï¼Œè™½ç„¶ä¸¤ç§æ–¹å¼éƒ½å¯ä»¥ä½¿ç”¨ï¼Œä½†æ˜¯æˆ‘ä»¬è¾ƒå¸¸ä½¿ç”¨çš„æ–¹æ³•ä¸º <code>.val | quote </code> è€Œéä½¿ç”¨ <code>quote .val</code></strong></p>
</blockquote>
<h3 id="5ã€include-å‡½æ•°-å’Œ-template-å‡½æ•°"><a href="#5ã€include-å‡½æ•°-å’Œ-template-å‡½æ•°" class="headerlink" title="5ã€include å‡½æ•° å’Œ template å‡½æ•°"></a>5ã€include å‡½æ•° å’Œ template å‡½æ•°</h3><h3 id="6ã€indent-å‡½æ•°-å’Œ-nindent-å‡½æ•°-å’Œ-plural-å‡½æ•°"><a href="#6ã€indent-å‡½æ•°-å’Œ-nindent-å‡½æ•°-å’Œ-plural-å‡½æ•°" class="headerlink" title="6ã€indent å‡½æ•° å’Œ nindent å‡½æ•° å’Œ plural å‡½æ•°"></a>6ã€indent å‡½æ•° å’Œ nindent å‡½æ•° å’Œ plural å‡½æ•°</h3><h3 id="7ã€lookup-å‡½æ•°"><a href="#7ã€lookup-å‡½æ•°" class="headerlink" title="7ã€lookup å‡½æ•°"></a>7ã€lookup å‡½æ•°</h3><hr>
<h2 id="å››ã€æµç¨‹æ§åˆ¶"><a href="#å››ã€æµç¨‹æ§åˆ¶" class="headerlink" title="å››ã€æµç¨‹æ§åˆ¶"></a>å››ã€æµç¨‹æ§åˆ¶</h2>
            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/Kubernetes/">Kubernetes</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/Helm3-%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%E6%89%8B%E5%86%8C/">Helm3 å¿«é€Ÿå…¥é—¨æ‰‹å†Œ</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">
                  
                    æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 åè®®</a> ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2021/07/24/%E7%AC%AC3%E7%AB%A0%E3%80%81%E5%88%9D%E8%AF%86-Chart%20/">
                        <span class="hidden-mobile">ç¬¬3ç« ã€åˆè¯† Chart</span>
                        <span class="visible-mobile">ä¸‹ä¸€ç¯‡</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;ç›®å½•</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">å…³é”®è¯</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
  </div>
  

  

  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  <script  src="https://cdn.jsdelivr.net/npm/tocbot@4.12.3/dist/tocbot.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4.3.1/anchor.min.js" ></script>



  <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2.0.8/dist/clipboard.min.js" ></script>



  <script  src="/js/local-search.js" ></script>






  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2.0.12/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
      typing(title)
      
    })(window, document);
  </script>















<!-- ä¸»é¢˜çš„å¯åŠ¨é¡¹ ä¿æŒåœ¨æœ€åº•éƒ¨ -->
<script  src="/js/boot.js" ></script>


</body>
</html>
