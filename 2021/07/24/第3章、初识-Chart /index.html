

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=&#34;auto&#34;>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/icon.png">
  <link rel="icon" href="/img/icon.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="ç¬¬3ç« ã€åˆè¯† Chart">
  <meta name="author" content="Tareya">
  <meta name="keywords" content="">
  
  <title>ç¬¬3ç« ã€åˆè¯† Chart - ä¹±åºæ—¶ç©º</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10.7.2/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
  



<!-- ä¸»é¢˜ä¾èµ–çš„å›¾æ ‡åº“ï¼Œä¸è¦è‡ªè¡Œä¿®æ”¹ -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- è‡ªå®šä¹‰æ ·å¼ä¿æŒåœ¨æœ€åº•éƒ¨ -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"tareya.github.io","root":"/","version":"1.8.11","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null}},"search_path":"/local-search.xml"};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.4.0"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>ä¹±åºæ—¶ç©º</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                é¦–é¡µ
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                å½’æ¡£
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                åˆ†ç±»
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                æ ‡ç­¾
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                å…³äº
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" data-toggle="modal" data-target="#modalSearch">&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;</a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/background/lomo5.jpeg') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="ç¬¬3ç« ã€åˆè¯† Chart">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2021-07-24 16:30" pubdate>
        2021å¹´7æœˆ24æ—¥ ä¸‹åˆ
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      5.7k å­—
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      77
       åˆ†é’Ÿ
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">ç¬¬3ç« ã€åˆè¯† Chart</h1>
            
            <div class="markdown-body">
              <h1 id="ç¬¬3ç« ã€åˆè¯†-Chart"><a href="#ç¬¬3ç« ã€åˆè¯†-Chart" class="headerlink" title="ç¬¬3ç« ã€åˆè¯† Chart"></a>ç¬¬3ç« ã€åˆè¯† Chart</h1><span id="more"></span>

<h2 id="ä¸€ã€Chart-æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#ä¸€ã€Chart-æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="ä¸€ã€Chart æ˜¯ä»€ä¹ˆï¼Ÿ"></a>ä¸€ã€Chart æ˜¯ä»€ä¹ˆï¼Ÿ</h2><p>è¿˜è®°å¾—æˆ‘ä»¬åœ¨ç¬¬ä¸€ç« èŠ‚æ—¶ä»‹ç» Helm çš„ä¸‰å¤§æ¦‚å¿µæ—¶æ˜¯å¦‚ä½•ä»‹ç» <code>chart</code> è¿™ä¸ªæ¦‚å¿µçš„å—ï¼Ÿæ˜¯çš„ï¼Œ<code>chart</code> å°±åƒè®¸å¤šè¯­è¨€å°è£…çš„æºç åŒ…ä¸€æ ·ï¼Œå®ƒæ˜¯ Helm ä½¿ç”¨çš„å°è£…åŒ…çš„æ€»ç§°ã€‚</p>
<p>æˆ‘ä»¬çŸ¥é“ï¼ŒKubernetes å°†å…¶ç®¡ç†çš„å¯¹è±¡ç§°ä¸ºèµ„æºï¼Œä¾‹å¦‚ deploymentã€serviceã€ingress ç­‰ã€‚è€Œ Helm ä½œä¸º K8s çš„åŒ…ç®¡ç†å™¨ï¼Œå…¶æœ€å¤§çš„ä½œç”¨å°±æ˜¯é€šè¿‡ chart çš„æ–¹å¼æ•´åˆéœ€è¦ç®¡ç†çš„ K8s ä¸­çš„èµ„æºï¼Œå†é€šè¿‡ Helm å®¢æˆ·ç«¯ <strong>ç»Ÿä¸€äº¤ç”±</strong> K8s api server å»æ‰§è¡Œã€‚</p>
<hr>
<h2 id="äºŒã€Chart-åŸºç¡€ä½¿ç”¨"><a href="#äºŒã€Chart-åŸºç¡€ä½¿ç”¨" class="headerlink" title="äºŒã€Chart åŸºç¡€ä½¿ç”¨"></a>äºŒã€Chart åŸºç¡€ä½¿ç”¨</h2><h3 id="1ã€æŸ¥æ‰¾-Chart"><a href="#1ã€æŸ¥æ‰¾-Chart" class="headerlink" title="1ã€æŸ¥æ‰¾ Chart"></a>1ã€æŸ¥æ‰¾ Chart</h3><blockquote>
<p>Helm æä¾›äº†2ç§æœç´¢å‘½ä»¤ï¼Œå¯ç”¨ç”¨æ¥ä»ä¸¤ç§æ¥æºä¸­è¿›è¡Œæœç´¢ï¼š</p>
<ul>
<li><code>helm search hub</code>ï¼šä» <a target="_blank" rel="noopener" href="https://artifacthub.io/">Artifact Hub</a> ä¸­æŸ¥æ‰¾å¹¶åˆ—å‡º helm chartsã€‚ Artifact Hubä¸­å­˜æ”¾äº†å¤§é‡ä¸åŒçš„ä»“åº“ã€‚</li>
<li><code>helm search repo</code>ï¼šä»ä½ æ·»åŠ ï¼ˆä½¿ç”¨ <code>helm repo add</code>ï¼‰åˆ°æœ¬åœ° helm å®¢æˆ·ç«¯ä¸­çš„ä»“åº“ä¸­è¿›è¡ŒæŸ¥æ‰¾ã€‚è¯¥å‘½ä»¤åŸºäºæœ¬åœ°æ•°æ®è¿›è¡Œæœç´¢ï¼Œæ— éœ€è¿æ¥äº’è”ç½‘ã€‚</li>
</ul>
</blockquote>
<h4 id="1ï¼‰æœç´¢æ‰€æœ‰å…¬å¼€å¯ç”¨çš„-charts"><a href="#1ï¼‰æœç´¢æ‰€æœ‰å…¬å¼€å¯ç”¨çš„-charts" class="headerlink" title="1ï¼‰æœç´¢æ‰€æœ‰å…¬å¼€å¯ç”¨çš„ charts"></a>1ï¼‰æœç´¢æ‰€æœ‰å…¬å¼€å¯ç”¨çš„ <code>charts</code></h4><p>æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ä» <code>Artifact Hub</code> ä¸­æœç´¢æ‰€æœ‰çš„ <code>wordpress</code> chartsï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> å‘½ä»¤: helm search hub &lt;chart_name&gt;</span> <br>helm search hub wordpress<br></code></pre></td></tr></table></figure>

<p><img src="http://uniondrug-devops.oss-cn-hangzhou.aliyuncs.com/blog_images/image-20210629102731888.png" srcset="/img/loading.gif" lazyload alt="image-20210629102731888"></p>
<h4 id="2ï¼‰æœç´¢æœ¬åœ°-stable-æºä¸­å¯ç”¨çš„-charts"><a href="#2ï¼‰æœç´¢æœ¬åœ°-stable-æºä¸­å¯ç”¨çš„-charts" class="headerlink" title="2ï¼‰æœç´¢æœ¬åœ° stable æºä¸­å¯ç”¨çš„ charts"></a>2ï¼‰æœç´¢æœ¬åœ° <code>stable</code> æºä¸­å¯ç”¨çš„ <code>charts</code></h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> å‘½ä»¤: helm search repo &lt;repo_name&gt;</span><br>helm search repo stable<br></code></pre></td></tr></table></figure>

<p><img src="http://uniondrug-devops.oss-cn-hangzhou.aliyuncs.com/blog_images/image-20210628152107519.png" srcset="/img/loading.gif" lazyload alt="image-20210628152107519"></p>
<h4 id="3ï¼‰æ¨¡ç³ŠåŒ¹é…æœç´¢"><a href="#3ï¼‰æ¨¡ç³ŠåŒ¹é…æœç´¢" class="headerlink" title="3ï¼‰æ¨¡ç³ŠåŒ¹é…æœç´¢"></a>3ï¼‰æ¨¡ç³ŠåŒ¹é…æœç´¢</h4><p>Helm çš„æœç´ ä½¿ç”¨æ¨¡ç³Šå­—ç¬¦ä¸²åŒ¹é…ç®—æ³•ï¼Œåªéœ€è¦è¾“å…¥åå­—çš„ä¸€éƒ¨åˆ†å°±å¯ä»¥ä»æœ¬åœ°ä»“åº“è®°å½•ä¸­è¿›è¡Œæœç´¢ï¼Œå¦‚ä¸‹æœç´¢ <code>word</code>ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> å‘½ä»¤: helm search repo &lt;string&gt;</span><br>helm search repo word<br></code></pre></td></tr></table></figure>

<p><img src="http://uniondrug-devops.oss-cn-hangzhou.aliyuncs.com/blog_images/image-20210629103454469.png" srcset="/img/loading.gif" lazyload alt="image-20210629103454469"></p>
<h3 id="2ã€å®‰è£…-Chart"><a href="#2ã€å®‰è£…-Chart" class="headerlink" title="2ã€å®‰è£… Chart"></a>2ã€å®‰è£… Chart</h3><blockquote>
<p>ä½¿ç”¨ <code>helm search</code> æ‰¾åˆ°ä½ æƒ³è¦å®‰è£…çš„ helmåŒ…åï¼Œå°±å¯ä»¥ä½¿ç”¨ <code>helm install</code> æ¥è¿›è¡Œå®‰è£…ã€‚æœ€ç®€å•ä½¿ç”¨æ–¹æ¡ˆåªéœ€è¦ä¼ å…¥ä¸¤ä¸ªå‚æ•°ï¼š<code>releaseçš„åå­—</code> å’Œ <code>chartçš„åç§°</code>ã€‚</p>
</blockquote>
<h4 id="1ï¼‰å®‰è£…helmåŒ…"><a href="#1ï¼‰å®‰è£…helmåŒ…" class="headerlink" title="1ï¼‰å®‰è£…helmåŒ…"></a>1ï¼‰å®‰è£…helmåŒ…</h4><p>æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå³åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„ <code>release</code> å¯¹è±¡ï¼Œå‘½åä¸º <code>happy-panda</code> ï¼Œå¦‚æœæƒ³è¦è‡ªåŠ¨ç”Ÿæˆä¸€ååç§°ï¼Œå¯ä»¥ä½¿ç”¨<code>--generate-name</code> å‚æ•°:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> å‘½ä»¤: helm install &lt;release_name&gt; &lt;chart_name&gt; ï¼ˆchartåç§°é¡»å…·ä½“ï¼Œå¦‚ bitnami/wordpressã€‚ä¸èƒ½åªæ˜¯å…³é”®å­—ï¼‰</span><br>helm install happy-panda bitnami/wordpress<br></code></pre></td></tr></table></figure>

<p><img src="http://uniondrug-devops.oss-cn-hangzhou.aliyuncs.com/blog_images/image-20210629104631960.png" srcset="/img/loading.gif" lazyload alt="image-20210629104631960"></p>
<h4 id="2ï¼‰æŸ¥çœ‹è¿è¡ŒçŠ¶æ€"><a href="#2ï¼‰æŸ¥çœ‹è¿è¡ŒçŠ¶æ€" class="headerlink" title="2ï¼‰æŸ¥çœ‹è¿è¡ŒçŠ¶æ€"></a>2ï¼‰æŸ¥çœ‹è¿è¡ŒçŠ¶æ€</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">helm list<br></code></pre></td></tr></table></figure>

<p>è¿”å›å¦‚ä¸‹ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">NAME     	NAMESPACE	REVISION	UPDATED                                	STATUS  	CHART            	APP VERSION<br>happy-panda	default  	1       	2021-06-29 10:51:13.437131205 +0800 CST	deployed	wordpress-11.0.16	5.7.2  <br></code></pre></td></tr></table></figure>

<h4 id="3ï¼‰æŸ¥çœ‹å‘å¸ƒçŠ¶æ€"><a href="#3ï¼‰æŸ¥çœ‹å‘å¸ƒçŠ¶æ€" class="headerlink" title="3ï¼‰æŸ¥çœ‹å‘å¸ƒçŠ¶æ€"></a>3ï¼‰æŸ¥çœ‹å‘å¸ƒçŠ¶æ€</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> å‘½ä»¤: helm status &lt;release_name&gt;</span><br>helm status happy-panda<br></code></pre></td></tr></table></figure>

<p>è¿”å›å€¼å’Œå®‰è£…æ—¶çš„è¿”å›ä¸€æ ·ã€‚</p>
<h4 id="4ï¼‰å¸è½½helmåŒ…"><a href="#4ï¼‰å¸è½½helmåŒ…" class="headerlink" title="4ï¼‰å¸è½½helmåŒ…"></a>4ï¼‰å¸è½½helmåŒ…</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> å‘½ä»¤: helm uninstall &lt;release_name&gt;</span><br>helm uninstall happy-panda<br></code></pre></td></tr></table></figure>



<h3 id="3ã€ä¸‹è½½-Chart"><a href="#3ã€ä¸‹è½½-Chart" class="headerlink" title="3ã€ä¸‹è½½ Chart"></a>3ã€ä¸‹è½½ Chart</h3><blockquote>
<p>Helm çš„ chart åŒæ—¶ä¹Ÿæ”¯æŒä¸‹è½½ï¼Œä¸‹è½½ä¸‹æ¥çš„æ˜¯ä¸€ä¸ªtaråŒ…ï¼Œè§£å‹åå³å¯è·å¾—å®˜æ–¹çš„ chart ç›®å½•ï¼ŒåŸºäºç›®å½•ä¸­æä¾›çš„æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹å…¶ä¸­çš„å†…å®¹è¿›è¡Œä¿®æ”¹ï¼Œè¿›è¡Œè‡ªå®šä¹‰çš„å‘å¸ƒï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥å­¦ä¹ å…¶è¯­æ³•ã€‚</p>
</blockquote>
<h4 id="1ï¼‰ä¸‹è½½"><a href="#1ï¼‰ä¸‹è½½" class="headerlink" title="1ï¼‰ä¸‹è½½"></a>1ï¼‰ä¸‹è½½</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> å‘½ä»¤: helm pull &lt;chart_name&gt; ï¼ˆchartåç§°é¡»å…·ä½“ï¼Œå¦‚ bitnami/kongã€‚ä¸èƒ½åªæ˜¯å…³é”®å­—ï¼‰</span><br>helm pull bitnami/kong<br></code></pre></td></tr></table></figure>

<p><img src="http://uniondrug-devops.oss-cn-hangzhou.aliyuncs.com/blog_images/image-20210701103804465.png" srcset="/img/loading.gif" lazyload alt="image-20210701103804465"></p>
<h4 id="2ï¼‰è§£å‹"><a href="#2ï¼‰è§£å‹" class="headerlink" title="2ï¼‰è§£å‹"></a>2ï¼‰è§£å‹</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">tar xf kong-3.7.5.tgz <br></code></pre></td></tr></table></figure>

<p><img src="http://uniondrug-devops.oss-cn-hangzhou.aliyuncs.com/blog_images/image-20210701103958115.png" srcset="/img/loading.gif" lazyload alt="image-20210701103958115"></p>
<h4 id="3ï¼‰ç›®å½•ç»“æ„"><a href="#3ï¼‰ç›®å½•ç»“æ„" class="headerlink" title="3ï¼‰ç›®å½•ç»“æ„"></a>3ï¼‰ç›®å½•ç»“æ„</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs shell">kong<br>â”œâ”€â”€ Chart.lock<br>â”œâ”€â”€ charts						# kong çš„ chart ä¾èµ–çš„å…¶ä»– chartï¼Œæ•°æ®åº“<br>â”‚Â Â  â”œâ”€â”€ cassandra<br>â”‚Â Â  â”œâ”€â”€ common<br>â”‚Â Â  â””â”€â”€ postgresql<br>â”œâ”€â”€ Chart.yaml				# åŒ…å«äº†chartä¿¡æ¯çš„YAMLæ–‡ä»¶<br>â”œâ”€â”€ ci<br>â”‚Â Â  â”œâ”€â”€ values-editing-containers.yaml<br>â”‚Â Â  â”œâ”€â”€ values-external-cassandra.yaml<br>â”‚Â Â  â”œâ”€â”€ values-external-postgresql.yaml<br>â”‚Â Â  â”œâ”€â”€ values-ingress.yaml<br>â”‚Â Â  â””â”€â”€ values-metrics-hpa-pdb.yaml<br>â”œâ”€â”€ crds							# è‡ªå®šä¹‰èµ„æº<br>â”‚Â Â  â””â”€â”€ custom-resource-definitions.yaml<br>â”œâ”€â”€ README.md<br>â”œâ”€â”€ templates					# èµ„æºæ¨¡ç‰ˆï¼Œé…ç½® values è¿›è¡Œæ¸²æŸ“ï¼Œç”Ÿäº§æœ‰æ•ˆçš„ K8s manifest<br>â”‚Â Â  â”œâ”€â”€ dep-ds.yaml<br>â”‚Â Â  â”œâ”€â”€ external-database-secret.yaml<br>â”‚Â Â  â”œâ”€â”€ extra-list.yaml<br>â”‚Â Â  â”œâ”€â”€ _helpers.tpl<br>â”‚Â Â  â”œâ”€â”€ hpa.yaml<br>â”‚Â Â  â”œâ”€â”€ ingress-controller-rbac.yaml<br>â”‚Â Â  â”œâ”€â”€ ingress.yaml<br>â”‚Â Â  â”œâ”€â”€ kong-prometheus-rolebinding.yaml<br>â”‚Â Â  â”œâ”€â”€ kong-prometheus-role.yaml<br>â”‚Â Â  â”œâ”€â”€ kong-script-configmap.yaml<br>â”‚Â Â  â”œâ”€â”€ metrics-exporter-configmap.yaml<br>â”‚Â Â  â”œâ”€â”€ metrics-script-configmap.yaml<br>â”‚Â Â  â”œâ”€â”€ metrics-service.yaml<br>â”‚Â Â  â”œâ”€â”€ migrate-job.yaml<br>â”‚Â Â  â”œâ”€â”€ NOTES.txt<br>â”‚Â Â  â”œâ”€â”€ pdb.yaml<br>â”‚Â Â  â”œâ”€â”€ servicemonitor.yaml<br>â”‚Â Â  â”œâ”€â”€ service.yaml<br>â”‚Â Â  â””â”€â”€ tls-secrets.yaml<br>â””â”€â”€ values.yaml				# chart é»˜è®¤çš„é…ç½®å€¼<br><br></code></pre></td></tr></table></figure>




<h3 id="4ã€è‡ªå»º-Chart"><a href="#4ã€è‡ªå»º-Chart" class="headerlink" title="4ã€è‡ªå»º Chart"></a>4ã€è‡ªå»º Chart</h3><blockquote>
<p>é™¤äº†ä»è¿œç¨‹ helm ä»“åº“ä¸­è·å–å®˜æ–¹æˆ–ä¸‰æ–¹çš„ chart å¤–ï¼ŒHelm æ›´åŠ é‡è¦çš„åŠŸèƒ½åœ¨äºè‡ªå»º chartï¼Œå®ƒä¼šåˆ›å»ºä¸€ä¸ª chart éœ€è¦çš„æœ€å°åŒ–ç›®å½•ç»“æ„ä»¥åŠå„å¿…è¦æ–‡ä»¶çš„æ¨¡ç‰ˆã€‚chart çš„æ•´ä½“æ„é€ æ¯”è¾ƒç±»ä¼¼ ansible çš„ rolesã€‚</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> å‘½ä»¤: helm create &lt;chart_name&gt;</span><br>helm create test_chart<br></code></pre></td></tr></table></figure>

<p><img src="http://uniondrug-devops.oss-cn-hangzhou.aliyuncs.com/blog_images/image-20210701180328092.png" srcset="/img/loading.gif" lazyload alt="image-20210701180328092"></p>
<h3 id="5ã€æ£€æŸ¥-Chart"><a href="#5ã€æ£€æŸ¥-Chart" class="headerlink" title="5ã€æ£€æŸ¥ Chart"></a>5ã€æ£€æŸ¥ Chart</h3><blockquote>
<p>Helm è‡ªåŠ¨äº†è¯­æ³•æ£€æŸ¥å·¥å…·ï¼Œå…¶ä½œç”¨ç±»ä¼¼ <code>nginx -t</code>ï¼Œä¼šå¯¹ chart çš„æ ¼å¼æˆ–è€…ä¸€äº›ä¿¡æ¯è¿›è¡Œè‡ªæ£€ï¼Œå¹¶è¿”å›æ£€æŸ¥ç»“æœï¼Œåœ¨å‘å¸ƒå‰ï¼Œè¿›è¡Œè¯­æ³•æ£€æŸ¥æ˜¯å¾ˆå¥½çš„é€‰æ‹©ã€‚</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> å‘½ä»¤: helm lint &lt;chart_name&gt;</span><br>helm lint test_chart<br></code></pre></td></tr></table></figure>

<p><img src="http://uniondrug-devops.oss-cn-hangzhou.aliyuncs.com/blog_images/image-20210705142216832.png" srcset="/img/loading.gif" lazyload alt="image-20210705142216832"></p>
<h3 id="6ã€ä¸Šä¼ -Chart"><a href="#6ã€ä¸Šä¼ -Chart" class="headerlink" title="6ã€ä¸Šä¼  Chart"></a>6ã€ä¸Šä¼  Chart</h3><h4 id="1ï¼‰æ‰“åŒ…-Chart"><a href="#1ï¼‰æ‰“åŒ…-Chart" class="headerlink" title="1ï¼‰æ‰“åŒ… Chart"></a>1ï¼‰æ‰“åŒ… Chart</h4><blockquote>
<p>åœ¨ä¸Šé¢çš„ä¸€ç³»åˆ—æ“ä½œä¸­æˆ‘ä»¬çŸ¥é“ï¼ŒHelm ä»“åº“ä¸­å­˜æ”¾çš„æ˜¯ä¸€ä¸ªä¸ªçš„ tar åŒ…ï¼Œè€Œä¸æ˜¯ç›®å½•ï¼Œå› æ­¤å¦‚æœä½ æƒ³ä¸Šä¼ è‡ªå»ºçš„ chartï¼Œå°±éœ€è¦å°†å…¶å…ˆè¡Œæ‰“åŒ…ã€‚Helm æä¾›äº†è¿™æ ·ä¸€ä¸ªå‘½åæ¥å°†ä½ è‡ªå»ºçš„ chart æ‰“åŒ…å‡º Helm å¯è¯†åˆ«çš„æ ¼å¼ã€‚</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> å‘½ä»¤: helm package &lt;chart_name&gt;</span><br>helm package test_chart<br></code></pre></td></tr></table></figure>

<p><img src="http://uniondrug-devops.oss-cn-hangzhou.aliyuncs.com/blog_images/image-20210701111357599.png" srcset="/img/loading.gif" lazyload alt="image-20210701111357599"></p>
<blockquote>
<p>ğŸš© <strong>ä¸ºä»€ä¹ˆç‰ˆæœ¬æ˜¯ 0.1.0ï¼Ÿ</strong></p>
<p>è¿™æ˜¯ç”± Chart.yaml ä¸­çš„ <code>version</code> å­—æ®µå†³å®šçš„ã€‚</p>
<p><img src="http://uniondrug-devops.oss-cn-hangzhou.aliyuncs.com/blog_images/image-20210701111524833.png" srcset="/img/loading.gif" lazyload alt="image-20210701111524833"></p>
</blockquote>
<h4 id="2ï¼‰ä¸Šä¼ è‡³ç§æœ‰ä»“åº“"><a href="#2ï¼‰ä¸Šä¼ è‡³ç§æœ‰ä»“åº“" class="headerlink" title="2ï¼‰ä¸Šä¼ è‡³ç§æœ‰ä»“åº“"></a>2ï¼‰ä¸Šä¼ è‡³ç§æœ‰ä»“åº“</h4><blockquote>
<p><strong>å››ä¸ªæ­¥éª¤ï¼š</strong></p>
<p>1ï¼‰è‡ªå»ºç§æœ‰ä»“åº“</p>
<p>2ï¼‰ç”Ÿæˆã€æ›´æ–° chart ç´¢å¼•æ–‡ä»¶</p>
<p>3ï¼‰ä¸Šä¼  chart å’Œç´¢å¼•æ–‡ä»¶</p>
<p>4ï¼‰æ›´æ–°æœ¬åœ° chart ä»“åº“</p>
</blockquote>
<h4 id="3ï¼‰ä¸Šä¼ è‡³-Helm-Hub"><a href="#3ï¼‰ä¸Šä¼ è‡³-Helm-Hub" class="headerlink" title="3ï¼‰ä¸Šä¼ è‡³ Helm Hub"></a>3ï¼‰ä¸Šä¼ è‡³ Helm Hub</h4><blockquote>
<p>ğŸš© <strong>å‚è€ƒæ–‡æ¡£:</strong></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/jeffzhesi/article/details/106565173">https://blog.csdn.net/jeffzhesi/article/details/106565173</a></p>
</blockquote>
<hr>
<h2 id="ä¸‰ã€Chart-è¯­æ³•é‡Šä¹‰"><a href="#ä¸‰ã€Chart-è¯­æ³•é‡Šä¹‰" class="headerlink" title="ä¸‰ã€Chart è¯­æ³•é‡Šä¹‰"></a>ä¸‰ã€Chart è¯­æ³•é‡Šä¹‰</h2><h3 id="1ã€chart-åŸºæœ¬å…ƒç´ é‡Šä¹‰ï¼š"><a href="#1ã€chart-åŸºæœ¬å…ƒç´ é‡Šä¹‰ï¼š" class="headerlink" title="1ã€chart åŸºæœ¬å…ƒç´ é‡Šä¹‰ï¼š"></a>1ã€chart åŸºæœ¬å…ƒç´ é‡Šä¹‰ï¼š</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs shell">test_chart<br>â”œâ”€â”€ charts												# å¯é€‰: æœ¬ chart ä¾èµ–çš„å…¶ä»– chart<br>â”œâ”€â”€ Chart.yaml										# å¿…éœ€: ç”¨äºæè¿° chart ç›¸å…³ä¿¡æ¯ï¼ŒåŒ…æ‹¬åç§°ã€æè¿°ä¿¡æ¯ã€apiç‰ˆæœ¬ç­‰<br>â”œâ”€â”€ templates											# å¿…éœ€: åšç”¨äº K8s èµ„æºçš„ yaml æ¨¡ç‰ˆ<br>â”‚Â Â  â”œâ”€â”€ deployment.yaml						# ç”¨äºç”Ÿæˆ K8s deployment èµ„æºçš„ yaml æ¨¡ç‰ˆï¼Œå‘å¸ƒåº”ç”¨çš„åŸºæœ¬å…ƒç´ <br>â”‚Â Â  â”œâ”€â”€ _helpers.tpl							# ç”¨äºå®šä¹‰ä¸€äº›å¯é‡ç”¨çš„æ¨¡æ¿ç‰‡æ–­ï¼Œåœ¨æ­¤æ–‡ä»¶ä¸­çš„å®šä¹‰åœ¨ä»»ä½•èµ„æºå®šä¹‰æ¨¡æ¿ä¸­éƒ½å¯ç”¨<br>â”‚Â Â  â”œâ”€â”€ hpa.yaml									# ç”¨äºç”Ÿæˆ K8s hpa çš„ yaml æ¨¡ç‰ˆï¼Œå¦‚æœåŠ¡éœ€è¦å¼¹æ€§ä¼¸ç¼©ç­–ç•¥ï¼Œåˆ™åœ¨è¯¥æ¨¡ç‰ˆä¸­å®šä¹‰<br>â”‚Â Â  â”œâ”€â”€ ingress.yaml							# ç”¨äºç”Ÿæˆ K8s ingress çš„ yaml æ¨¡ç‰ˆï¼Œå¦‚æœæœåŠ¡éœ€è¦å¯¹å¤–æ”¾å‡ºï¼Œåˆ™åœ¨è¯¥æ¨¡ç‰ˆä¸­å®šä¹‰ ingress<br>â”‚Â Â  â”œâ”€â”€ NOTES.txt									# å¿…éœ€: ç”¨äºä»‹ç» chart éƒ¨ç½²åçš„ä¸€äº›ä¿¡æ¯ï¼Œæ¯”å¦‚å¦‚ä½•ä½¿ç”¨è¿™ä¸ª chartã€åˆ—å‡ºç¼ºçœè®¾ç½®ç­‰<br>â”‚Â Â  â”œâ”€â”€ serviceaccount.yaml				# ç”¨äºç”Ÿæˆ K8s serviceaccount èµ„æºçš„ yaml æ¨¡ç‰ˆï¼Œå¦‚éœ€è¦åˆ›å»ºç‰¹å®šè®¤è¯å¯¹è±¡ï¼Œåˆ™åœ¨è¯¥æ¨¡ç‰ˆä¸­å®šä¹‰<br>â”‚Â Â  â”œâ”€â”€ service.yaml							# ç”¨äºç”Ÿæˆ K8s service èµ„æºçš„ yaml æ¨¡ç‰ˆï¼Œå‘å¸ƒåº”ç”¨çš„åŸºæœ¬å…ƒç´ <br>â”‚Â Â  â””â”€â”€ tests											# helm çš„æµ‹è¯•é’©å­<br>â”‚Â Â      â””â”€â”€ test-connection.yaml<br>â””â”€â”€ values.yaml										# å¿…éœ€: ç”¨äºå­˜å‚¨è¦æ¸²æŸ“è‡³ templates/ ä¸‹æ¨¡ç‰ˆæ–‡ä»¶ä¸­çš„å€¼<br></code></pre></td></tr></table></figure>





<h3 id="2ã€Chart-yaml"><a href="#2ã€Chart-yaml" class="headerlink" title="2ã€Chart.yaml"></a>2ã€Chart.yaml</h3><p>ä¸€ä¸ªæ ‡å‡†çš„ Chart.yaml åŒ…å«ä»¥ä¸‹å­—æ®µï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">apiVersion:</span> 				<span class="hljs-comment"># å¿…éœ€: chart API ç‰ˆæœ¬, v2 ç‰ˆæœ¬ä¸º helm3 è¯­æ³•ï¼Œv1 ç‰ˆæœ¬ä»ç„¶ä¿ç•™ä½¿ç”¨</span><br><span class="hljs-attr">name:</span> 							<span class="hljs-comment"># å¿…éœ€: chartåç§°</span><br><span class="hljs-attr">version:</span> 						<span class="hljs-comment"># å¿…éœ€: chart çš„ç‰ˆæœ¬æ§åˆ¶æ ‡è¯†</span><br><span class="hljs-attr">kubeVersion:</span> 				<span class="hljs-comment"># å¯é€‰: å…¼å®¹Kubernetesç‰ˆæœ¬çš„è¯­ä¹‰åŒ–ç‰ˆæœ¬ï¼Œå¯ä»¥ä½¿ç”¨è¿ç®—ç¬¦ï¼Œå½¢å¼å¦‚ &gt;= 1.13.0 &lt; 1.15.0</span><br><span class="hljs-attr">description:</span> 				<span class="hljs-comment"># å¯é€‰: å¯¹äºè¿™ä¸ª chart çš„æè¿°ä¿¡æ¯</span><br><span class="hljs-attr">type:</span> 							<span class="hljs-comment"># å¯é€‰: chartç±»å‹, æ”¯æŒ2ç§ç±»å‹ï¼Œapplication å’Œ libraryï¼Œé»˜è®¤ä½¿ç”¨ application</span><br><span class="hljs-attr">keywords:</span>						<span class="hljs-comment"># å¯é€‰: å…³äºé¡¹ç›®çš„ä¸€ç»„å…³é”®å­—</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-string">xxx</span>					<br>  <span class="hljs-bullet">-</span> <span class="hljs-string">xxx</span><br><span class="hljs-attr">home:</span> 							<span class="hljs-comment"># å¯é€‰: é¡¹ç›®homeé¡µé¢çš„URL</span><br><span class="hljs-attr">sources:</span>						<span class="hljs-comment"># å¯é€‰: é¡¹ç›®æºç çš„URLåˆ—è¡¨</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-string">xxx</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-string">xxx</span><br><span class="hljs-attr">dependencies:</span> 			<span class="hljs-comment"># å¯é€‰: chart çš„ä¾èµ–é¡¹ï¼Œæ‰§è¡Œ `helm dep up &lt;chart_name&gt;` æ›´æ–°ä¾èµ–ï¼Œä¾èµ–çš„ chartåŒ… ä¼šä¸‹è½½è‡³ charts/ </span><br>  <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> 					<span class="hljs-comment"># chartåç§°, å¦‚ nginx</span><br>    <span class="hljs-attr">version:</span> 				<span class="hljs-comment"># chartç‰ˆæœ¬, å¦‚ &quot;1.2.3&quot;</span><br>    <span class="hljs-attr">repository:</span> 		<span class="hljs-comment"># å¯é€‰: ä»“åº“çš„å®Œæ•´URL (&quot;https://example.com/charts&quot;) æˆ–åˆ«å (&quot;@repo-name&quot;)</span><br>    <span class="hljs-attr">condition:</span> 			<span class="hljs-comment"># å¯é€‰: è§£æä¸ºå¸ƒå°”å€¼çš„yamlè·¯å¾„ï¼Œç”¨äºå¯ç”¨/ç¦ç”¨chart (e.g. subchart1.enabled )</span><br>    <span class="hljs-attr">tags:</span> 					<span class="hljs-comment"># å¯é€‰: ç”¨äºä¸€æ¬¡å¯ç”¨/ç¦ç”¨ ä¸€ç»„chartçš„tag</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">xxx</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">xxx</span><br>    <span class="hljs-attr">import-values:</span>  <span class="hljs-comment"># å¯é€‰: ä¿å­˜æºå€¼åˆ°å¯¼å…¥çˆ¶é”®çš„æ˜ å°„ã€‚æ¯é¡¹å¯ä»¥æ˜¯å­—ç¬¦ä¸²æˆ–è€…ä¸€å¯¹å­/çˆ¶åˆ—è¡¨é¡¹</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">ImportValue</span>  <br>    <span class="hljs-attr">alias:</span> 					<span class="hljs-comment"># å¯é€‰: ä¾èµ– chart çš„åˆ«åã€‚å½“ä½ è¦å¤šæ¬¡æ·»åŠ ç›¸åŒçš„chartæ—¶ä¼šå¾ˆæœ‰ç”¨</span><br><span class="hljs-attr">maintainers:</span> 				<span class="hljs-comment"># å¯é€‰: ç»´æŠ¤è€…ä¿¡æ¯</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> 					<span class="hljs-comment"># ç»´æŠ¤è€…åå­— ï¼ˆæ¯ä¸ªç»´æŠ¤è€…éƒ½éœ€è¦ï¼‰</span><br>    <span class="hljs-attr">email:</span> 					<span class="hljs-comment"># ç»´æŠ¤è€…é‚®ç®± ï¼ˆæ¯ä¸ªç»´æŠ¤è€…å¯é€‰ï¼‰</span><br>    <span class="hljs-attr">url:</span> 						<span class="hljs-comment"># ç»´æŠ¤è€…URL ï¼ˆæ¯ä¸ªç»´æŠ¤è€…å¯é€‰ï¼‰</span><br><span class="hljs-attr">icon:</span> 							<span class="hljs-comment"># å¯é€‰: ç”¨åšiconçš„SVGæˆ–PNGå›¾ç‰‡URL</span><br><span class="hljs-attr">appVersion:</span> 				<span class="hljs-comment"># å¯é€‰: ä¸ç‰ˆæœ¬æ§åˆ¶çš„ version æ— å…³ï¼Œç”¨äºæŒ‡å®šåº”ç”¨çš„ç‰ˆæœ¬</span><br><span class="hljs-attr">deprecated:</span> 				<span class="hljs-comment"># å¯é€‰: æ ‡è®°è¯¥ chart å·²åºŸå¼ƒï¼Œä½¿ç”¨æ–¹æ³•ä¸ºå¸ƒå°”å€¼</span><br><span class="hljs-attr">annotations:</span><br>  <span class="hljs-attr">example:</span> 					<span class="hljs-comment"># å¯é€‰: æŒ‰åç§°è¾“å…¥çš„æ‰¹æ³¨åˆ—è¡¨</span><br></code></pre></td></tr></table></figure>



<h4 id="1ï¼‰ä½¿ç”¨-dependencies-è¡¨è¾¾å¼ç®¡ç†ä¾èµ–"><a href="#1ï¼‰ä½¿ç”¨-dependencies-è¡¨è¾¾å¼ç®¡ç†ä¾èµ–" class="headerlink" title="1ï¼‰ä½¿ç”¨ dependencies è¡¨è¾¾å¼ç®¡ç†ä¾èµ–"></a>1ï¼‰ä½¿ç”¨ dependencies è¡¨è¾¾å¼ç®¡ç†ä¾èµ–</h4><h5 id="1-åŸºæœ¬åŸåˆ™"><a href="#1-åŸºæœ¬åŸåˆ™" class="headerlink" title="1. åŸºæœ¬åŸåˆ™"></a>1. åŸºæœ¬åŸåˆ™</h5><p>Helm3 ä¸­ï¼Œå¼ƒç”¨äº† <code>requeirements.yaml</code> ï¼Œ<code>dependencies</code> å­—æ®µè¢«åˆå¹¶è‡³äº† <code>Chart.yaml</code> ä¸­ï¼Œä½†æ˜¯å°±è¯­æ³•è¡¨è¾¾å¼æ¥è¯´ï¼Œå’Œä¹‹å‰æ²¡æœ‰å¤ªå¤§çš„å˜åŒ–ã€‚ä½¿ç”¨æ–¹å¼æ¯”è¾ƒç±»ä¼¼ ansible çš„ playbook æˆ– docker composeï¼Œå…¶è¡¨è¾¾å¼å¦‚ä¸‹ï¼Œæ˜¯ä¸€ä¸ªåˆ—è¡¨å½¢å¼ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">dependencies:</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">nginx</span><br>    <span class="hljs-attr">version:</span> <span class="hljs-number">2.0</span><span class="hljs-number">.1</span><br>    <span class="hljs-attr">repository:</span> <span class="hljs-string">https://example.com/charts</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">mysql</span><br>    <span class="hljs-attr">version:</span> <span class="hljs-number">3.2</span><span class="hljs-number">.1</span><br>    <span class="hljs-attr">repository:</span> <span class="hljs-string">https://another.example.com/charts</span><br></code></pre></td></tr></table></figure>

<blockquote>
<ul>
<li><p><code>name</code> å­—æ®µï¼šæ‰€éœ€ä¾èµ– chart çš„åç§°</p>
</li>
<li><p><code>version</code> å­—æ®µï¼šæ‰€éœ€ä¾èµ– chart çš„ç‰ˆæœ¬</p>
</li>
<li><p><code>repository</code> å­—æ®µï¼šchart ä»“åº“çš„å®Œæ•´ URL æˆ–è€… ä»“åº“çš„åç§°</p>
<p>ä½¿ç”¨ URL ï¼š<code>https://kubernetes.oss-cn-hangzhou.aliyuncs.com/charts</code></p>
<p>ä½¿ç”¨ ä»“åº“åç§°ï¼š<code>@stable</code></p>
</li>
</ul>
<p>ğŸš©  ä»“åº“å¿…é¡»äº‹å…ˆä½¿ç”¨ <code>helm repo add</code> æ·»åŠ ï¼Œæ‰§è¡Œç±»ä¼¼å¦‚ä¸‹å‘½ä»¤ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">helm repo add stable https://kubernetes.oss-cn-hangzhou.aliyuncs.com/charts<br></code></pre></td></tr></table></figure>
</blockquote>
<h5 id="2-ç¤ºä¾‹è¯´æ˜"><a href="#2-ç¤ºä¾‹è¯´æ˜" class="headerlink" title="2. ç¤ºä¾‹è¯´æ˜"></a>2. ç¤ºä¾‹è¯´æ˜</h5><h6 id="1âƒ£ï¸-æ·»åŠ ä»“åº“"><a href="#1âƒ£ï¸-æ·»åŠ ä»“åº“" class="headerlink" title="1âƒ£ï¸ æ·»åŠ ä»“åº“"></a>1âƒ£ï¸ æ·»åŠ ä»“åº“</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">helm repo add bitnami https://charts.bitnami.com/bitnami  <br></code></pre></td></tr></table></figure>

<h6 id="2âƒ£ï¸-å†™ä¾èµ–è¡¨è¾¾å¼"><a href="#2âƒ£ï¸-å†™ä¾èµ–è¡¨è¾¾å¼" class="headerlink" title="2âƒ£ï¸ å†™ä¾èµ–è¡¨è¾¾å¼"></a>2âƒ£ï¸ å†™ä¾èµ–è¡¨è¾¾å¼</h6><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">dependencies:</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">nginx</span><br>    <span class="hljs-attr">version:</span> <span class="hljs-number">9.3</span><span class="hljs-number">.3</span><br>    <span class="hljs-attr">repository:</span> <span class="hljs-string">&quot;@bitnami&quot;</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">mariadb</span><br>    <span class="hljs-attr">version:</span> <span class="hljs-number">2.1</span><span class="hljs-number">.6</span><br>    <span class="hljs-attr">repository:</span> <span class="hljs-string">&quot;@bitnami&quot;</span><br></code></pre></td></tr></table></figure>

<h6 id="3âƒ£ï¸-æ›´æ–°ä¾èµ–"><a href="#3âƒ£ï¸-æ›´æ–°ä¾èµ–" class="headerlink" title="3âƒ£ï¸ æ›´æ–°ä¾èµ–"></a>3âƒ£ï¸ æ›´æ–°ä¾èµ–</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">helm dependency update<br></code></pre></td></tr></table></figure>

<p><img src="http://uniondrug-devops.oss-cn-hangzhou.aliyuncs.com/blog_images/image-20210702105136710.png" srcset="/img/loading.gif" lazyload alt="image-20210702105136710"></p>
<p>ä¾èµ–çš„ chart åŒ… ä¼šè¢«ä¸‹è½½åˆ° <code>charts/</code> ç›®å½•ä¸‹ï¼š</p>
<p><img src="http://uniondrug-devops.oss-cn-hangzhou.aliyuncs.com/blog_images/image-20210702105157112.png" srcset="/img/loading.gif" lazyload alt="image-20210702105157112"></p>
<h4 id="2ï¼‰é€šè¿‡-charts-ç›®å½•æ‰‹åŠ¨ç®¡ç†ä¾èµ–"><a href="#2ï¼‰é€šè¿‡-charts-ç›®å½•æ‰‹åŠ¨ç®¡ç†ä¾èµ–" class="headerlink" title="2ï¼‰é€šè¿‡ charts/ ç›®å½•æ‰‹åŠ¨ç®¡ç†ä¾èµ–"></a>2ï¼‰é€šè¿‡ charts/ ç›®å½•æ‰‹åŠ¨ç®¡ç†ä¾èµ–</h4><p>Helm æä¾›äº†ä¸¤ç§ç®¡ç†ä¾èµ–çš„æ–¹å¼ï¼Œä¸€ç§æ˜¯å¦‚ä¸Šæ‰€è¿°çš„ <code>dependencies</code> è¡¨è¾¾å¼ï¼Œå®ƒä¼šéµå¾ªè¯­æ³•åŸåˆ™ï¼Œè‡ªåŠ¨çš„ç®¡ç†ä¾èµ–ï¼Œä¾èµ–åŒ…ä¼šè¢«ä¸‹è½½åˆ° <code>charts/</code> ä¸­ï¼›å¦ä¸€ç§æ–¹å¼å°±æ˜¯é€šè¿‡ <code>charts/</code> ç›®å½•æ¥æ‰‹åŠ¨ç®¡ç†ä¾èµ–ï¼Œè¿™ç§æ–¹å¼å¯ä»¥å¯¹ä¾èµ–çš„ chart åšæ›´å¤šçš„è‡ªå®šä¹‰è®¾ç½®ã€‚</p>
<h5 id="1-åŸºæœ¬åŸåˆ™-1"><a href="#1-åŸºæœ¬åŸåˆ™-1" class="headerlink" title="1. åŸºæœ¬åŸåˆ™"></a>1. åŸºæœ¬åŸåˆ™</h5><blockquote>
<ul>
<li><code>charts/</code> ä¸‹ç®¡ç†çš„ä¾èµ–å¿…é¡»æ˜¯ä¸€ä¸ª <strong>chart åŒ…</strong> ï¼ˆ<code>xxx-1.0.1.tgz</code>ï¼‰æˆ–æ˜¯ä¸€ä¸ªè§£å‹çš„ <strong>chart ç›®å½•</strong></li>
<li><strong>ä¾èµ–çš„åç§°ä¸èƒ½ä»¥ <code>_</code> æˆ– <code>.</code> å¼€å¤´</strong>ï¼Œå¦åˆ™ä¼šè¢« chart åŠ è½½å™¨å¿½ç•¥</li>
<li>å¯ä»¥ä½¿ç”¨ <code>helm pull</code> å°†ä¾èµ–ä¸‹è½½åˆ° <code>charts/</code>ä¸‹</li>
</ul>
</blockquote>
<h5 id="2-ç¤ºä¾‹è¯´æ˜-1"><a href="#2-ç¤ºä¾‹è¯´æ˜-1" class="headerlink" title="2. ç¤ºä¾‹è¯´æ˜"></a>2. ç¤ºä¾‹è¯´æ˜</h5><p>æ¯”å¦‚ WordPress çš„ chart ä¾èµ– Apache å’Œ mariadbï¼Œå…¶ç›®å½•å½¢å¼åº”è¯¥å¦‚ä¸‹ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs shell">wordpress:<br>  Chart.yaml<br><span class="hljs-meta">  #</span><span class="bash"> ...</span><br>  charts/<br>    apache/<br>      Chart.yaml<br>      # ...<br>    mariadb/<br>      Chart.yaml<br>      # ...<br>    memcached/<br>    	Chart.yaml<br>      # ...<br></code></pre></td></tr></table></figure>



<h4 id="3ï¼‰dependencies-ä¸­-condition-å’Œ-tags-ä½¿ç”¨é‡Šä¹‰"><a href="#3ï¼‰dependencies-ä¸­-condition-å’Œ-tags-ä½¿ç”¨é‡Šä¹‰" class="headerlink" title="3ï¼‰dependencies ä¸­ condition å’Œ tags ä½¿ç”¨é‡Šä¹‰"></a>3ï¼‰dependencies ä¸­ condition å’Œ tags ä½¿ç”¨é‡Šä¹‰</h4><h5 id="1-åŸºæœ¬åŸåˆ™ï¼š"><a href="#1-åŸºæœ¬åŸåˆ™ï¼š" class="headerlink" title="1. åŸºæœ¬åŸåˆ™ï¼š"></a>1. åŸºæœ¬åŸåˆ™ï¼š</h5><blockquote>
<ul>
<li><p>æ¡ä»¶ï¼ˆconditionï¼‰ä¼˜å…ˆ</p>
<p>å½“è®¾ç½® value æ—¶ï¼Œå¦‚æœåŒæ—¶å­˜åœ¨ <code>condition</code> å’Œ <code>tags</code> çš„å€¼ï¼Œé‚£ä¹ˆ <code>condition</code> çš„æ•ˆæœä¼šè¦†ç›– <code>tags</code> çš„æ•ˆæœã€‚</p>
</li>
<li><p>æ ‡ç­¾ï¼ˆtagsï¼‰æœ€å°åŒ–å…ƒç´ </p>
<p>å½“ <code>tags</code> ä¸­çš„ä»»æ„ä¸€ä¸ªå…ƒç´ çš„å€¼è¢«è®¾ç½®ä¸º <code>true</code> æ—¶ï¼Œå¸¦æœ‰è¯¥ <code>tags</code> çš„ chart å°±ä¼šè¢«å¯ç”¨ã€‚</p>
</li>
<li><p><code>condition</code> å’Œ <code>tags</code> åœ¨ values.yaml ä¸­å¿…éœ€åœ¨ç¼©è¿›çš„æœ€é¡¶å±‚</p>
</li>
<li><p><code>tags</code> åœ¨ values.yaml ä¸­éœ€ä»¥ä»¥ä¸‹å½¢å¼:</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">tags:</span><br>  <span class="hljs-string">xxx</span><br>  <span class="hljs-string">xxx</span><br></code></pre></td></tr></table></figure></li>
</ul>
</blockquote>
<h5 id="2-ç¤ºä¾‹è¯´æ˜ï¼š"><a href="#2-ç¤ºä¾‹è¯´æ˜ï¼š" class="headerlink" title="2. ç¤ºä¾‹è¯´æ˜ï¼š"></a>2. ç¤ºä¾‹è¯´æ˜ï¼š</h5><p>æ–‡ä»¶: <code>test_chart/Chart.yaml</code></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">dependencies:</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">subchart1</span><br>    <span class="hljs-attr">repository:</span> <span class="hljs-string">http://localhost:10191</span><br>    <span class="hljs-attr">version:</span> <span class="hljs-number">0.1</span><span class="hljs-number">.0</span><br>    <span class="hljs-attr">condition:</span> <span class="hljs-string">subchart1.enabled,</span> <span class="hljs-string">global.subchart1.enabled</span><br>    <span class="hljs-attr">tags:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">front-end</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">subchart1</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">subchart2</span><br>    <span class="hljs-attr">repository:</span> <span class="hljs-string">http://localhost:10191</span><br>    <span class="hljs-attr">version:</span> <span class="hljs-number">0.1</span><span class="hljs-number">.0</span><br>    <span class="hljs-attr">condition:</span> <span class="hljs-string">subchart2.enabled,global.subchart2.enabled</span><br>    <span class="hljs-attr">tags:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">back-end</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">subchart2</span><br></code></pre></td></tr></table></figure>

<p>æ–‡ä»¶: <code>test_chart/values.yaml</code></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">subchart1:</span><br>  <span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure>

<p>å¦‚ä¸Šè¡¨è¾¾å¼è¡¨ç¤ºï¼Œ<code>condition</code> ä¸­å¸¦æœ‰ <code>subchart1</code> çš„ chart ä¼šè¢«å¯åŠ¨</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">tags:</span><br>  <span class="hljs-attr">front-end:</span> <span class="hljs-literal">false</span><br>  <span class="hljs-attr">back-end:</span> <span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure>

<p>å¦‚ä¸Šè¡¨è¾¾å¼è¡¨ç¤ºï¼Œ<code>tags</code> ä¸­å¸¦æœ‰ <code>back-end</code> çš„ chart ä¼šè¢«å¯åŠ¨ï¼Œè€Œå¸¦æœ‰ <code>front-end</code> çš„åˆ™ä¸ä¼šè¢«å¯åŠ¨</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">subchart1:</span><br>  <span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span><br><span class="hljs-attr">tags:</span><br>  <span class="hljs-attr">front-end:</span> <span class="hljs-literal">false</span><br>  <span class="hljs-attr">back-end:</span> <span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure>

<p>å¦‚ä¸Šè¡¨è¾¾å¼ï¼Œå½“ <code>condition</code> å’Œ <code>tags</code> ä¸€èµ·ä½¿ç”¨æ—¶ï¼Œæ˜¯ä¼šå‘ç”Ÿæ•ˆæœè¦†ç›–çš„ï¼Œæ¯”å¦‚ï¼Œè™½ç„¶ <code>front-end</code> è®¾ç½®ä¸ºäº† <code>false</code>ï¼Œä½†æ˜¯ç”±äº <code>subchart1.enabled</code> è®¾ç½®ä¸º <code>true</code>ï¼Œæ¡ä»¶å‘ç”Ÿè¦†ç›–ï¼Œæ‰€ä»¥ chart <code>subchart1</code> è¿˜æ˜¯ä¼šè¢«å¯ç”¨ã€‚</p>
<p>è€Œå½“ <code>back-end</code> è®¾ç½®ä¸º <code>true</code> çš„æ—¶å€™ï¼Œæ¡ä»¶è¯»å–çš„å°±æ˜¯ <code>back-end: true</code> ï¼Œå› æ­¤ï¼Œå³ä½¿æ²¡æœ‰è®¾ç½® <code>subchart2.enabled</code> ä¸º <code>true</code>ï¼Œchart <code>subchart2</code> ä¹Ÿä¼šè¢«å¯ç”¨ã€‚</p>
<h4 id="4ï¼‰dependencies-ä¸­çš„-alias-ä½¿ç”¨é‡Šä¹‰ï¼ˆäº†è§£ï¼‰"><a href="#4ï¼‰dependencies-ä¸­çš„-alias-ä½¿ç”¨é‡Šä¹‰ï¼ˆäº†è§£ï¼‰" class="headerlink" title="4ï¼‰dependencies  ä¸­çš„ alias ä½¿ç”¨é‡Šä¹‰ï¼ˆäº†è§£ï¼‰"></a>4ï¼‰dependencies  ä¸­çš„ alias ä½¿ç”¨é‡Šä¹‰ï¼ˆäº†è§£ï¼‰</h4><h5 id="1-åŸºæœ¬åŸåˆ™-2"><a href="#1-åŸºæœ¬åŸåˆ™-2" class="headerlink" title="1. åŸºæœ¬åŸåˆ™"></a>1. åŸºæœ¬åŸåˆ™</h5><p>åœ¨ <code>dependencies</code> çš„è¡¨è¾¾å¼ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ <code>alias</code> å¯¹éœ€æ±‚é¡¹æ·»åŠ åˆ«åï¼Œå½“å­˜åœ¨ä¾èµ–å¤šæ¬¡å¤ç”¨çš„æ—¶å€™å°±å¯ä»¥é€šè¿‡åˆ«åçš„æ–¹å¼æ¥è®¿é—®è¯¥éœ€æ±‚é¡¹ï¼Œä»¥æ­¤åŠ ä»¥åŒºåˆ†ã€‚ï¼ˆæ¯”å¦‚ æ•°æ®åº“çš„ä¸»ä»ã€é›†ç¾¤ç­‰ä½¿ç”¨åœºæ™¯ï¼‰</p>
<h5 id="2-ç¤ºä¾‹è¯´æ˜-2"><a href="#2-ç¤ºä¾‹è¯´æ˜-2" class="headerlink" title="2. ç¤ºä¾‹è¯´æ˜"></a>2. ç¤ºä¾‹è¯´æ˜</h5><p>æ–‡ä»¶: <code>parent_chart/Chart.yaml</code></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">dependencies:</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">subchart</span><br>    <span class="hljs-attr">repository:</span> <span class="hljs-string">http://localhost:10191</span><br>    <span class="hljs-attr">version:</span> <span class="hljs-number">0.1</span><span class="hljs-number">.0</span><br>    <span class="hljs-attr">alias:</span> <span class="hljs-string">new-subchart-1</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">subchart</span><br>    <span class="hljs-attr">repository:</span> <span class="hljs-string">http://localhost:10191</span><br>    <span class="hljs-attr">version:</span> <span class="hljs-number">0.1</span><span class="hljs-number">.0</span><br>    <span class="hljs-attr">alias:</span> <span class="hljs-string">new-subchart-2</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">subchart</span><br>    <span class="hljs-attr">repository:</span> <span class="hljs-string">http://localhost:10191</span><br>    <span class="hljs-attr">version:</span> <span class="hljs-number">0.1</span><span class="hljs-number">.0</span><br></code></pre></td></tr></table></figure>

<p>å¦‚ä¸Šæƒ…å†µï¼Œ<code>parent_chart</code> ä¸­ç›¸å½“äºæœ‰ 3 ä¸ªä¾èµ–é¡¹ï¼Œ<code>subchart</code>ã€<code>new-subchart-1</code> ã€<code>new-subchart-2</code> ï¼Œè™½ç„¶ä»–ä»¬æ˜¯åŸºäºåŒä¸€ä¸ª chart çš„ï¼Œä½†æ˜¯å¯ä»¥è¢«åŒºåˆ«å¯¹å¾…ã€‚</p>
<h4 id="5ï¼‰dependencies-ä¸­çš„-import-values-ä½¿ç”¨é‡Šä¹‰ï¼ˆäº†è§£ï¼‰"><a href="#5ï¼‰dependencies-ä¸­çš„-import-values-ä½¿ç”¨é‡Šä¹‰ï¼ˆäº†è§£ï¼‰" class="headerlink" title="5ï¼‰dependencies  ä¸­çš„ import-values ä½¿ç”¨é‡Šä¹‰ï¼ˆäº†è§£ï¼‰"></a>5ï¼‰dependencies  ä¸­çš„ import-values ä½¿ç”¨é‡Šä¹‰ï¼ˆäº†è§£ï¼‰</h4><p>ä»ä¸Šæ–‡ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œåœ¨ <code>charts/</code> ç›®å½•ä¸‹é¢ç®¡ç†çš„å…¶å®ä¹Ÿæ˜¯ chartï¼Œé‚£ä¹ˆå®ƒå°±ä¼šéµå¾ª chart çš„åŸåˆ™ï¼Œé‚£ä¹ˆè¿™ç§æƒ…å†µä¸‹ï¼Œç›®å½•ç»“æ„å°±æ˜¯ä¸€ç§  <code>çˆ¶-å­</code> çš„å…³ç³»ã€‚åœ¨æŸäº›åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šéœ€è¦è¯»å– <em>å­ char</em> çš„å€¼ï¼ŒHelm åˆ™æä¾›äº† <code>import-values</code> è¿™æ ·ä¸€ç§å®ç°æ–¹å¼ã€‚</p>
<h5 id="1-åŸºæœ¬åŸåˆ™-3"><a href="#1-åŸºæœ¬åŸåˆ™-3" class="headerlink" title="1. åŸºæœ¬åŸåˆ™"></a>1. åŸºæœ¬åŸåˆ™</h5><blockquote>
<ul>
<li><p>ç›®å½•ç»“æ„å’Œæ–‡ä»¶å…³ç³»å¦‚ä¸‹</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell">parent_chart:			# çˆ¶ chart<br>  Chart.yaml			# dependencies - child_chart - import-values - Key<br><span class="hljs-meta">  #</span><span class="bash"> ...</span><br>  charts/<br>    child_chart/	# å­ chart<br>      Chart.yaml	<br>      values.yaml	# exports - Key - value<br>      # ...<br></code></pre></td></tr></table></figure></li>
<li><p>åŠ è½½å™¨ä¼šæ ¹æ® <code>dependencies - name</code> æ‰¾ <em>å­ chart</em>ï¼Œæ ¹æ® <code>dependencies - import-values</code> çš„ key è§£æ <em>å­ chart</em> ä¸­å¯¹åº”çš„å€¼</p>
</li>
<li><p>åŠ è½½å™¨é»˜è®¤è¯†åˆ« <code>exports</code></p>
</li>
<li><p>æ²¡æœ‰ <code>exports</code> ï¼Œéœ€è¦ä»¥ <code>parent-child</code> æ–¹å¼æ˜ç¡®æŒ‡æ˜è¦æ³¨å…¥çš„ <em>å­ chart</em> çš„å€¼çš„ Key å’Œ è¦è¢«æ³¨å…¥çš„ <em>çˆ¶ chart</em> çš„å€¼çš„åç§°</p>
</li>
<li><p>import <em>å­ chart</em> æ‰€å¾—çš„å€¼æœ€ç»ˆä¼šè¢«åˆå¹¶å…¥ <em>çˆ¶ chart</em> çš„ values ä¸­ï¼Œå¹¶ä¼šè¦†ç›–åŸæœ‰é”®å€¼</p>
</li>
</ul>
</blockquote>
<h5 id="2-ç¤ºä¾‹è¯´æ˜-3"><a href="#2-ç¤ºä¾‹è¯´æ˜-3" class="headerlink" title="2. ç¤ºä¾‹è¯´æ˜"></a>2. ç¤ºä¾‹è¯´æ˜</h5><h6 id="1âƒ£ï¸-ä½¿ç”¨-exports-çš„æ–¹å¼"><a href="#1âƒ£ï¸-ä½¿ç”¨-exports-çš„æ–¹å¼" class="headerlink" title="1âƒ£ï¸ ä½¿ç”¨ exports çš„æ–¹å¼"></a>1âƒ£ï¸ ä½¿ç”¨ <code>exports</code> çš„æ–¹å¼</h6><p>æ–‡ä»¶:  <code>parent_chart/Chart.yaml</code></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">dependencies:</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">child_chart</span><br>    <span class="hljs-attr">repository:</span> <span class="hljs-string">http://localhost:10191</span><br>    <span class="hljs-attr">version:</span> <span class="hljs-number">0.1</span><span class="hljs-number">.0</span><br>    <span class="hljs-attr">import-values:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">data</span>					<span class="hljs-comment"># å¼•ç”¨å­ chart çš„å˜é‡ - data</span><br></code></pre></td></tr></table></figure>

<p>æ–‡ä»¶: <code>parent_chart/charts/child_chart/values.yaml</code></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">exports:</span>							<span class="hljs-comment"># å£°æ˜å˜é‡ data</span><br>	<span class="hljs-attr">data:</span><br>		<span class="hljs-attr">port:</span> <span class="hljs-number">3306</span><br></code></pre></td></tr></table></figure>

<p>Helm ä¼šåœ¨ <code>import-values</code> çš„åˆ—è¡¨åˆ°å…¥å†…å®¹æ—¶ï¼Œå°†å…¶ä¸­çš„å…ƒç´ ä½œä¸º Keyï¼Œå¹¶ä»¥æ­¤åˆ° <em>å­ chart</em> çš„ <code>exports</code> å­—æ®µæŸ¥æ‰¾å¯¹åº”çš„ Keyï¼Œå¹¶å°†å¯¹åº”çš„ value æ³¨å…¥ <em>çˆ¶ chart</em>  çš„ values ä¸­ï¼Œæ‰€ä»¥æœ€ç»ˆæˆ‘ä»¬å¯ä»¥åœ¨ <em>çˆ¶ chart</em> ä¸­å¯è·å–åˆ°çš„å€¼ä¸ºï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">port:</span> <span class="hljs-number">3306</span><br></code></pre></td></tr></table></figure>



<h6 id="2âƒ£ï¸-ä½¿ç”¨-parent-â€”-child-çš„æ–¹å¼"><a href="#2âƒ£ï¸-ä½¿ç”¨-parent-â€”-child-çš„æ–¹å¼" class="headerlink" title="2âƒ£ï¸ ä½¿ç”¨ parent â€” child çš„æ–¹å¼"></a>2âƒ£ï¸ ä½¿ç”¨ <code>parent â€” child</code> çš„æ–¹å¼</h6><blockquote>
<p>âš ï¸ <strong>æ³¨æ„:</strong></p>
<p>å¦‚æœåœ¨ <em>å­ chart</em> çš„ values.yaml ä¸­æ²¡æœ‰ä½¿ç”¨ <code>exports</code> ï¼Œå°±å¿…é¡»æŒ‡å®šè¦æ³¨å…¥çš„ <em>å­ chart</em> å€¼çš„ æºKey ä»¥åŠ è¢«æ³¨å…¥çš„ <em>çˆ¶ chart</em> çš„å€¼çš„åç§°ã€‚</p>
</blockquote>
<p>æ–‡ä»¶: <code>parent_chart/Chart.yaml</code></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">dependencies:</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">child_chart</span><br>    <span class="hljs-attr">repository:</span> <span class="hljs-string">http://localhost:10191</span><br>    <span class="hljs-attr">version:</span> <span class="hljs-number">0.1</span><span class="hljs-number">.0</span><br>    <span class="hljs-string">...</span><br>    <span class="hljs-attr">import-values:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-attr">child:</span> <span class="hljs-string">default.data</span><br>        <span class="hljs-attr">parent:</span> <span class="hljs-string">myimports</span><br></code></pre></td></tr></table></figure>

<p>æ–‡ä»¶: <code>parent_chart/charts/child_chart/values.yaml</code></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">default:</span><br>  <span class="hljs-attr">data:</span><br>    <span class="hljs-attr">myint:</span> <span class="hljs-number">999</span><br>    <span class="hljs-attr">mybool:</span> <span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure>

<p>æ–‡ä»¶: <code>parent_chart/values.yaml</code></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">myimports:</span><br>  <span class="hljs-attr">myint:</span> <span class="hljs-number">0</span><br>  <span class="hljs-attr">mybool:</span> <span class="hljs-literal">false</span><br>  <span class="hljs-attr">mystring:</span> <span class="hljs-string">&quot;helm tests!&quot;</span><br></code></pre></td></tr></table></figure>

<p>å¦‚ä¸Šè¿°ç¤ºä¾‹ï¼Œ<code>import-values</code> çš„åŠ è½½å™¨ï¼Œæ ¹æ® <code>child</code> å» child_chart çš„ values.yaml ä¸­æ‰¾ <code>default - data</code> ï¼Œå¹¶è§£æå‡ºå…¶å€¼ï¼Œå¹¶å°†å…¶æ³¨å…¥åˆ° <em>çˆ¶ chart</em> ä¸­ï¼Œå¹¶ä¼šè¦†ç›–åŸæœ‰çš„é”®å€¼ï¼Œç”±æ­¤ <em>çˆ¶ chart</em> æœ€ç»ˆçš„ values ä¼šåˆå¹¶å¦‚ä¸‹ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">myimports:</span><br>  <span class="hljs-attr">myint:</span> <span class="hljs-number">999</span><br>  <span class="hljs-attr">mybool:</span> <span class="hljs-literal">true</span><br>  <span class="hljs-attr">mystring:</span> <span class="hljs-string">&quot;helm tests!&quot;</span><br></code></pre></td></tr></table></figure>





<h3 id="3ã€templates-å’Œ-values-yaml"><a href="#3ã€templates-å’Œ-values-yaml" class="headerlink" title="3ã€templates/ å’Œ values.yaml"></a>3ã€templates/ å’Œ values.yaml</h3><h4 id="1ï¼‰Values-çš„ç”Ÿæ•ˆæœºåˆ¶"><a href="#1ï¼‰Values-çš„ç”Ÿæ•ˆæœºåˆ¶" class="headerlink" title="1ï¼‰Values çš„ç”Ÿæ•ˆæœºåˆ¶"></a>1ï¼‰Values çš„ç”Ÿæ•ˆæœºåˆ¶</h4><p>Values é€šè¿‡æ¨¡æ¿ä¸­<code>.Values</code>å¯¹è±¡å¯è®¿é—®çš„<code>values.yaml</code>æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ <code>.Chart</code> å¯¹è±¡å¯è®¿é—®çš„ <code>Chart.yaml</code> ï¼Œä»¥æ­¤ç±»æ¨ã€‚å¦å¤– ï¼ŒHelm ä¸­æœ‰ä¸€äº›é¢„å®šä¹‰çš„ valuesï¼Œå¯ä»¥å°†å…¶è§†ä¸ºç¯å¢ƒå˜é‡ï¼Œå…·ä½“å¦‚ä¸‹:</p>
<blockquote>
<ul>
<li><p><strong>Release</strong></p>
<p>è¯¥å¯¹è±¡æè¿°äº†ç‰ˆæœ¬å‘å¸ƒæœ¬èº«ã€‚</p>
<p>ä½¿ç”¨æ–¹æ³•å¦‚ï¼Œ<code>&#123;&#123; .Release.Name &#125;&#125;</code> (è·å– release çš„åç§°)</p>
</li>
<li><p><strong>.Values</strong></p>
<p>è®¿é—® <code>values.yaml</code> çš„å†…å®¹ã€‚</p>
<p>ä½¿ç”¨æ–¹æ³•å¦‚ï¼Œ<code>&#123;&#123; .Values.image.repository &#125;&#125;</code> (è·å– values.yaml ä¸­ <code>image - repository</code> çš„å€¼)</p>
</li>
<li><p><strong>.Chart</strong></p>
<p>è®¿é—® <code>Chart.yaml</code> çš„å†…å®¹ã€‚</p>
<p>ä½¿ç”¨æ–¹æ³•å¦‚ï¼Œ <code>&#123;&#123; .Chart.Version &#125;&#125;</code> (è·å¾— chart çš„ç‰ˆæœ¬)ã€<code>&#123;&#123; .Chart.Maintainers &#125;&#125;</code> (è·å– chart çš„ç»´æŠ¤è€…) </p>
<p>è¯­æ³•é£æ ¼éµå¾ª go æ¨¡ç‰ˆè§„åˆ™ï¼Œç±»ä¼¼ jinja2ã€‚æ˜¯ä¸€ç§å±‚çº§æ£€ç´¢çš„æ–¹å¼ï¼Œ<code>.</code> è¡¨ç¤ºå±‚çº§ï¼Œæœ€é¡¶å±‚çš„ <code>.</code> å³ <code>æ ¹</code> ã€‚</p>
</li>
<li><p><strong>.Files</strong></p>
<p>è®¿é—® chart ä¸­å­˜åœ¨çš„æ–‡ä»¶çš„å†…å®¹ (<code>.helmignore</code> é™¤å¤–)ã€‚</p>
<p>ä½¿ç”¨æ–¹æ³•å¦‚ï¼Œ<code>&#123;&#123; index .Files "file.name" &#125;&#125;</code> (è·å–è¯¥æ–‡ä»¶ä¸­ <code>name</code>çš„å€¼)ï¼Œå®ƒç­‰æ•ˆäº <code>&#123;&#123; .Files.Get name &#125;&#125;</code> æ–¹æ³•ã€‚</p>
<p><code>&#123;&#123; .Files.GetBytes &#125;&#125;</code> æ–¹æ³•ç­‰æ•ˆäºè®¿é—®æ–‡ä»¶ä¸­çš„ <code>[]byte</code> å¯¹è±¡</p>
</li>
<li><p><strong>.Capabilities</strong></p>
<p>è®¿é—® K8s çš„ <code>Capabilities</code> å¯¹è±¡ã€‚</p>
<p>ä½¿ç”¨æ–¹æ³•å¦‚ï¼Œ<code>&#123;&#123; .Capabilities.KubeVersion &#125;&#125;</code> (è·å– K8s ç‰ˆæœ¬)ã€<code>&#123;&#123; .Capabilities.APIVersions.Has "batch/v1" &#125;&#125;</code>(è·å–æ”¯æŒçš„ K8s API ç‰ˆæœ¬)</p>
</li>
</ul>
</blockquote>
<h4 id="2ï¼‰templates-ä¸­çš„æ¨¡ç‰ˆ"><a href="#2ï¼‰templates-ä¸­çš„æ¨¡ç‰ˆ" class="headerlink" title="2ï¼‰templates/ ä¸­çš„æ¨¡ç‰ˆ"></a>2ï¼‰templates/ ä¸­çš„æ¨¡ç‰ˆ</h4><p>æ¨¡æ¿æ–‡ä»¶éµå®ˆä¹¦å†™Goæ¨¡æ¿çš„æ ‡å‡†æƒ¯ä¾‹ï¼ˆæŸ¥çœ‹ <a target="_blank" rel="noopener" href="https://golang.org/pkg/text/template/">æ–‡æœ¬/æ¨¡æ¿ Go åŒ…æ–‡æ¡£</a>äº†è§£æ›´å¤šï¼‰ã€‚ä»¥å‘å¸ƒä¸€ä¸ª nginx çš„ <code>templates/deployment.yaml</code> çš„ç¤ºä¾‹æ¨¡ç‰ˆä¸ºä¾‹ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">apps/v1</span><br><span class="hljs-attr">kind:</span> <span class="hljs-string">Deployment</span><br><span class="hljs-attr">metadata:</span><br>  <span class="hljs-attr">name:</span> &#123;&#123; <span class="hljs-string">.Chart.Name</span>  &#125;&#125;<br><span class="hljs-attr">spec:</span><br>  &#123;&#123;<span class="hljs-bullet">-</span> <span class="hljs-string">if</span> <span class="hljs-string">not</span> <span class="hljs-string">.Values.autoscaling.enabled</span> &#125;&#125;<br>  <span class="hljs-attr">replicas:</span> &#123;&#123; <span class="hljs-string">.Values.replicaCount</span> &#125;&#125;<br>  &#123;&#123;<span class="hljs-bullet">-</span> <span class="hljs-string">end</span> &#125;&#125;<br>  <span class="hljs-attr">selector:</span><br>    <span class="hljs-attr">matchLabels:</span><br>      <span class="hljs-attr">app:</span> &#123;&#123; <span class="hljs-string">.Chart.Name</span> &#125;&#125;<br>  <span class="hljs-attr">template:</span><br>    <span class="hljs-attr">metadata:</span><br>      <span class="hljs-attr">labels:</span><br>        <span class="hljs-attr">app:</span> &#123;&#123; <span class="hljs-string">.Chart.Name</span> &#125;&#125;<br>    <span class="hljs-attr">spec:</span><br>      <span class="hljs-attr">imagePullSecrets:</span><br>			<span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">harborsecret</span><br>      <span class="hljs-attr">containers:</span><br>        <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> &#123;&#123; <span class="hljs-string">.Chart.Name</span> &#125;&#125;<br>          <span class="hljs-attr">image:</span> <span class="hljs-string">&quot;<span class="hljs-template-variable">&#123;&#123; .Values.image.repository &#125;&#125;</span>:<span class="hljs-template-variable">&#123;&#123; .Values.image.tag &#125;&#125;</span>&quot;</span><br>          <span class="hljs-attr">imagePullPolicy:</span> &#123;&#123; <span class="hljs-string">.Values.image.pullPolicy</span> &#125;&#125;<br>          <span class="hljs-attr">ports:</span><br>            <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">http</span><br>              <span class="hljs-attr">containerPort:</span> &#123;&#123; <span class="hljs-string">.Values.service.port</span> &#125;&#125;<br>              <span class="hljs-attr">protocol:</span> <span class="hljs-string">TCP</span><br>          <span class="hljs-attr">livenessProbe:</span><br>            <span class="hljs-attr">httpGet:</span><br>              <span class="hljs-attr">path:</span> <span class="hljs-string">/</span><br>              <span class="hljs-attr">port:</span> <span class="hljs-string">http</span><br>          <span class="hljs-attr">readinessProbe:</span><br>            <span class="hljs-attr">httpGet:</span><br>              <span class="hljs-attr">path:</span> <span class="hljs-string">/</span><br>              <span class="hljs-attr">port:</span> <span class="hljs-string">http</span><br>          <span class="hljs-attr">resources:</span><br>            &#123;&#123;<span class="hljs-bullet">-</span> <span class="hljs-string">toYaml</span> <span class="hljs-string">.Values.resources</span> <span class="hljs-string">|</span> <span class="hljs-string">nindent</span> <span class="hljs-number">12</span> &#125;&#125;<br>      &#123;&#123;<span class="hljs-bullet">-</span> <span class="hljs-string">with</span> <span class="hljs-string">.Values.nodeSelector</span> &#125;&#125;<br>      <span class="hljs-attr">nodeSelector:</span><br>        &#123;&#123;<span class="hljs-bullet">-</span> <span class="hljs-string">toYaml</span> <span class="hljs-string">.</span> <span class="hljs-string">|</span> <span class="hljs-string">nindent</span> <span class="hljs-number">8</span> &#125;&#125;<br>      &#123;&#123;<span class="hljs-bullet">-</span> <span class="hljs-string">end</span> &#125;&#125;<br>      &#123;&#123;<span class="hljs-bullet">-</span> <span class="hljs-string">with</span> <span class="hljs-string">.Values.affinity</span> &#125;&#125;<br>      <span class="hljs-attr">affinity:</span><br>        &#123;&#123;<span class="hljs-bullet">-</span> <span class="hljs-string">toYaml</span> <span class="hljs-string">.</span> <span class="hljs-string">|</span> <span class="hljs-string">nindent</span> <span class="hljs-number">8</span> &#125;&#125;<br>      &#123;&#123;<span class="hljs-bullet">-</span> <span class="hljs-string">end</span> &#125;&#125;<br>      &#123;&#123;<span class="hljs-bullet">-</span> <span class="hljs-string">with</span> <span class="hljs-string">.Values.tolerations</span> &#125;&#125;<br>      <span class="hljs-attr">tolerations:</span><br>        &#123;&#123;<span class="hljs-bullet">-</span> <span class="hljs-string">toYaml</span> <span class="hljs-string">.</span> <span class="hljs-string">|</span> <span class="hljs-string">nindent</span> <span class="hljs-number">8</span> &#125;&#125;<br>      &#123;&#123;<span class="hljs-bullet">-</span> <span class="hljs-string">end</span> &#125;&#125;<br></code></pre></td></tr></table></figure>



<h4 id="3ï¼‰å–å€¼-values-yaml-æ¸²æŸ“æ¨¡ç‰ˆ"><a href="#3ï¼‰å–å€¼-values-yaml-æ¸²æŸ“æ¨¡ç‰ˆ" class="headerlink" title="3ï¼‰å–å€¼ values.yaml æ¸²æŸ“æ¨¡ç‰ˆ"></a>3ï¼‰å–å€¼ values.yaml æ¸²æŸ“æ¨¡ç‰ˆ</h4><p>æ ¹æ®å¦‚ä¸Šæ¨¡ç‰ˆçš„å˜é‡å…³ç³»ï¼Œè¿›è¡Œå¯¹åº”æ–‡ä»¶ value çš„é…ç½®ï¼Œæ¶‰åŠåˆ° <code>Chart.yaml</code> å’Œ <code>values.yaml</code> ä¸¤ä¸ªæ–‡ä»¶ï¼š</p>
<h5 id="1-Chart-yaml-çš„å¿…è¦å€¼"><a href="#1-Chart-yaml-çš„å¿…è¦å€¼" class="headerlink" title="1. Chart.yaml çš„å¿…è¦å€¼"></a>1. <code>Chart.yaml</code> çš„å¿…è¦å€¼</h5><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v2</span><br><span class="hljs-attr">name:</span> <span class="hljs-string">test_chart</span><br><span class="hljs-attr">description:</span> <span class="hljs-string">A</span> <span class="hljs-string">Helm</span> <span class="hljs-string">chart</span> <span class="hljs-string">for</span> <span class="hljs-string">Kubernetes</span><br><span class="hljs-attr">type:</span> <span class="hljs-string">application</span><br><span class="hljs-attr">version:</span> <span class="hljs-number">0.1</span><span class="hljs-number">.0</span><br><span class="hljs-attr">appVersion:</span> <span class="hljs-string">&quot;1.16.0&quot;</span><br></code></pre></td></tr></table></figure>

<h5 id="2-values-yaml-çš„å¿…è¦å€¼"><a href="#2-values-yaml-çš„å¿…è¦å€¼" class="headerlink" title="2. values.yaml çš„å¿…è¦å€¼"></a>2. <code>values.yaml</code> çš„å¿…è¦å€¼</h5><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">replicaCount:</span> <span class="hljs-number">1</span><br><br><span class="hljs-attr">image:</span><br>  <span class="hljs-attr">repository:</span> <span class="hljs-string">nginx</span><br>  <span class="hljs-attr">tag:</span> <span class="hljs-string">&quot;stable&quot;</span><br>  <span class="hljs-attr">pullPolicy:</span> <span class="hljs-string">IfNotPresent</span><br><br><span class="hljs-attr">service:</span><br>  <span class="hljs-attr">type:</span> <span class="hljs-string">ClusterIP</span><br>  <span class="hljs-attr">port:</span> <span class="hljs-number">80</span><br><br><span class="hljs-attr">resources:</span><br>  <span class="hljs-attr">limits:</span><br>    <span class="hljs-attr">cpu:</span> <span class="hljs-string">100m</span><br>    <span class="hljs-attr">memory:</span> <span class="hljs-string">128Mi</span><br>  <span class="hljs-attr">requests:</span><br>    <span class="hljs-attr">cpu:</span> <span class="hljs-string">100m</span><br>    <span class="hljs-attr">memory:</span> <span class="hljs-string">128Mi</span><br><br><span class="hljs-attr">autoscaling:</span><br>  <span class="hljs-attr">enabled:</span> <span class="hljs-literal">false</span><br>  <span class="hljs-attr">minReplicas:</span> <span class="hljs-number">1</span><br>  <span class="hljs-attr">maxReplicas:</span> <span class="hljs-number">100</span><br>  <span class="hljs-attr">targetCPUUtilizationPercentage:</span> <span class="hljs-number">80</span><br>  <span class="hljs-comment"># targetMemoryUtilizationPercentage: 80</span><br><br><span class="hljs-attr">nodeSelector:</span> &#123;&#125;<br><br><span class="hljs-attr">tolerations:</span> []<br><br><span class="hljs-attr">affinity:</span> &#123;&#125;<br></code></pre></td></tr></table></figure>

<h5 id="3-éªŒè¯æ¸²æŸ“æ•ˆæœ"><a href="#3-éªŒè¯æ¸²æŸ“æ•ˆæœ" class="headerlink" title="3. éªŒè¯æ¸²æŸ“æ•ˆæœ"></a>3. éªŒè¯æ¸²æŸ“æ•ˆæœ</h5><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨ <code>helm install</code> æ—¶ä½¿ç”¨ <code>--dry-run</code> å‚æ•°æ¥åªæ¸²æŸ“æ¨¡ç‰ˆï¼Œè€Œä¸è¿›è¡Œç›´æ¥éƒ¨ç½²ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥éªŒè¯æ•ˆæœäº†ã€‚æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">helm install --dry-run demo test_chart/<br></code></pre></td></tr></table></figure>

<p>æ¸²æŸ“åçš„ manifest å¦‚ä¸‹:</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">apps/v1</span><br><span class="hljs-attr">kind:</span> <span class="hljs-string">Deployment</span><br><span class="hljs-attr">metadata:</span><br>  <span class="hljs-attr">name:</span> <span class="hljs-string">test_chart</span><br><span class="hljs-attr">spec:</span><br>  <span class="hljs-attr">replicas:</span> <span class="hljs-number">1</span><br>  <span class="hljs-attr">selector:</span><br>    <span class="hljs-attr">matchLabels:</span><br>      <span class="hljs-attr">app:</span> <span class="hljs-string">test_chart</span><br>  <span class="hljs-attr">template:</span><br>    <span class="hljs-attr">metadata:</span><br>      <span class="hljs-attr">labels:</span><br>        <span class="hljs-attr">app:</span> <span class="hljs-string">test_chart</span><br>    <span class="hljs-attr">spec:</span><br>      <span class="hljs-attr">imagePullSecrets:</span><br>        <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">harborsecret</span><br>      <span class="hljs-attr">containers:</span><br>        <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">test_chart</span><br>          <span class="hljs-attr">image:</span> <span class="hljs-string">&quot;nginx:stable&quot;</span><br>          <span class="hljs-attr">imagePullPolicy:</span> <span class="hljs-string">IfNotPresent</span><br>          <span class="hljs-attr">ports:</span><br>            <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">http</span><br>              <span class="hljs-attr">containerPort:</span> <span class="hljs-number">80</span><br>              <span class="hljs-attr">protocol:</span> <span class="hljs-string">TCP</span><br>          <span class="hljs-attr">livenessProbe:</span><br>            <span class="hljs-attr">httpGet:</span><br>              <span class="hljs-attr">path:</span> <span class="hljs-string">/</span><br>              <span class="hljs-attr">port:</span> <span class="hljs-string">http</span><br>          <span class="hljs-attr">readinessProbe:</span><br>            <span class="hljs-attr">httpGet:</span><br>              <span class="hljs-attr">path:</span> <span class="hljs-string">/</span><br>              <span class="hljs-attr">port:</span> <span class="hljs-string">http</span><br>          <span class="hljs-attr">resources:</span><br>            <span class="hljs-attr">limits:</span><br>              <span class="hljs-attr">cpu:</span> <span class="hljs-string">100m</span><br>              <span class="hljs-attr">memory:</span> <span class="hljs-string">128Mi</span><br>            <span class="hljs-attr">requests:</span><br>              <span class="hljs-attr">cpu:</span> <span class="hljs-string">100m</span><br>              <span class="hljs-attr">memory:</span> <span class="hljs-string">128Mi</span><br></code></pre></td></tr></table></figure>



<h4 id="4ï¼‰-set-æŒ‡å®šå‚æ•°æ¸²æŸ“"><a href="#4ï¼‰-set-æŒ‡å®šå‚æ•°æ¸²æŸ“" class="headerlink" title="4ï¼‰--set æŒ‡å®šå‚æ•°æ¸²æŸ“"></a>4ï¼‰<code>--set</code> æŒ‡å®šå‚æ•°æ¸²æŸ“</h4><p>å½“æˆ‘ä»¬åœ¨æ‰§è¡Œ <code>helm install</code> æˆ–è€… <code>helm upgrade</code> æ—¶ï¼Œé™¤äº†ç›´æ¥é€šè¿‡ <em>values.yaml</em> æ¸²æŸ“å¤–ï¼Œä¹Ÿæ”¯æŒç›´æ¥åœ¨å‘½ä»¤è¡Œé€šè¿‡ <code>--set</code> å‚æ•°ä¼ å‚ï¼Œ<strong>ä¼ å…¥çš„å‚æ•°ä¼šè¦†ç›– <em>values.yaml</em> ä¸­çš„é¢„è®¾å€¼</strong>ã€‚</p>
<h5 id="ç¤ºä¾‹ï¼šé€šè¿‡-set-ä¿®æ”¹-é•œåƒç‰ˆæœ¬-å’Œ-ç«¯å£"><a href="#ç¤ºä¾‹ï¼šé€šè¿‡-set-ä¿®æ”¹-é•œåƒç‰ˆæœ¬-å’Œ-ç«¯å£" class="headerlink" title="ç¤ºä¾‹ï¼šé€šè¿‡ --set ä¿®æ”¹ é•œåƒç‰ˆæœ¬ å’Œ ç«¯å£"></a>ç¤ºä¾‹ï¼šé€šè¿‡ <code>--set</code> ä¿®æ”¹ <code>é•œåƒç‰ˆæœ¬</code> å’Œ <code>ç«¯å£</code></h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">helm install --set image.tag=&quot;1.16.0&quot; --set service.port=9999 --dry-run demo test_chart/<br></code></pre></td></tr></table></figure>

<p>æ¸²æŸ“åçš„ manifest å¦‚ä¸‹ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">apps/v1</span><br><span class="hljs-attr">kind:</span> <span class="hljs-string">Deployment</span><br><span class="hljs-attr">metadata:</span><br>  <span class="hljs-attr">name:</span> <span class="hljs-string">test_chart</span><br><span class="hljs-attr">spec:</span><br>  <span class="hljs-attr">replicas:</span> <span class="hljs-number">1</span><br>  <span class="hljs-attr">selector:</span><br>    <span class="hljs-attr">matchLabels:</span><br>      <span class="hljs-attr">app:</span> <span class="hljs-string">test_chart</span><br>  <span class="hljs-attr">template:</span><br>    <span class="hljs-attr">metadata:</span><br>      <span class="hljs-attr">labels:</span><br>        <span class="hljs-attr">app:</span> <span class="hljs-string">test_chart</span><br>    <span class="hljs-attr">spec:</span><br>      <span class="hljs-attr">imagePullSecrets:</span><br>        <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">harborsecret</span><br>      <span class="hljs-attr">containers:</span><br>        <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">test_chart</span><br>          <span class="hljs-attr">image:</span> <span class="hljs-string">&quot;nginx:1.16.0&quot;</span>					<span class="hljs-comment"># é•œåƒç‰ˆæœ¬ç”±åŸæ¥çš„ stable æ›´æ”¹ä¸º 1.16.0</span><br>          <span class="hljs-attr">imagePullPolicy:</span> <span class="hljs-string">IfNotPresent</span><br>          <span class="hljs-attr">ports:</span><br>            <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">http</span><br>              <span class="hljs-attr">containerPort:</span> <span class="hljs-number">9999</span>				<span class="hljs-comment"># ç«¯å£ç”±åŸæ¥çš„ 80 æ›´æ”¹ä¸º 9999</span><br>              <span class="hljs-attr">protocol:</span> <span class="hljs-string">TCP</span><br>          <span class="hljs-attr">livenessProbe:</span><br>            <span class="hljs-attr">httpGet:</span><br>              <span class="hljs-attr">path:</span> <span class="hljs-string">/</span><br>              <span class="hljs-attr">port:</span> <span class="hljs-string">http</span><br>          <span class="hljs-attr">readinessProbe:</span><br>            <span class="hljs-attr">httpGet:</span><br>              <span class="hljs-attr">path:</span> <span class="hljs-string">/</span><br>              <span class="hljs-attr">port:</span> <span class="hljs-string">http</span><br>          <span class="hljs-attr">resources:</span><br>            <span class="hljs-attr">limits:</span><br>              <span class="hljs-attr">cpu:</span> <span class="hljs-string">100m</span><br>              <span class="hljs-attr">memory:</span> <span class="hljs-string">128Mi</span><br>            <span class="hljs-attr">requests:</span><br>              <span class="hljs-attr">cpu:</span> <span class="hljs-string">100m</span><br>              <span class="hljs-attr">memory:</span> <span class="hljs-string">128Mi</span><br></code></pre></td></tr></table></figure>



<h4 id="5ï¼‰é€šè¿‡-f-æŒ‡å®š-Values-æ–‡ä»¶"><a href="#5ï¼‰é€šè¿‡-f-æŒ‡å®š-Values-æ–‡ä»¶" class="headerlink" title="5ï¼‰é€šè¿‡ -f æŒ‡å®š Values æ–‡ä»¶"></a>5ï¼‰é€šè¿‡ <code>-f</code> æŒ‡å®š Values æ–‡ä»¶</h4><p>chart é»˜è®¤çš„ Values æ–‡ä»¶å‘½åä¸º <code>values.yaml</code>ï¼Œå½“ä½ åœ¨æ‰§è¡Œ <code>helm install</code> æˆ– <code>helm upgrade</code> æ—¶ï¼Œå¦‚æœåç§°ä¸æ˜¯ <code>values.yaml</code>ï¼Œæ‰§è¡Œå°±ä¼šå‡ºé”™ã€‚<strong>é€šè¿‡å‘½ä»¤è¡Œ <code>-f</code> å‚æ•°ï¼Œå¯ä»¥æŒ‡å®š Values æ–‡ä»¶</strong>ï¼Œè¿™æ ·æ–‡ä»¶çš„åç§°å°±ä¸å—é™åˆ¶äº†ã€‚</p>
<h5 id="ç¤ºä¾‹ï¼š"><a href="#ç¤ºä¾‹ï¼š" class="headerlink" title="ç¤ºä¾‹ï¼š"></a>ç¤ºä¾‹ï¼š</h5><p>åˆ›å»ºæ–‡ä»¶ <code>test_chart/demo.yaml</code>ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs shell">replicaCount: 1<br><br>image:<br>  repository: mysql<br>  tag: &quot;8.7.0&quot;<br>  pullPolicy: IfNotPresent<br><br>service:<br>  type: ClusterIP<br>  port: 3306<br><br>resources:<br>  limits:<br>    cpu: 100m<br>    memory: 128Mi<br>  requests:<br>    cpu: 100m<br>    memory: 128Mi<br><br>autoscaling:<br>  enabled: false<br>  minReplicas: 1<br>  maxReplicas: 100<br>  targetCPUUtilizationPercentage: 80<br><span class="hljs-meta">  #</span><span class="bash"> targetMemoryUtilizationPercentage: 80</span><br><br>nodeSelector: &#123;&#125;<br><br>tolerations: []<br><br>affinity: &#123;&#125;<br></code></pre></td></tr></table></figure>

<p>æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œè¿›è¡Œæ¸²æŸ“æµ‹è¯•ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">helm install -f test_chart/demo.yaml --dry-run demo test_chart<br></code></pre></td></tr></table></figure>

<p>æ¸²æŸ“åçš„ manifest å¦‚ä¸‹ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">apps/v1</span><br><span class="hljs-attr">kind:</span> <span class="hljs-string">Deployment</span><br><span class="hljs-attr">metadata:</span><br>  <span class="hljs-attr">name:</span> <span class="hljs-string">test_chart</span><br><span class="hljs-attr">spec:</span><br>  <span class="hljs-attr">replicas:</span> <span class="hljs-number">1</span><br>  <span class="hljs-attr">selector:</span><br>    <span class="hljs-attr">matchLabels:</span><br>      <span class="hljs-attr">app:</span> <span class="hljs-string">test_chart</span><br>  <span class="hljs-attr">template:</span><br>    <span class="hljs-attr">metadata:</span><br>      <span class="hljs-attr">labels:</span><br>        <span class="hljs-attr">app:</span> <span class="hljs-string">test_chart</span><br>    <span class="hljs-attr">spec:</span><br>      <span class="hljs-attr">imagePullSecrets:</span><br>        <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">harborsecret</span><br>      <span class="hljs-attr">containers:</span><br>        <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">test_chart</span><br>          <span class="hljs-attr">image:</span> <span class="hljs-string">&quot;mysql:8.7.0&quot;</span>					<span class="hljs-comment"># é•œåƒå·²æ›´æ”¹</span><br>          <span class="hljs-attr">imagePullPolicy:</span> <span class="hljs-string">IfNotPresent</span><br>          <span class="hljs-attr">ports:</span><br>            <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">http</span><br>              <span class="hljs-attr">containerPort:</span> <span class="hljs-number">3306</span>				<span class="hljs-comment"># ç«¯å£å·²æ›´æ”¹</span><br>              <span class="hljs-attr">protocol:</span> <span class="hljs-string">TCP</span><br>          <span class="hljs-attr">livenessProbe:</span><br>            <span class="hljs-attr">httpGet:</span><br>              <span class="hljs-attr">path:</span> <span class="hljs-string">/</span><br>              <span class="hljs-attr">port:</span> <span class="hljs-string">http</span><br>          <span class="hljs-attr">readinessProbe:</span><br>            <span class="hljs-attr">httpGet:</span><br>              <span class="hljs-attr">path:</span> <span class="hljs-string">/</span><br>              <span class="hljs-attr">port:</span> <span class="hljs-string">http</span><br>          <span class="hljs-attr">resources:</span><br>            <span class="hljs-attr">limits:</span><br>              <span class="hljs-attr">cpu:</span> <span class="hljs-string">100m</span><br>              <span class="hljs-attr">memory:</span> <span class="hljs-string">128Mi</span><br>            <span class="hljs-attr">requests:</span><br>              <span class="hljs-attr">cpu:</span> <span class="hljs-string">100m</span><br>              <span class="hljs-attr">memory:</span> <span class="hljs-string">128Mi</span><br><br></code></pre></td></tr></table></figure>





<h3 id="4ã€æ¶æ„æ–‡ä»¶-values-schema-json"><a href="#4ã€æ¶æ„æ–‡ä»¶-values-schema-json" class="headerlink" title="4ã€æ¶æ„æ–‡ä»¶ values.schema.json"></a>4ã€æ¶æ„æ–‡ä»¶ <code>values.schema.json</code></h3><p>æ˜¯å¦è¿˜è®°å¾—ï¼Œåœ¨ç¬¬1ç« ä¸­æˆ‘ä»¬ä»‹ç»è¿‡ Helm3 çš„æ–°åŠŸèƒ½ä¸­å¢åŠ äº† <code>ä½¿ç”¨JSON Schema</code> æ¥éªŒè¯ Chart çš„ Values çš„æœºåˆ¶ï¼Ÿäº‹å®ä¸Šï¼Œå®ƒåœ¨ Chart çš„è¡¨ç°å°±æ˜¯ <code>values.schema.json</code> æ–‡ä»¶ã€‚åœ¨å…¶ä¸­<code>required</code> å¯ä»¥ç”¨äºå®šä¹‰å“ªäº›å­—æ®µæ˜¯å¿…é¡»çš„ï¼Œ<code>type</code> å¯ç”¨ç”¨äºå®šä¹‰å“ªäº›å­—æ®µéœ€è¦æ˜¯ä»€ä¹ˆå­—æ®µç±»å‹ç­‰ã€‚</p>
<blockquote>
<p>ğŸš© <strong>å½“æˆ‘ä»¬åœ¨æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤æ—¶ï¼ŒHelm å°†ä¼šä»¥è¯¥ Json å®šä¹‰çš„æ¶æ„æ ¼å¼å»éªŒè¯ .Values å¯¹è±¡æ˜¯å¦ç¬¦åˆè§„æ ¼ï¼Œåªæœ‰å½“éªŒè¯é€šè¿‡åï¼Œæ‰èƒ½æ­£å¸¸å‘é€ç»™ K8s æ‰§è¡Œã€‚</strong></p>
<ul>
<li>helm install</li>
<li>helm upgrade</li>
<li>helm lint</li>
<li>helm template</li>
</ul>
</blockquote>
<h4 id="1ï¼‰æ ¼å¼ç¤ºä¾‹"><a href="#1ï¼‰æ ¼å¼ç¤ºä¾‹" class="headerlink" title="1ï¼‰æ ¼å¼ç¤ºä¾‹"></a>1ï¼‰æ ¼å¼ç¤ºä¾‹</h4><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;$schema&quot;</span>: <span class="hljs-string">&quot;https://json-schema.org/draft-07/schema#&quot;</span>,<br>  <span class="hljs-attr">&quot;properties&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;image&quot;</span>: &#123;<br>      <span class="hljs-attr">&quot;description&quot;</span>: <span class="hljs-string">&quot;Container Image&quot;</span>,<br>      <span class="hljs-attr">&quot;properties&quot;</span>: &#123;<br>        <span class="hljs-attr">&quot;repo&quot;</span>: &#123;<br>          <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;string&quot;</span><br>        &#125;,<br>        <span class="hljs-attr">&quot;tag&quot;</span>: &#123;<br>          <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;string&quot;</span><br>        &#125;<br>      &#125;,<br>      <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;object&quot;</span><br>    &#125;,<br>    <span class="hljs-attr">&quot;name&quot;</span>: &#123;<br>      <span class="hljs-attr">&quot;description&quot;</span>: <span class="hljs-string">&quot;Service name&quot;</span>,<br>      <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;string&quot;</span><br>    &#125;,<br>    <span class="hljs-attr">&quot;port&quot;</span>: &#123;<br>      <span class="hljs-attr">&quot;description&quot;</span>: <span class="hljs-string">&quot;Port&quot;</span>,<br>      <span class="hljs-attr">&quot;minimum&quot;</span>: <span class="hljs-number">0</span>,<br>      <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;integer&quot;</span><br>    &#125;,<br>    <span class="hljs-attr">&quot;protocol&quot;</span>: &#123;<br>      <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;string&quot;</span><br>    &#125;<br>  &#125;,<br>  <span class="hljs-attr">&quot;required&quot;</span>: [<br>    <span class="hljs-string">&quot;protocol&quot;</span>,<br>    <span class="hljs-string">&quot;port&quot;</span><br>  ],<br>  <span class="hljs-attr">&quot;title&quot;</span>: <span class="hljs-string">&quot;Values&quot;</span>,<br>  <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;object&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="2ï¼‰ç¤ºä¾‹è¯´æ˜"><a href="#2ï¼‰ç¤ºä¾‹è¯´æ˜" class="headerlink" title="2ï¼‰ç¤ºä¾‹è¯´æ˜"></a>2ï¼‰ç¤ºä¾‹è¯´æ˜</h4><p><code>required</code> å­—æ®µå®šä¹‰äº† Values ä¸­å¿…è¦çš„å­—æ®µï¼Œå¦‚ä¸Šä¾‹æ‰€ç¤ºï¼Œå³ <code>protocol</code> å’Œ <code>port</code> ã€‚å¦å¤–ï¼Œ<code>name</code> é»˜ä¹Ÿæ˜¯å¿…é¡»çš„ï¼Œå› ä¸º <code>service name</code> æ˜¯ä¸€ä¸ª <code>Release</code> çš„å¿…è¦å…ƒç´ ï¼Œå› æ­¤ï¼Œä¸€ä¸ªç¬¦åˆè¯¥æ¶æ„è¦æ±‚çš„æœ€ç²¾ç®€ <em>values.yaml</em> åº”è¯¥å¦‚ä¸‹ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">name:</span> <span class="hljs-string">nginx</span><br><span class="hljs-attr">protocol:</span> <span class="hljs-string">http</span><br><span class="hljs-attr">port:</span> <span class="hljs-number">80</span><br></code></pre></td></tr></table></figure>

<blockquote>
<p>âš ï¸ <strong>æ³¨æ„:</strong></p>
<p>ä¸Šé¢æœ‰æåˆ°è¿‡ï¼Œæ¶æ„æ–‡ä»¶éªŒè¯çš„å¯¹è±¡æ˜¯ <code>.Values å¯¹è±¡</code>ï¼Œè€Œä¸æ˜¯ <em>values.yaml</em> ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä½¿ç”¨ <code>--set</code> æŒ‡å®šçš„å‚æ•°ä¹Ÿå±äºå…¶æ£€æµ‹çš„èŒƒç•´ï¼Œå› æ­¤ï¼Œå¦‚ä¸‹è¿™ç§æƒ…å†µä¹Ÿæ˜¯å¯ä»¥çš„é€šè¿‡æ£€æŸ¥çš„ï¼š</p>
<p><strong>values.yaml</strong></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">name:</span> <span class="hljs-string">fronend</span><br><span class="hljs-attr">protocol:</span> <span class="hljs-string">https</span><br></code></pre></td></tr></table></figure>

<p><strong>å‘½ä»¤è¡ŒæŒ‡å®š port</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">helm install --set port=443<br></code></pre></td></tr></table></figure>
</blockquote>
<h3 id="5ã€ç”¨æˆ·è‡ªå®šä¹‰èµ„æº-â€”â€”-CRD"><a href="#5ã€ç”¨æˆ·è‡ªå®šä¹‰èµ„æº-â€”â€”-CRD" class="headerlink" title="5ã€ç”¨æˆ·è‡ªå®šä¹‰èµ„æº â€”â€” CRD"></a>5ã€ç”¨æˆ·è‡ªå®šä¹‰èµ„æº â€”â€” CRD</h3><p><strong>CRD</strong>ï¼ˆ<code>Custom Resource Definition</code>ï¼‰æ˜¯ K8s æä¾›çš„ä¸€ç§è‡ªå®šä¹‰èµ„æºå¯¹è±¡çš„æœºåˆ¶ã€‚åœ¨ Helm3 ä¸­ï¼Œä½¿ç”¨ <code>crds/</code> ç›®å½•æ¥å¯¹å…¶è¿›è¡Œç®¡ç†ï¼ŒHelm3 ä¼šåœ¨å®‰è£… <em>chart</em> ä¹‹å‰æ£€æŸ¥è¯¥ç›®å½•æ˜¯å¦å­˜åœ¨ CRD çš„ yaml æ–‡ä»¶ï¼Œå¦‚æœå­˜åœ¨ï¼Œåˆ™ä¼šå…ˆåŠ è½½è¯¥ç›®å½•ä¸‹çš„ <strong>æ‰€æœ‰yamlæ–‡ä»¶</strong>è‡³ K8sï¼Œç„¶åå†è¿›è¡Œ <em>chart</em> çš„å‘å¸ƒã€‚</p>
<blockquote>
<p>âš ï¸ <strong>æ³¨æ„ä»¥ä¸‹å‡ ç‚¹:</strong></p>
<ul>
<li>å¤šä¸ª CRD çš„è¡¨è¾¾å¼å¯ä»¥å†™åœ¨ä¸€ä¸ª yaml æ–‡ä»¶ä¸­ï¼Œä½†éœ€è¦ä»¥ <strong>å¼€å§‹ç»“æŸç¬¦ â€œ <code>---</code> â€œ</strong> è¿›è¡Œåˆ†å‰²</li>
<li>CRDæ–‡ä»¶<strong>æ— æ³•å¥—ç”¨ Helm æ¨¡ç‰ˆ</strong>ï¼Œå¿…é¡»æ˜¯æ™®é€šçš„ yaml æ ¼å¼æ–‡ä»¶</li>
<li>å®‰è£… chart æ—¶ï¼Œä¼šå…ˆä¸Šä¼  CRDï¼ˆå¦‚æœ‰ï¼‰ï¼Œå¹¶åŒæ—¶æš‚åœå®‰è£…ï¼Œç›´åˆ° CRD è¢« api server è°ƒç”¨ï¼Œæ‰ä¼šå¼€å§‹åç»­ chart æ¸²æŸ“æ­¥éª¤ã€‚</li>
</ul>
</blockquote>
<h4 id="1ï¼‰ä½¿ç”¨ç¤ºä¾‹"><a href="#1ï¼‰ä½¿ç”¨ç¤ºä¾‹" class="headerlink" title="1ï¼‰ä½¿ç”¨ç¤ºä¾‹"></a>1ï¼‰ä½¿ç”¨ç¤ºä¾‹</h4><p>å¦‚æœè¦åˆ›å»ºä¸€ä¸ªé’ˆå¯¹ <code>crontab</code> çš„ CRDï¼Œéœ€è¦éµå¾ªä»¥ä¸‹ç›®å½•ç»“æ„å’Œè¯­æ³•è§„åˆ™ï¼š</p>
<h5 id="1-ç›®å½•ç»“æ„"><a href="#1-ç›®å½•ç»“æ„" class="headerlink" title="1. ç›®å½•ç»“æ„"></a>1. ç›®å½•ç»“æ„</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell">test_chart/<br>  Chart.yaml<br>  crds/<br>    crontab.yaml<br>  templates/<br>    mycrontab.yaml<br></code></pre></td></tr></table></figure>

<h5 id="2-crontab-yaml-çš„å†™æ³•"><a href="#2-crontab-yaml-çš„å†™æ³•" class="headerlink" title="2. crontab.yaml çš„å†™æ³•"></a>2. crontab.yaml çš„å†™æ³•</h5><blockquote>
<p>âš ï¸ <strong>æ³¨æ„:</strong> CRD ä¸æ”¯æŒ Helm æ¨¡ç‰ˆæŒ‡ä»¤ï¼Œæ‰€ä»¥ crontab.yaml åªèƒ½ä½¿ç”¨ K8s ç»å…¸å£°æ˜è¡¨è¾¾å¼ã€‚</p>
</blockquote>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">kind:</span> <span class="hljs-string">CustomResourceDefinition</span><br><span class="hljs-attr">metadata:</span><br>  <span class="hljs-attr">name:</span> <span class="hljs-string">crontabs.stable.example.com</span><br><span class="hljs-attr">spec:</span><br>  <span class="hljs-attr">group:</span> <span class="hljs-string">stable.example.com</span><br>  <span class="hljs-attr">versions:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">v1</span><br>      <span class="hljs-attr">served:</span> <span class="hljs-literal">true</span><br>      <span class="hljs-attr">storage:</span> <span class="hljs-literal">true</span><br>  <span class="hljs-attr">scope:</span> <span class="hljs-string">Namespaced</span><br>  <span class="hljs-attr">names:</span><br>    <span class="hljs-attr">plural:</span> <span class="hljs-string">crontabs</span><br>    <span class="hljs-attr">singular:</span> <span class="hljs-string">crontab</span><br>    <span class="hljs-attr">kind:</span> <span class="hljs-string">CronTab</span><br></code></pre></td></tr></table></figure>

<h5 id="3-mycrontab-yaml-æ¨¡ç‰ˆæ–‡ä»¶"><a href="#3-mycrontab-yaml-æ¨¡ç‰ˆæ–‡ä»¶" class="headerlink" title="3. mycrontab.yaml æ¨¡ç‰ˆæ–‡ä»¶"></a>3. mycrontab.yaml æ¨¡ç‰ˆæ–‡ä»¶</h5><p>CRD çš„ä¿¡æ¯åœ¨è¢«åŠ è½½è‡³ K8s åï¼Œå°±ä¼šåœ¨ Helm æ¨¡ç‰ˆçš„ <code>.Capabilities</code> ä¸­ç”Ÿæ•ˆï¼ŒæŒ‡å®š <code>apiVersion</code> å°±å¯ä»¥å¼•ç”¨ã€‚å’Œå…¶ä»–èµ„æºå¯¹è±¡ä¸€æ ·ï¼Œä½ éœ€è¦é€šè¿‡åˆ›å»ºæ¨¡ç‰ˆï¼Œå¹¶é€šè¿‡ Values æ¸²æŸ“æ¥åˆ›å»ºå®ä¾‹ã€‚CRD çš„æ¨¡ç‰ˆæ–‡ä»¶åŒå…¶ä»– template æ–‡ä»¶ä¸€æ ·ã€‚</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">stable.example.com</span><br><span class="hljs-attr">kind:</span> <span class="hljs-string">CronTab</span><br><span class="hljs-attr">metadata:</span><br>  <span class="hljs-attr">name:</span> &#123;&#123; <span class="hljs-string">.Values.name</span> &#125;&#125;<br><span class="hljs-attr">spec:</span><br>   <span class="hljs-comment"># ...</span><br></code></pre></td></tr></table></figure>

<h4 id="2ï¼‰CRD-çš„é™åˆ¶"><a href="#2ï¼‰CRD-çš„é™åˆ¶" class="headerlink" title="2ï¼‰CRD çš„é™åˆ¶"></a>2ï¼‰CRD çš„é™åˆ¶</h4><p>å’Œå¤§éƒ¨åˆ†çš„ K8s èµ„æºå¯¹è±¡ä¸åŒï¼ŒCRD æ˜¯å…¨å±€æ€§çš„ï¼Œæ•… Helm å¯¹å…¶çš„ç®¡ç†è¾ƒä¸ºæ…é‡ï¼Œå¹¶å¯¹å…¶è®¾ç½®äº†ä¸€ä¸‹é™åˆ¶ï¼š</p>
<blockquote>
<ul>
<li><p><strong>ä¸ä¼šé‡å¤å®‰è£…</strong></p>
<p>å¦‚æœ <code>crds/</code> ç›®å½•ä¸‹çš„ CRDå·²å­˜åœ¨ï¼Œæ— è®ºæ˜¯å¦æœ‰ç‰ˆæœ¬åŒºåˆ«ï¼Œéƒ½ä¸ä¼šé‡æ–°å®‰è£…è¦†ç›–ï¼Œä¸ä¼šè‡ªåŠ¨å‡çº§</p>
</li>
<li><p><strong>ä¸ä¼šåœ¨å‡çº§ã€å›æ»šæ—¶å®‰è£…</strong></p>
<p>åªæœ‰åœ¨ç¬¬ä¸€æ¬¡ <code>helm install</code> æ—¶æ‰ä¼šè¢«å®‰è£…</p>
</li>
<li><p><strong>ä¸ä¼šè¢«è‡ªåŠ¨åˆ é™¤</strong></p>
<p>è‡ªåŠ¨åˆ é™¤ CRD ä¼šåˆ é™¤æ‰€æœ‰ <code>namespace</code> ä¸­çš„æ‰€æœ‰ <code>CRD</code> ï¼Œæ•…ä¸èƒ½é€šè¿‡ Helm åˆ é™¤</p>
<p>å¸Œæœ›å‡çº§æˆ–åˆ é™¤ CRDï¼Œéœ€è¦è¿›è¡Œæ‰‹åŠ¨æ“ä½œï¼Œæ“ä½œéœ€è°¨æ…</p>
</li>
</ul>
</blockquote>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/Kubernetes/">Kubernetes</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/Helm3-%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%E6%89%8B%E5%86%8C/">Helm3 å¿«é€Ÿå…¥é—¨æ‰‹å†Œ</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">
                  
                    æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 åè®®</a> ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2021/07/24/%E7%AC%AC4%E7%AB%A0%E3%80%81Chart-%E6%A8%A1%E7%89%88%E8%AF%A6%E8%A7%A3/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">ç¬¬4ç« ã€Chart æ¨¡ç‰ˆè¯¦è§£</span>
                        <span class="visible-mobile">ä¸Šä¸€ç¯‡</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2021/07/24/%E7%AC%AC2%E7%AB%A0%E3%80%81Helm3-%E5%AE%89%E8%A3%85%E9%83%A8%E7%BD%B2/">
                        <span class="hidden-mobile">ç¬¬2ç« ã€Helm3 å®‰è£…éƒ¨ç½²</span>
                        <span class="visible-mobile">ä¸‹ä¸€ç¯‡</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;ç›®å½•</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">å…³é”®è¯</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
  </div>
  

  

  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  <script  src="https://cdn.jsdelivr.net/npm/tocbot@4.12.3/dist/tocbot.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4.3.1/anchor.min.js" ></script>



  <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2.0.8/dist/clipboard.min.js" ></script>



  <script  src="/js/local-search.js" ></script>






  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2.0.12/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
      typing(title)
      
    })(window, document);
  </script>















<!-- ä¸»é¢˜çš„å¯åŠ¨é¡¹ ä¿æŒåœ¨æœ€åº•éƒ¨ -->
<script  src="/js/boot.js" ></script>


</body>
</html>
